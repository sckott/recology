<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Transparency on Recology</title>
    <link>http://localhost:1313/tags/transparency/</link>
    <description>Recent content in Transparency on Recology</description>
    <generator>Hugo -- 0.139.3</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 28 Aug 2013 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/transparency/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>govdat - SunlightLabs and New York Times Congress data via R</title>
      <link>http://localhost:1313/2013/08/govdat-vignette/</link>
      <pubDate>Wed, 28 Aug 2013 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2013/08/govdat-vignette/</guid>
      <description>&lt;p&gt;I started an R package a while back, and a few people have shown interest, so I thought it was time to revist the code. govdat is an interface to various APIs for government data: currently the Sunlight Labs APIs, and the New York Times congress API. Returned objects from functions are simple lists. In future versions of govdat, I may change how data is returned. The following are examples (which is also the package vignette) of using the Sunlight Labs API. I will add examples of using the New York Times Congress API once their site is up again; I&amp;rsquo;m doing this on 2013-08-28, just after the takedown of their site.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>I started an R package a while back, and a few people have shown interest, so I thought it was time to revist the code. govdat is an interface to various APIs for government data: currently the Sunlight Labs APIs, and the New York Times congress API. Returned objects from functions are simple lists. In future versions of govdat, I may change how data is returned. The following are examples (which is also the package vignette) of using the Sunlight Labs API. I will add examples of using the New York Times Congress API once their site is up again; I&rsquo;m doing this on 2013-08-28, just after the takedown of their site.</p>
<p>I show just a bit of each data object returned for brevity. And yes, I realize this is not related at all to ecology.</p>
<p>You will need an API key to use both Sunlight Labs APIs and the New York Times APIs. Get your API key at Sunlight Labs <a href="http://sunlightfoundation.com/api/">here</a> and NYT <a href="http://developer.nytimes.com/docs/congress_api">here</a>. You can pass in your key within each function or you can put the key in your .Rprofile file on your machine (which is read from the default R working directory) and the key will be read in automatically inside the function. I recommend the latter option.</p>
<p>Do let me know of bugs or feature requests over at the Github issues page <a href="https://github.com/sckott/govdat/issues">here</a>.</p>
<h4 id="install-govdat">Install govdat</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;devtools&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(devtools)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">install_github</span>(<span style="color:#e6db74">&#34;govdat&#34;</span>, <span style="color:#e6db74">&#34;sckott&#34;</span>)
</span></span></code></pre></div><h4 id="load-govdat">Load govdat</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(govdat)
</span></span></code></pre></div><h4 id="gets-details-subcommittees--membership-for-a-committee-by-id">Gets details (subcommittees + membership) for a committee by id.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>key <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">getOption</span>(<span style="color:#e6db74">&#34;SunlightLabsKey&#34;</span>)
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_getcommittees</span>(id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;JSPR&#34;</span>)
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>committee<span style="color:#f92672">$</span>members[[1]]<span style="color:#f92672">$</span>legislator[1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>]
</span></span></code></pre></div><pre tabindex="0"><code>$website
[1] &#34;http://www.alexander.senate.gov&#34;

$fax
[1] &#34;202-228-3398&#34;

$govtrack_id
[1] &#34;300002&#34;

$firstname
[1] &#34;Lamar&#34;

$chamber
[1] &#34;senate&#34;
</code></pre><h4 id="gets-a-list-of-all-committees-that-a-member-serves-on-including-subcommittes">Gets a list of all committees that a member serves on, including subcommittes.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_getcommitteesallleg</span>(bioguide_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;S000148&#34;</span>)
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>committees[[1]]
</span></span></code></pre></div><pre tabindex="0"><code>$committee
$committee$chamber
[1] &#34;Senate&#34;

$committee$id
[1] &#34;SSRA&#34;

$committee$name
[1] &#34;Senate Committee on Rules and Administration&#34;
</code></pre><h4 id="get-districts-for-a-latitudelongitude">Get districts for a latitude/longitude.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_getdistrictlatlong</span>(latitude <span style="color:#f92672">=</span> <span style="color:#ae81ff">35.778788</span>, longitude <span style="color:#f92672">=</span> <span style="color:#ae81ff">-78.787805</span>)
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>districts
</span></span></code></pre></div><pre tabindex="0"><code>[[1]]
[[1]]$district
[[1]]$district$state
[1] &#34;NC&#34;

[[1]]$district$number
[1] &#34;2&#34;
</code></pre><h4 id="get-districts-that-overlap-for-a-certain-zip-code">Get districts that overlap for a certain zip code.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_getdistrictzip</span>(zip <span style="color:#f92672">=</span> <span style="color:#ae81ff">27511</span>)
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>districts
</span></span></code></pre></div><pre tabindex="0"><code>[[1]]
[[1]]$district
[[1]]$district$state
[1] &#34;NC&#34;

[[1]]$district$number
[1] &#34;2&#34;



[[2]]
[[2]]$district
[[2]]$district$state
[1] &#34;NC&#34;

[[2]]$district$number
[1] &#34;4&#34;



[[3]]
[[3]]$district
[[3]]$district$state
[1] &#34;NC&#34;

[[3]]$district$number
[1] &#34;13&#34;
</code></pre><h4 id="search-congress-people-and-senate-members">Search congress people and senate members.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_getlegislatorsearch</span>(name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Reed&#34;</span>)
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>results[[1]]<span style="color:#f92672">$</span>result<span style="color:#f92672">$</span>legislator[1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>]
</span></span></code></pre></div><pre tabindex="0"><code>$website
[1] &#34;http://www.reed.senate.gov&#34;

$fax
[1] &#34;202-224-4680&#34;

$govtrack_id
[1] &#34;300081&#34;

$firstname
[1] &#34;John&#34;

$chamber
[1] &#34;senate&#34;
</code></pre><h4 id="search-congress-people-and-senate-members-for-a-zip-code">Search congress people and senate members for a zip code.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_legislatorsallforzip</span>(zip <span style="color:#f92672">=</span> <span style="color:#ae81ff">77006</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(plyr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ldply</span>(out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>legislators, <span style="color:#66d9ef">function</span>(x) <span style="color:#a6e22e">data.frame</span>(x<span style="color:#f92672">$</span>legislator<span style="color:#a6e22e">[c</span>(<span style="color:#e6db74">&#34;firstname&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;lastname&#34;</span>)]))
</span></span></code></pre></div><pre tabindex="0"><code>  firstname    lastname
1    Sheila Jackson Lee
2       Ted        Cruz
3      John      Cornyn
4       Ted         Poe
</code></pre><h4 id="find-the-popularity-of-a-phrase-over-a-period-of-time">Find the popularity of a phrase over a period of time.</h4>
<h5 id="get-a-list-of-how-many-times-the-phrase-united-states-appears-in-the-congressional-record-in-each-month-between-january-and-june-2010">Get a list of how many times the phrase &ldquo;united states&rdquo; appears in the Congressional Record in each month between January and June, 2010:</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">sll_cw_timeseries</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;united states&#34;</span>, start_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2009-01-01&#34;</span>, end_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2009-04-30&#34;</span>, 
</span></span><span style="display:flex;"><span>    granularity <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;month&#34;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>4 records returned
</code></pre><pre tabindex="0"><code>  count      month
1  3805 2009-01-01
2  3512 2009-02-01
3  6018 2009-03-01
4  2967 2009-04-01
</code></pre><h5 id="plot-data">Plot data</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggplot2)
</span></span><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cw_timeseries</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;climate change&#34;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>1354 records returned
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(dat, <span style="color:#a6e22e">aes</span>(day, count)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_line</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_grey</span>(base_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>)
</span></span></code></pre></div><p><img alt="center" loading="lazy" src="/2013-08-28-govdat-vignette/sll_cw_timeseries2.png"></p>
<h5 id="plot-more-data">Plot more data</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat_d <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cw_timeseries</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;climate change&#34;</span>, party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D&#34;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>908 records returned
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat_d<span style="color:#f92672">$</span>party <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;D&#34;</span>, <span style="color:#a6e22e">nrow</span>(dat_d))
</span></span><span style="display:flex;"><span>dat_r <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cw_timeseries</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;climate change&#34;</span>, party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;R&#34;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>623 records returned
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat_r<span style="color:#f92672">$</span>party <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;R&#34;</span>, <span style="color:#a6e22e">nrow</span>(dat_r))
</span></span><span style="display:flex;"><span>dat_both <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rbind</span>(dat_d, dat_r)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(dat_both, <span style="color:#a6e22e">aes</span>(day, count, colour <span style="color:#f92672">=</span> party)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_line</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_grey</span>(base_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scale_colour_manual</span>(values <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;blue&#34;</span>, <span style="color:#e6db74">&#34;red&#34;</span>))
</span></span></code></pre></div><p><img alt="center" loading="lazy" src="/2013-08-28-govdat-vignette/sll_cw_timeseries3.png"></p>
<h4 id="search-openstates-bills">Search OpenStates bills.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_os_billsearch</span>(terms <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;agriculture&#34;</span>, state <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tx&#34;</span>, chamber <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;upper&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">lapply</span>(out, <span style="color:#e6db74">&#34;[[&#34;</span>, <span style="color:#e6db74">&#34;title&#34;</span>)[100<span style="color:#f92672">:</span><span style="color:#ae81ff">110</span>]
</span></span></code></pre></div><pre tabindex="0"><code>[[1]]
[1] &#34;Relating to the sale by the Brazos River Authority of certain property at Possum Kingdom Lake.&#34;

[[2]]
[1] &#34;Proposing a constitutional amendment providing immediate additional revenue for the state budget by creating the Texas Gaming Commission, and authorizing and regulating the operation of casino games and slot machines by a limited number of licensed operators and certain Indian tribes.&#34;

[[3]]
[1] &#34;Relating to production requirements for holders of winery permits.&#34;

[[4]]
[1] &#34;Relating to the use of human remains in the training of search and rescue animals.&#34;

[[5]]
[1] &#34;Relating to end-of-course assessment instruments administered to public high school students and other measures of secondary-level performance.&#34;

[[6]]
[1] &#34;Relating to public high school graduation, including curriculum and assessment requirements for graduation and funding in support of certain curriculum authorized for graduation.&#34;

[[7]]
[1] &#34;Relating to certain residential and other structures and mitigation of loss to those structures resulting from natural catastrophes; providing a criminal penalty.&#34;

[[8]]
[1] &#34;Recognizing March 28, 2013, as Texas Water Conservation Day at the State Capitol.&#34;

[[9]]
[1] &#34;Recognizing March 26, 2013, as Lubbock Day at the State Capitol.&#34;

[[10]]
[1] &#34;In memory of Steve Jones.&#34;

[[11]]
[1] &#34;Relating to the regulation of dangerous wild animals.&#34;
</code></pre><h4 id="search-legislators-on-openstates">Search Legislators on OpenStates.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_os_legislatorsearch</span>(state <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tx&#34;</span>, party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;democratic&#34;</span>, active <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>out[[1]][1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>]
</span></span></code></pre></div><pre tabindex="0"><code>$last_name
[1] &#34;Naishtat&#34;

$updated_at
[1] &#34;2013-08-29 03:03:22&#34;

$nimsp_candidate_id
[1] &#34;112047&#34;

$full_name
[1] &#34;Elliott Naishtat&#34;

$`+district_address`
[1] &#34; P.O. Box 2910\nAustin, TX 78768\n(512) 463-0668&#34;
</code></pre><h4 id="search-for-entities---that-is-politicians-individuals-or-organizations-with-the-given-name">Search for entities - that is, politicians, individuals, or organizations with the given name</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_ts_aggregatesearch</span>(<span style="color:#e6db74">&#34;Nancy Pelosi&#34;</span>)
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lapply</span>(out, <span style="color:#66d9ef">function</span>(x) {
</span></span><span style="display:flex;"><span>    x<span style="color:#a6e22e">[sapply</span>(x, is.null)] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;none&#34;</span>
</span></span><span style="display:flex;"><span>    x
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ldply</span>(out, data.frame)
</span></span></code></pre></div><pre tabindex="0"><code>                       name count_given firm_income count_lobbied          seat
1          Nancy Pelosi (D)           0           0             0 federal:house
2 Nancy Pelosi for Congress           7           0             0          none
  total_received state lobbying_firm count_received party total_given         type
1       14173534    CA          none          10054     D           0   politician
2              0  none          &lt;NA&gt;              0  none        7250 organization
                                id non_firm_spending is_superpac
1 85ab2e74589a414495d18cc7a9233981                 0        none
2 afb432ec90454c8a83a3113061e7be27                 0        &lt;NA&gt;
</code></pre><h4 id="return-the-top-contributoring-organizations-ranked-by-total-dollars-given-an-organizations-giving-is-broken-down-into-money-given-directly-by-the-organizations-pac-versus-money-given-by-individuals-employed-by-or-associated-with-the-organization">Return the top contributoring organizations, ranked by total dollars given. An organization&rsquo;s giving is broken down into money given directly (by the organization&rsquo;s PAC) versus money given by individuals employed by or associated with the organization.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_ts_aggregatetopcontribs</span>(id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;85ab2e74589a414495d18cc7a9233981&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ldply</span>(out, data.frame)
</span></span></code></pre></div><pre tabindex="0"><code>   employee_amount total_amount total_count                                     name
1         64000.00    101300.00          79                         Akin, Gump et al
2          3500.00     90000.00          29 American Fedn of St/Cnty/Munic Employees
3                0     86600.00          48                National Assn of Realtors
4                0     85000.00          32                      United Auto Workers
5                0     82500.00          37                  National Education Assn
6                0     77000.00          19                          Teamsters Union
7                0     76000.00          36         National Assn of Letter Carriers
8                0     72500.00          18   Intl Brotherhood of Electrical Workers
9                0     72500.00          21                Sheet Metal Workers Union
10         8000.00     72000.00          31                              Wells Fargo
   direct_count employee_count                               id direct_amount
1            16             63 105dcfc8c9384875a099af230dad9917      37300.00
2            25              4 fb702029157e4c7c887172eba71c66c5      86500.00
3            48              0 bb98402bd4d3471cad392a671ecd733a      86600.00
4            32              0 4d3167b97c9f48deb433aad57bb0ee44      85000.00
5            37              0 1b8fea7e453d4e75841eac48ff9df550      82500.00
6            19              0 f89c8e3ab2b44f72971f91b764868231      77000.00
7            36              0 390767dc6b4b491ca775b1bdf8a36eea      76000.00
8            18              0 b53b4ad137d743a996f4d7467700fc88      72500.00
9            21              0 425be85642b24cc2bc3d8a0bb3c7bc92      72500.00
10           20             11 793070ae7f5e42c2a76a58663a588f3d      64000.00
</code></pre>]]></content:encoded>
    </item>
    <item>
      <title>Getting data on your government</title>
      <link>http://localhost:1313/2012/09/gov-dat/</link>
      <pubDate>Sat, 01 Sep 2012 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2012/09/gov-dat/</guid>
      <description>&lt;p&gt;I created an R package a while back to interact with some APIs that serve up data on what our elected represenatives are up to, including the &lt;a href=&#34;http://developer.nytimes.com/&#34;&gt;New York Times Congress API&lt;/a&gt;, and the &lt;a href=&#34;http://services.sunlightlabs.com/&#34;&gt;Sunlight Labs API&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;What kinds of things can you do with &lt;code&gt;govdat&lt;/code&gt;?  Here are a few examples.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;How do the two major parties differ in the use of certain words (searches the congressional record using the Sunlight Labs Capitol Words API)?&lt;/strong&gt;&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>I created an R package a while back to interact with some APIs that serve up data on what our elected represenatives are up to, including the <a href="http://developer.nytimes.com/">New York Times Congress API</a>, and the <a href="http://services.sunlightlabs.com/">Sunlight Labs API</a>.</p>
<p>What kinds of things can you do with <code>govdat</code>?  Here are a few examples.</p>
<p><strong>How do the two major parties differ in the use of certain words (searches the congressional record using the Sunlight Labs Capitol Words API)?</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;govdat&#39;, &#39;sckott&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(govdat)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(reshape2)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggplot2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dems <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cw_dates</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;science&#34;</span>, start_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1996-01-20&#34;</span>, end_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2012-09-01&#34;</span>,
</span></span><span style="display:flex;"><span>    granularity <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;year&#34;</span>, party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D&#34;</span>, printdf <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>repubs <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cw_dates</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;science&#34;</span>, start_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1996-01-20&#34;</span>, end_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2012-09-01&#34;</span>,
</span></span><span style="display:flex;"><span>    granularity <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;year&#34;</span>, party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;R&#34;</span>, printdf <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">melt</span>(<span style="color:#a6e22e">rbind</span>(<span style="color:#a6e22e">data.frame</span>(party <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;D&#34;</span>, <span style="color:#a6e22e">nrow</span>(dems)), dems), <span style="color:#a6e22e">data.frame</span>(party <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;R&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">nrow</span>(repubs)), repubs)))
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">$</span>count <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>(df<span style="color:#f92672">$</span>count)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(df, <span style="color:#a6e22e">aes</span>(yearmonth, count, colour <span style="color:#f92672">=</span> party, group <span style="color:#f92672">=</span> party)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_line</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scale_colour_manual</span>(values <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;blue&#34;</span>, <span style="color:#e6db74">&#34;red&#34;</span>)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">labs</span>(y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;use of the word &#39;Science&#39;&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">theme_bw</span>(base_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">18</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">opts</span>(axis.text.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>), panel.grid.major <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_blank</span>(),
</span></span><span style="display:flex;"><span>    panel.grid.minor <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_blank</span>(), legend.position <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">0.8</span>))
</span></span></code></pre></div><p><img alt="center" loading="lazy" src="/public/img/unnamed-chunk-1.png"></p>
<p><strong>Let&rsquo;s get some data on donations to individual elected representatives.</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(plyr)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Let&#39;s get Nancy Pelosi&#39;s entity ID</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">sll_ts_aggregatesearch</span>(<span style="color:#e6db74">&#34;Nancy Pelosi&#34;</span>)[[1]]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>name
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;Nancy Pelosi (D)&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>count_given
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>firm_income
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>count_lobbied
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>seat
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;federal:house&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>total_received
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">13769274</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>state
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;CA&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>lobbying_firm
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">NULL</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>count_received
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">9852</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>party
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;D&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>total_given
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>type
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;politician&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>id
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;85ab2e74589a414495d18cc7a9233981&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>non_firm_spending
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>is_superpac
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">NULL</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Her entity ID</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">sll_ts_aggregatesearch</span>(<span style="color:#e6db74">&#34;Nancy Pelosi&#34;</span>)[[1]]<span style="color:#f92672">$</span>id
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;85ab2e74589a414495d18cc7a9233981&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># And search for her top donors by sector</span>
</span></span><span style="display:flex;"><span>nancy <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ldply</span>(<span style="color:#a6e22e">sll_ts_aggregatetopsectors</span>(<span style="color:#a6e22e">sll_ts_aggregatesearch</span>(<span style="color:#e6db74">&#34;Nancy Pelosi&#34;</span>)[[1]]<span style="color:#f92672">$</span>id))
</span></span><span style="display:flex;"><span>nancy  <span style="color:#75715e"># but just abbreviations for sectors</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>   sector count     amount
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       F  <span style="color:#ae81ff">1847</span> <span style="color:#ae81ff">2698672.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       P   <span style="color:#ae81ff">981</span> <span style="color:#ae81ff">2243050.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>       H   <span style="color:#ae81ff">829</span> <span style="color:#ae81ff">1412700.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       K  <span style="color:#ae81ff">1345</span> <span style="color:#ae81ff">1409836.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       Q  <span style="color:#ae81ff">1223</span> <span style="color:#ae81ff">1393154.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>       N   <span style="color:#ae81ff">829</span> <span style="color:#ae81ff">1166187.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>       B   <span style="color:#ae81ff">537</span>  <span style="color:#ae81ff">932044.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>       W   <span style="color:#ae81ff">724</span>  <span style="color:#ae81ff">760800.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>       Y   <span style="color:#ae81ff">820</span>  <span style="color:#ae81ff">664926.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>      E   <span style="color:#ae81ff">201</span>  <span style="color:#ae81ff">283575.00</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">data</span>(sll_ts_sectors)  <span style="color:#75715e"># load sectors abbrevations data</span>
</span></span><span style="display:flex;"><span>nancy2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">merge</span>(nancy, sll_ts_sectors, by <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sector&#34;</span>)  <span style="color:#75715e"># attach full sector names</span>
</span></span><span style="display:flex;"><span>nancy2_melt <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">melt</span>(nancy2[, <span style="color:#ae81ff">-1</span>], id.vars <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>nancy2_melt<span style="color:#f92672">$</span>value <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>(nancy2_melt<span style="color:#f92672">$</span>value)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># and lets plot some results</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(nancy2_melt, <span style="color:#a6e22e">aes</span>(sector_name, value)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_bar</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>variable,
</span></span><span style="display:flex;"><span>    scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><p><img alt="center" loading="lazy" src="/public/img/unnamed-chunk-2.png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## It looks like a lot of individual donations (the count facet) by</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## finance/insurance/realestate, but by amount, the most (by slim margin)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## is from labor organizations.</span>
</span></span></code></pre></div><p><strong>Or we may want to get a bio of a congressperson. Here we get Todd Akin of MO. And some twitter searching too? Indeed</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">nyt_cg_memberbioroles</span>(<span style="color:#e6db74">&#34;A000358&#34;</span>)  <span style="color:#75715e"># cool, lots of info, output cutoff for brevity</span>
</span></span><span style="display:flex;"><span>out[[3]][[1]][1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>member_id
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;A000358&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>first_name
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;Todd&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># we can get her twitter id from this bio, and search twitter using</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># twitteR package</span>
</span></span><span style="display:flex;"><span>akintwitter <span style="color:#f92672">&lt;-</span> out[[3]][[1]]<span style="color:#f92672">$</span>twitter_id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install.packages(&#39;twitteR&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(twitteR)
</span></span><span style="display:flex;"><span>tweets <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">userTimeline</span>(akintwitter, n <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>tweets[1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>]  <span style="color:#75715e"># there&#39;s some gems in there no doubt</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[[1]]
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;RepToddAkin: Do you receive my Akin Alert e-newsletter?  Pick the issues youâ€™d like to get updates on and sign up here!\nhttp://t.co/nZfiRjTF&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[2]]
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;RepToddAkin: If the 2001 &amp;amp; 2003 tax policies expire, taxes will increase over $4 trillion in the next 10 years. America can&#39;t afford it. #stopthetaxhike&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[3]]
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;RepToddAkin: A govt agency&#39;s order shouldn&#39;t defy constitutional rights. I&#39;m still working for #religiousfreedom and repealing the HHS mandate. #prolife&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[4]]
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;RepToddAkin: I am a cosponsor of the bill being considered today to limit abortions in DC. RT if you agree! #prolife http://t.co/Mesrjl0w&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[5]]
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;RepToddAkin: We need to #StopTheTaxHike. Raising taxes like the President wants would destroy more than 700,000 jobs. #4jobs http://t.co/KUTd0M7U&#34;</span>
</span></span></code></pre></div><hr>
<p>Get the .Rmd file used to create this post <a href="https://github.com/sckott/sckott.github.com/tree/master/_drafts/2012-09-01-gov-dat.Rmd">at my github account</a> - or <a href="https://github.com/sckott/sckott.github.com/tree/master/_posts/2012-09-01-gov-dat.md">.md file</a>.</p>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>, and nice knitr highlighting/etc. in in <a href="http://rstudio.org/">RStudio</a>.</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
