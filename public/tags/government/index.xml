<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Government on Recology</title>
    <link>http://localhost:1313/tags/government/</link>
    <description>Recent content in Government on Recology</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 11 Aug 2014 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/government/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>rsunlight - R client for Sunlight Labs APIs</title>
      <link>http://localhost:1313/2014/08/rsunlight/</link>
      <pubDate>Mon, 11 Aug 2014 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2014/08/rsunlight/</guid>
      <description>My last blog post on this package was so long ago the package wrapped both New York Times APIs and Sunlight Labs APIs and the package was called govdat. I split that package up into rsunlight for Sunlight Labs APIs and rtimes for some New York Times APIs. rtimes is in development at Github.
We&amp;rsquo;ve updated the package to include four sets of functions, one set for each of four Sunlight Labs APIs (with a separate prefix for each API):</description>
      <content:encoded><![CDATA[<p>My <a href="http://recology.info/2014/05/rsunlight/">last blog post on this package</a> was so long ago the package wrapped both New York Times APIs and Sunlight Labs APIs and the package was called <code>govdat</code>. I split that package up into <code>rsunlight</code> for Sunlight Labs APIs and <code>rtimes</code> for some New York Times APIs. <code>rtimes</code> is <a href="https://github.com/ropengov/rtimes">in development at Github</a>.</p>
<p>We&rsquo;ve updated the package to include four sets of functions, one set for each of four Sunlight Labs APIs (with a separate prefix for each API):</p>
<ul>
<li>Congress API (<code>cg_</code>)</li>
<li>Open States API (<code>os_</code>)</li>
<li>Capitol Words API (<code>cw_</code>)</li>
<li>Influence Explorer API (<code>ie_</code>)</li>
</ul>
<p>Then there are many methods for each API.</p>
<h2 id="rsunlight-intro">rsunlight intro</h2>
<h3 id="installation">Installation</h3>
<p>First, installation</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>devtools<span style="color:#f92672">::</span><span style="color:#a6e22e">install_github</span>(<span style="color:#e6db74">&#34;ropengov/rsunlight&#34;</span>)
</span></span></code></pre></div><p>Load the library</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;rsunlight&#34;</span>)
</span></span></code></pre></div><h3 id="congress-api">Congress API</h3>
<p>Search for Fed level bills that include the term <em>health care</em> in them.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>res <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cg_bills</span>(query<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;health care&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(res<span style="color:#f92672">$</span>results[,<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>])
</span></span></code></pre></div><pre tabindex="0"><code>##          nicknames congress last_version_on sponsor_id
## 1        obamacare      111      2010-08-25    S000749
## 2 obamacare, ppaca      111      2010-08-25    R000053
## 3             NULL      113      2013-10-09    K000220
## 4             NULL      111      2009-01-06    I000056
## 5             NULL      112      2011-01-05    I000056
## 6             NULL      111      2009-05-05    D000197
</code></pre><p>Search for bills that have the two terms <em>transparency</em> and <em>accountability</em> within 5 words of each other in the bill.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>res <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cg_bills</span>(query<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;transparency accountability&#39;</span><span style="color:#f92672">~</span><span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(res<span style="color:#f92672">$</span>results[,<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>])
</span></span></code></pre></div><pre tabindex="0"><code>##   congress last_version_on sponsor_id
## 1      111      2009-01-15    R000435
## 2      113      2013-07-17    R000595
## 3      112      2011-12-08    R000435
## 4      113      2013-09-19    R000435
## 5      112      2011-11-10    R000595
## 6      113      2013-07-23    C000560
##                                       urls.govtrack
## 1   http://www.govtrack.us/congress/bills/111/hr557
## 2  https://www.govtrack.us/congress/bills/113/s1313
## 3  http://www.govtrack.us/congress/bills/112/hr2829
## 4 https://www.govtrack.us/congress/bills/113/hr3155
## 5   http://www.govtrack.us/congress/bills/112/s1848
## 6  https://www.govtrack.us/congress/bills/113/s1347
##                                 urls.opencongress
## 1  http://www.opencongress.org/bill/111-h557/show
## 2      http://www.opencongress.org/bill/s1313-113
## 3 http://www.opencongress.org/bill/112-h2829/show
## 4     http://www.opencongress.org/bill/hr3155-113
## 5 http://www.opencongress.org/bill/112-s1848/show
## 6      http://www.opencongress.org/bill/s1347-113
##                                          urls.congress
## 1   http://beta.congress.gov/bill/111th/house-bill/557
## 2 http://beta.congress.gov/bill/113th/senate-bill/1313
## 3  http://beta.congress.gov/bill/112th/house-bill/2829
## 4  http://beta.congress.gov/bill/113th/house-bill/3155
## 5 http://beta.congress.gov/bill/112th/senate-bill/1848
## 6 http://beta.congress.gov/bill/113th/senate-bill/1347
</code></pre><h3 id="open-states-api">Open States API</h3>
<p>Search State Bills, in this case search for the term <em>agriculture</em> in Texas.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>res <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">os_billsearch</span>(terms <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;agriculture&#39;</span>, state <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;tx&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(res)
</span></span></code></pre></div><pre tabindex="0"><code>##                                                                                                                                                 title
## 1 Relating to authorizing the issuance of revenue bonds to fund capital projects at public institutions of higher education; making an appropriation.
## 2                          Relating to authorizing the issuance of revenue bonds to fund capital projects at public institutions of higher education.
## 3                          Relating to authorizing the issuance of revenue bonds to fund capital projects at public institutions of higher education.
## 4                          Relating to authorizing the issuance of revenue bonds to fund capital projects at public institutions of higher education.
## 5 Relating to authorizing the issuance of revenue bonds to fund capital projects at public institutions of higher education; making an appropriation.
## 6                                Relating to access to certain facilities by search and rescue dogs and their handlers; providing a criminal penalty.
##            created_at          updated_at          id chamber state
## 1 2013-08-01 03:33:40 2013-08-07 03:10:10 TXB00034894   upper    tx
## 2 2013-08-01 03:33:38 2013-08-02 03:20:14 TXB00034893   upper    tx
## 3 2013-07-21 03:03:53 2013-07-28 03:28:30 TXB00034814   upper    tx
## 4 2013-07-03 02:44:03 2013-07-14 03:00:31 TXB00034514   upper    tx
## 5 2013-06-16 03:48:13 2013-06-23 04:02:49 TXB00033988   upper    tx
## 6 2013-03-03 04:47:26 2013-07-01 21:25:36 TXB00027556   upper    tx
##   session type
## 1     833 bill
## 2     833 bill
## 3     832 bill
## 4     832 bill
## 5     831 bill
## 6      83 bill
##                                                                             subjects
## 1                                   Commerce, Education, Budget, Spending, and Taxes
## 2                                   Commerce, Education, Budget, Spending, and Taxes
## 3                                   Commerce, Education, Budget, Spending, and Taxes
## 4                                   Commerce, Education, Budget, Spending, and Taxes
## 5                                   Commerce, Education, Budget, Spending, and Taxes
## 6 Commerce, Business and Consumers, Animal Rights and Wildlife Issues, Health, Crime
##   bill_id
## 1    SB 3
## 2   SB 10
## 3   SB 40
## 4    SB 6
## 5   SB 44
## 6 SB 1010
</code></pre><p>Search for legislators in California (<em>ca</em>) and in the democratic party</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>res <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">os_legislatorsearch</span>(state <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ca&#39;</span>, party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;democratic&#39;</span>, fields <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;full_name&#39;</span>,<span style="color:#e6db74">&#39;+capitol_office.phone&#39;</span>))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(res)
</span></span></code></pre></div><pre tabindex="0"><code>##            phone        id       full_name
## 1 (916) 319-2014 CAL000058   Nancy Skinner
## 2 (916) 319-2015 CAL000059   Joan Buchanan
## 3 (916) 319-2022 CAL000084       Paul Fong
## 4 (916) 319-2046 CAL000089      John Pérez
## 5 (916) 319-2080 CAL000098 V. Manuel Pérez
## 6 (916) 319-2001 CAL000101  Wesley Chesbro
</code></pre><p>Now you can call each representative, yay!</p>
<h3 id="capitol-words-api">Capitol Words API</h3>
<p>Search for phrase <em>climate change</em> used by politicians between September 5th and 16th, 2011:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(<span style="color:#a6e22e">cw_text</span>(phrase<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;climate change&#39;</span>, start_date<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;2011-09-05&#39;</span>, end_date<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;2011-09-16&#39;</span>, party<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;D&#39;</span>)[,<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;speaker_last&#39;</span>,<span style="color:#e6db74">&#39;origin_url&#39;</span>)])
</span></span></code></pre></div><pre tabindex="0"><code>##   speaker_last
## 1      Tsongas
## 2       Inslee
## 3        Costa
## 4        Boxer
## 5       Durbin
## 6        Boxer
##                                                                                   origin_url
## 1 http://origin.www.gpo.gov/fdsys/pkg/CREC-2011-09-14/html/CREC-2011-09-14-pt1-PgH6149-5.htm
## 2   http://origin.www.gpo.gov/fdsys/pkg/CREC-2011-09-15/html/CREC-2011-09-15-pt1-PgH6186.htm
## 3 http://origin.www.gpo.gov/fdsys/pkg/CREC-2011-09-13/html/CREC-2011-09-13-pt1-PgE1609-2.htm
## 4   http://origin.www.gpo.gov/fdsys/pkg/CREC-2011-09-15/html/CREC-2011-09-15-pt1-PgS5650.htm
## 5   http://origin.www.gpo.gov/fdsys/pkg/CREC-2011-09-13/html/CREC-2011-09-13-pt1-PgS5510.htm
## 6 http://origin.www.gpo.gov/fdsys/pkg/CREC-2011-09-13/html/CREC-2011-09-13-pt1-PgS5513-2.htm
</code></pre><p>Plot mentions of the term <em>climate change</em> over time for Democrats vs. Republicans</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#39;ggplot2&#39;</span>)
</span></span><span style="display:flex;"><span>dat_d <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cw_timeseries</span>(phrase<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;climate change&#39;</span>, party<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;D&#34;</span>)
</span></span><span style="display:flex;"><span>dat_d<span style="color:#f92672">$</span>party <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;D&#34;</span>, <span style="color:#a6e22e">nrow</span>(dat_d))
</span></span><span style="display:flex;"><span>dat_r <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cw_timeseries</span>(phrase<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;climate change&#39;</span>, party<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;R&#34;</span>)
</span></span><span style="display:flex;"><span>dat_r<span style="color:#f92672">$</span>party <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;R&#34;</span>, <span style="color:#a6e22e">nrow</span>(dat_r))
</span></span><span style="display:flex;"><span>dat_both <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rbind</span>(dat_d, dat_r)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(dat_both, <span style="color:#a6e22e">aes</span>(day, count, colour<span style="color:#f92672">=</span>party)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a6e22e">geom_line</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a6e22e">theme_grey</span>(base_size<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a6e22e">scale_colour_manual</span>(values<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;blue&#34;</span>,<span style="color:#e6db74">&#34;red&#34;</span>))
</span></span></code></pre></div><p><img loading="lazy" src="/2014-08-11-rsunlight/unnamed-chunk-9.png" alt="plot of chunk unnamed-chunk-9"  />
</p>
<h3 id="influence-explorer-api">Influence Explorer API</h3>
<p>Search for contributions of equal to or more than <code>$20,000,000</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ie_contr</span>(amount<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&gt;|20000000&#39;</span>)[,<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;amount&#39;</span>,<span style="color:#e6db74">&#39;recipient_name&#39;</span>,<span style="color:#e6db74">&#39;contributor_name&#39;</span>)]
</span></span></code></pre></div><pre tabindex="0"><code>##         amount
## 1  25177212.00
## 2  20000000.00
## 3  20000000.00
## 4  20000000.00
## 5  20000000.00
## 6  20000000.00
## 7  50000000.00
## 8  34000000.00
## 9  28000000.00
## 10 20000000.00
##                                                   recipient_name
## 1                                       Republican National Cmte
## 2  CALIFORNIANS TO CLOSE THE OUT-OF-STATE CORPORATE TAX LOOPHOLE
## 3                                                   WHITMAN, MEG
## 4                                                   WHITMAN, MEG
## 5                                                   WHITMAN, MEG
## 6                                                   WHITMAN, MEG
## 7                                         GOLISANO, B THOMAS (G)
## 8                                         GOLISANO, B THOMAS (G)
## 9                                         GOLISANO, B THOMAS (G)
## 10                                        GOLISANO, B THOMAS (G)
##           contributor_name
## 1           Romney Victory
## 2         STEYER, THOMAS F
## 3  WHITMAN, MARGARET (MEG)
## 4  WHITMAN, MARGARET (MEG)
## 5  WHITMAN, MARGARET (MEG)
## 6  WHITMAN, MARGARET (MEG)
## 7       GOLISANO, B THOMAS
## 8       GOLISANO, B THOMAS
## 9       GOLISANO, B THOMAS
## 10      GOLISANO, B THOMAS
</code></pre><p>Top industries, by contributions given. <em>UNKOWN</em> is a very influential industry. Of course <em>law firms</em> are high up there, as well as <em>real estate</em>. I&rsquo;m sure <em>oil and gas</em> is embarrased that they&rsquo;re contributing less than <em>pulic sector unions</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>(res <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ie_industries</span>(method<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;top_ind&#39;</span>, limit<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>))
</span></span></code></pre></div><pre tabindex="0"><code>##       count        amount                               id
## 1  14919818 3825359507.21 cdb3f500a3f74179bb4a5eb8b2932fa6
## 2   3600761 2787678962.95 f50cf984a2e3477c8167d32e2b14e052
## 3    329906 1717649914.58 9cac88377c3b400e89c2d6762e3f28f6
## 4   1386613 1707457092.04 7500030dffe24844aa467a75f7aedfd1
## 5    774496 1563637586.57 0af3f418f426497e8bbf916bfc074ebc
## 6    546367 1389220855.35 52e5d4c6c0fa47c3bdb199a28f96d434
## 7   2134350 1384221307.53 a05a0d06f6814b31bece35a81fcb40c7
## 8   1003850  986588892.83 8ada0fc2d6994f2ab06c7e025dff2284
## 9    567082  775241387.17 52766c4910a846f2813a1dda212b7027
## 10   151006  706747646.35 13718be68388456d9b6e8db753f06e72
##    should_show_entity                    name
## 1                TRUE                 UNKNOWN
## 2                TRUE       LAWYERS/LAW FIRMS
## 3                TRUE  CANDIDATE SELF-FINANCE
## 4                TRUE             REAL ESTATE
## 5                TRUE SECURITIES &amp; INVESTMENT
## 6                TRUE    PUBLIC SECTOR UNIONS
## 7                TRUE    HEALTH PROFESSIONALS
## 8                TRUE               INSURANCE
## 9                TRUE               OIL &amp; GAS
## 10               TRUE        CASINOS/GAMBLING
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>res<span style="color:#f92672">$</span>amount <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>(res<span style="color:#f92672">$</span>amount)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(res, <span style="color:#a6e22e">aes</span>(<span style="color:#a6e22e">reorder</span>(name, amount), amount)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_bar</span>(stat <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;identity&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_y_continuous</span>(labels<span style="color:#f92672">=</span>dollar) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_grey</span>(base_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">14</span>)
</span></span></code></pre></div><p><img loading="lazy" src="/2014-08-11-rsunlight/unnamed-chunk-11.png" alt="plot of chunk unnamed-chunk-11"  />
</p>
<hr>
<h2 id="feedback">Feedback</h2>
<p>Please do use <code>rsunlight</code>, and let us know what you want fixed, new features, etc.</p>
<h2 id="still-to-come">Still to come:</h2>
<ul>
<li>Functions to visualize data from each API. You can do this yourself, but a few functions will be created to help those that are new to R.</li>
<li>Vectorize functions so that you can give many inputs to a function instead of a single input.</li>
<li>test suite: embarrasingly, there is no test suite yet, boo me.</li>
<li>I plan to push <code>rsunlight</code> to CRAN soon as <code>v0.3</code></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>govdat - SunlightLabs and New York Times Congress data via R</title>
      <link>http://localhost:1313/2013/08/govdat-vignette/</link>
      <pubDate>Wed, 28 Aug 2013 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2013/08/govdat-vignette/</guid>
      <description>I started an R package a while back, and a few people have shown interest, so I thought it was time to revist the code. govdat is an interface to various APIs for government data: currently the Sunlight Labs APIs, and the New York Times congress API. Returned objects from functions are simple lists. In future versions of govdat, I may change how data is returned. The following are examples (which is also the package vignette) of using the Sunlight Labs API.</description>
      <content:encoded><![CDATA[<p>I started an R package a while back, and a few people have shown interest, so I thought it was time to revist the code. govdat is an interface to various APIs for government data: currently the Sunlight Labs APIs, and the New York Times congress API. Returned objects from functions are simple lists. In future versions of govdat, I may change how data is returned. The following are examples (which is also the package vignette) of using the Sunlight Labs API. I will add examples of using the New York Times Congress API once their site is up again; I&rsquo;m doing this on 2013-08-28, just after the takedown of their site.</p>
<p>I show just a bit of each data object returned for brevity. And yes, I realize this is not related at all to ecology.</p>
<p>You will need an API key to use both Sunlight Labs APIs and the New York Times APIs. Get your API key at Sunlight Labs <a href="http://sunlightfoundation.com/api/">here</a> and NYT <a href="http://developer.nytimes.com/docs/congress_api">here</a>. You can pass in your key within each function or you can put the key in your .Rprofile file on your machine (which is read from the default R working directory) and the key will be read in automatically inside the function. I recommend the latter option.</p>
<p>Do let me know of bugs or feature requests over at the Github issues page <a href="https://github.com/sckott/govdat/issues">here</a>.</p>
<h4 id="install-govdat">Install govdat</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;devtools&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(devtools)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">install_github</span>(<span style="color:#e6db74">&#34;govdat&#34;</span>, <span style="color:#e6db74">&#34;sckott&#34;</span>)
</span></span></code></pre></div><h4 id="load-govdat">Load govdat</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(govdat)
</span></span></code></pre></div><h4 id="gets-details-subcommittees--membership-for-a-committee-by-id">Gets details (subcommittees + membership) for a committee by id.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>key <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">getOption</span>(<span style="color:#e6db74">&#34;SunlightLabsKey&#34;</span>)
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_getcommittees</span>(id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;JSPR&#34;</span>)
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>committee<span style="color:#f92672">$</span>members[[1]]<span style="color:#f92672">$</span>legislator[1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>]
</span></span></code></pre></div><pre tabindex="0"><code>$website
[1] &#34;http://www.alexander.senate.gov&#34;

$fax
[1] &#34;202-228-3398&#34;

$govtrack_id
[1] &#34;300002&#34;

$firstname
[1] &#34;Lamar&#34;

$chamber
[1] &#34;senate&#34;
</code></pre><h4 id="gets-a-list-of-all-committees-that-a-member-serves-on-including-subcommittes">Gets a list of all committees that a member serves on, including subcommittes.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_getcommitteesallleg</span>(bioguide_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;S000148&#34;</span>)
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>committees[[1]]
</span></span></code></pre></div><pre tabindex="0"><code>$committee
$committee$chamber
[1] &#34;Senate&#34;

$committee$id
[1] &#34;SSRA&#34;

$committee$name
[1] &#34;Senate Committee on Rules and Administration&#34;
</code></pre><h4 id="get-districts-for-a-latitudelongitude">Get districts for a latitude/longitude.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_getdistrictlatlong</span>(latitude <span style="color:#f92672">=</span> <span style="color:#ae81ff">35.778788</span>, longitude <span style="color:#f92672">=</span> <span style="color:#ae81ff">-78.787805</span>)
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>districts
</span></span></code></pre></div><pre tabindex="0"><code>[[1]]
[[1]]$district
[[1]]$district$state
[1] &#34;NC&#34;

[[1]]$district$number
[1] &#34;2&#34;
</code></pre><h4 id="get-districts-that-overlap-for-a-certain-zip-code">Get districts that overlap for a certain zip code.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_getdistrictzip</span>(zip <span style="color:#f92672">=</span> <span style="color:#ae81ff">27511</span>)
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>districts
</span></span></code></pre></div><pre tabindex="0"><code>[[1]]
[[1]]$district
[[1]]$district$state
[1] &#34;NC&#34;

[[1]]$district$number
[1] &#34;2&#34;



[[2]]
[[2]]$district
[[2]]$district$state
[1] &#34;NC&#34;

[[2]]$district$number
[1] &#34;4&#34;



[[3]]
[[3]]$district
[[3]]$district$state
[1] &#34;NC&#34;

[[3]]$district$number
[1] &#34;13&#34;
</code></pre><h4 id="search-congress-people-and-senate-members">Search congress people and senate members.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_getlegislatorsearch</span>(name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Reed&#34;</span>)
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>results[[1]]<span style="color:#f92672">$</span>result<span style="color:#f92672">$</span>legislator[1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>]
</span></span></code></pre></div><pre tabindex="0"><code>$website
[1] &#34;http://www.reed.senate.gov&#34;

$fax
[1] &#34;202-224-4680&#34;

$govtrack_id
[1] &#34;300081&#34;

$firstname
[1] &#34;John&#34;

$chamber
[1] &#34;senate&#34;
</code></pre><h4 id="search-congress-people-and-senate-members-for-a-zip-code">Search congress people and senate members for a zip code.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cg_legislatorsallforzip</span>(zip <span style="color:#f92672">=</span> <span style="color:#ae81ff">77006</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(plyr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ldply</span>(out<span style="color:#f92672">$</span>response<span style="color:#f92672">$</span>legislators, <span style="color:#66d9ef">function</span>(x) <span style="color:#a6e22e">data.frame</span>(x<span style="color:#f92672">$</span>legislator<span style="color:#a6e22e">[c</span>(<span style="color:#e6db74">&#34;firstname&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;lastname&#34;</span>)]))
</span></span></code></pre></div><pre tabindex="0"><code>  firstname    lastname
1    Sheila Jackson Lee
2       Ted        Cruz
3      John      Cornyn
4       Ted         Poe
</code></pre><h4 id="find-the-popularity-of-a-phrase-over-a-period-of-time">Find the popularity of a phrase over a period of time.</h4>
<h5 id="get-a-list-of-how-many-times-the-phrase-united-states-appears-in-the-congressional-record-in-each-month-between-january-and-june-2010">Get a list of how many times the phrase &ldquo;united states&rdquo; appears in the Congressional Record in each month between January and June, 2010:</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">sll_cw_timeseries</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;united states&#34;</span>, start_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2009-01-01&#34;</span>, end_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2009-04-30&#34;</span>, 
</span></span><span style="display:flex;"><span>    granularity <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;month&#34;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>4 records returned
</code></pre><pre tabindex="0"><code>  count      month
1  3805 2009-01-01
2  3512 2009-02-01
3  6018 2009-03-01
4  2967 2009-04-01
</code></pre><h5 id="plot-data">Plot data</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggplot2)
</span></span><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cw_timeseries</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;climate change&#34;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>1354 records returned
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(dat, <span style="color:#a6e22e">aes</span>(day, count)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_line</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_grey</span>(base_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>)
</span></span></code></pre></div><p><img loading="lazy" src="/2013-08-28-govdat-vignette/sll_cw_timeseries2.png" alt="center"  />
</p>
<h5 id="plot-more-data">Plot more data</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat_d <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cw_timeseries</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;climate change&#34;</span>, party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D&#34;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>908 records returned
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat_d<span style="color:#f92672">$</span>party <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;D&#34;</span>, <span style="color:#a6e22e">nrow</span>(dat_d))
</span></span><span style="display:flex;"><span>dat_r <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cw_timeseries</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;climate change&#34;</span>, party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;R&#34;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>623 records returned
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat_r<span style="color:#f92672">$</span>party <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;R&#34;</span>, <span style="color:#a6e22e">nrow</span>(dat_r))
</span></span><span style="display:flex;"><span>dat_both <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rbind</span>(dat_d, dat_r)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(dat_both, <span style="color:#a6e22e">aes</span>(day, count, colour <span style="color:#f92672">=</span> party)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_line</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_grey</span>(base_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scale_colour_manual</span>(values <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;blue&#34;</span>, <span style="color:#e6db74">&#34;red&#34;</span>))
</span></span></code></pre></div><p><img loading="lazy" src="/2013-08-28-govdat-vignette/sll_cw_timeseries3.png" alt="center"  />
</p>
<h4 id="search-openstates-bills">Search OpenStates bills.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_os_billsearch</span>(terms <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;agriculture&#34;</span>, state <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tx&#34;</span>, chamber <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;upper&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">lapply</span>(out, <span style="color:#e6db74">&#34;[[&#34;</span>, <span style="color:#e6db74">&#34;title&#34;</span>)[100<span style="color:#f92672">:</span><span style="color:#ae81ff">110</span>]
</span></span></code></pre></div><pre tabindex="0"><code>[[1]]
[1] &#34;Relating to the sale by the Brazos River Authority of certain property at Possum Kingdom Lake.&#34;

[[2]]
[1] &#34;Proposing a constitutional amendment providing immediate additional revenue for the state budget by creating the Texas Gaming Commission, and authorizing and regulating the operation of casino games and slot machines by a limited number of licensed operators and certain Indian tribes.&#34;

[[3]]
[1] &#34;Relating to production requirements for holders of winery permits.&#34;

[[4]]
[1] &#34;Relating to the use of human remains in the training of search and rescue animals.&#34;

[[5]]
[1] &#34;Relating to end-of-course assessment instruments administered to public high school students and other measures of secondary-level performance.&#34;

[[6]]
[1] &#34;Relating to public high school graduation, including curriculum and assessment requirements for graduation and funding in support of certain curriculum authorized for graduation.&#34;

[[7]]
[1] &#34;Relating to certain residential and other structures and mitigation of loss to those structures resulting from natural catastrophes; providing a criminal penalty.&#34;

[[8]]
[1] &#34;Recognizing March 28, 2013, as Texas Water Conservation Day at the State Capitol.&#34;

[[9]]
[1] &#34;Recognizing March 26, 2013, as Lubbock Day at the State Capitol.&#34;

[[10]]
[1] &#34;In memory of Steve Jones.&#34;

[[11]]
[1] &#34;Relating to the regulation of dangerous wild animals.&#34;
</code></pre><h4 id="search-legislators-on-openstates">Search Legislators on OpenStates.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_os_legislatorsearch</span>(state <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tx&#34;</span>, party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;democratic&#34;</span>, active <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>out[[1]][1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>]
</span></span></code></pre></div><pre tabindex="0"><code>$last_name
[1] &#34;Naishtat&#34;

$updated_at
[1] &#34;2013-08-29 03:03:22&#34;

$nimsp_candidate_id
[1] &#34;112047&#34;

$full_name
[1] &#34;Elliott Naishtat&#34;

$`+district_address`
[1] &#34; P.O. Box 2910\nAustin, TX 78768\n(512) 463-0668&#34;
</code></pre><h4 id="search-for-entities---that-is-politicians-individuals-or-organizations-with-the-given-name">Search for entities - that is, politicians, individuals, or organizations with the given name</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_ts_aggregatesearch</span>(<span style="color:#e6db74">&#34;Nancy Pelosi&#34;</span>)
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lapply</span>(out, <span style="color:#66d9ef">function</span>(x) {
</span></span><span style="display:flex;"><span>    x<span style="color:#a6e22e">[sapply</span>(x, is.null)] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;none&#34;</span>
</span></span><span style="display:flex;"><span>    x
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ldply</span>(out, data.frame)
</span></span></code></pre></div><pre tabindex="0"><code>                       name count_given firm_income count_lobbied          seat
1          Nancy Pelosi (D)           0           0             0 federal:house
2 Nancy Pelosi for Congress           7           0             0          none
  total_received state lobbying_firm count_received party total_given         type
1       14173534    CA          none          10054     D           0   politician
2              0  none          &lt;NA&gt;              0  none        7250 organization
                                id non_firm_spending is_superpac
1 85ab2e74589a414495d18cc7a9233981                 0        none
2 afb432ec90454c8a83a3113061e7be27                 0        &lt;NA&gt;
</code></pre><h4 id="return-the-top-contributoring-organizations-ranked-by-total-dollars-given-an-organizations-giving-is-broken-down-into-money-given-directly-by-the-organizations-pac-versus-money-given-by-individuals-employed-by-or-associated-with-the-organization">Return the top contributoring organizations, ranked by total dollars given. An organization&rsquo;s giving is broken down into money given directly (by the organization&rsquo;s PAC) versus money given by individuals employed by or associated with the organization.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_ts_aggregatetopcontribs</span>(id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;85ab2e74589a414495d18cc7a9233981&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ldply</span>(out, data.frame)
</span></span></code></pre></div><pre tabindex="0"><code>   employee_amount total_amount total_count                                     name
1         64000.00    101300.00          79                         Akin, Gump et al
2          3500.00     90000.00          29 American Fedn of St/Cnty/Munic Employees
3                0     86600.00          48                National Assn of Realtors
4                0     85000.00          32                      United Auto Workers
5                0     82500.00          37                  National Education Assn
6                0     77000.00          19                          Teamsters Union
7                0     76000.00          36         National Assn of Letter Carriers
8                0     72500.00          18   Intl Brotherhood of Electrical Workers
9                0     72500.00          21                Sheet Metal Workers Union
10         8000.00     72000.00          31                              Wells Fargo
   direct_count employee_count                               id direct_amount
1            16             63 105dcfc8c9384875a099af230dad9917      37300.00
2            25              4 fb702029157e4c7c887172eba71c66c5      86500.00
3            48              0 bb98402bd4d3471cad392a671ecd733a      86600.00
4            32              0 4d3167b97c9f48deb433aad57bb0ee44      85000.00
5            37              0 1b8fea7e453d4e75841eac48ff9df550      82500.00
6            19              0 f89c8e3ab2b44f72971f91b764868231      77000.00
7            36              0 390767dc6b4b491ca775b1bdf8a36eea      76000.00
8            18              0 b53b4ad137d743a996f4d7467700fc88      72500.00
9            21              0 425be85642b24cc2bc3d8a0bb3c7bc92      72500.00
10           20             11 793070ae7f5e42c2a76a58663a588f3d      64000.00
</code></pre>]]></content:encoded>
    </item>
    <item>
      <title>Getting data on your government</title>
      <link>http://localhost:1313/2012/09/gov-dat/</link>
      <pubDate>Sat, 01 Sep 2012 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2012/09/gov-dat/</guid>
      <description>I created an R package a while back to interact with some APIs that serve up data on what our elected represenatives are up to, including the New York Times Congress API, and the Sunlight Labs API.
What kinds of things can you do with govdat? Here are a few examples.
How do the two major parties differ in the use of certain words (searches the congressional record using the Sunlight Labs Capitol Words API)?</description>
      <content:encoded><![CDATA[<p>I created an R package a while back to interact with some APIs that serve up data on what our elected represenatives are up to, including the <a href="http://developer.nytimes.com/">New York Times Congress API</a>, and the <a href="http://services.sunlightlabs.com/">Sunlight Labs API</a>.</p>
<p>What kinds of things can you do with <code>govdat</code>?  Here are a few examples.</p>
<p><strong>How do the two major parties differ in the use of certain words (searches the congressional record using the Sunlight Labs Capitol Words API)?</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;govdat&#39;, &#39;sckott&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(govdat)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(reshape2)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggplot2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dems <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cw_dates</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;science&#34;</span>, start_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1996-01-20&#34;</span>, end_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2012-09-01&#34;</span>,
</span></span><span style="display:flex;"><span>    granularity <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;year&#34;</span>, party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D&#34;</span>, printdf <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>repubs <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sll_cw_dates</span>(phrase <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;science&#34;</span>, start_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1996-01-20&#34;</span>, end_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2012-09-01&#34;</span>,
</span></span><span style="display:flex;"><span>    granularity <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;year&#34;</span>, party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;R&#34;</span>, printdf <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">melt</span>(<span style="color:#a6e22e">rbind</span>(<span style="color:#a6e22e">data.frame</span>(party <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;D&#34;</span>, <span style="color:#a6e22e">nrow</span>(dems)), dems), <span style="color:#a6e22e">data.frame</span>(party <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;R&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">nrow</span>(repubs)), repubs)))
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">$</span>count <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>(df<span style="color:#f92672">$</span>count)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(df, <span style="color:#a6e22e">aes</span>(yearmonth, count, colour <span style="color:#f92672">=</span> party, group <span style="color:#f92672">=</span> party)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_line</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scale_colour_manual</span>(values <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;blue&#34;</span>, <span style="color:#e6db74">&#34;red&#34;</span>)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">labs</span>(y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;use of the word &#39;Science&#39;&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">theme_bw</span>(base_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">18</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">opts</span>(axis.text.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>), panel.grid.major <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_blank</span>(),
</span></span><span style="display:flex;"><span>    panel.grid.minor <span style="color:#f92672">=</span> <span style="color:#a6e22e">theme_blank</span>(), legend.position <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">0.8</span>))
</span></span></code></pre></div><p><img loading="lazy" src="/public/img/unnamed-chunk-1.png" alt="center"  />
</p>
<p><strong>Let&rsquo;s get some data on donations to individual elected representatives.</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(plyr)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Let&#39;s get Nancy Pelosi&#39;s entity ID</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">sll_ts_aggregatesearch</span>(<span style="color:#e6db74">&#34;Nancy Pelosi&#34;</span>)[[1]]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>name
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;Nancy Pelosi (D)&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>count_given
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>firm_income
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>count_lobbied
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>seat
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;federal:house&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>total_received
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">13769274</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>state
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;CA&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>lobbying_firm
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">NULL</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>count_received
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">9852</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>party
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;D&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>total_given
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>type
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;politician&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>id
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;85ab2e74589a414495d18cc7a9233981&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>non_firm_spending
</span></span><span style="display:flex;"><span>[1] <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>is_superpac
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">NULL</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Her entity ID</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">sll_ts_aggregatesearch</span>(<span style="color:#e6db74">&#34;Nancy Pelosi&#34;</span>)[[1]]<span style="color:#f92672">$</span>id
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;85ab2e74589a414495d18cc7a9233981&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># And search for her top donors by sector</span>
</span></span><span style="display:flex;"><span>nancy <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ldply</span>(<span style="color:#a6e22e">sll_ts_aggregatetopsectors</span>(<span style="color:#a6e22e">sll_ts_aggregatesearch</span>(<span style="color:#e6db74">&#34;Nancy Pelosi&#34;</span>)[[1]]<span style="color:#f92672">$</span>id))
</span></span><span style="display:flex;"><span>nancy  <span style="color:#75715e"># but just abbreviations for sectors</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>   sector count     amount
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       F  <span style="color:#ae81ff">1847</span> <span style="color:#ae81ff">2698672.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       P   <span style="color:#ae81ff">981</span> <span style="color:#ae81ff">2243050.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>       H   <span style="color:#ae81ff">829</span> <span style="color:#ae81ff">1412700.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       K  <span style="color:#ae81ff">1345</span> <span style="color:#ae81ff">1409836.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       Q  <span style="color:#ae81ff">1223</span> <span style="color:#ae81ff">1393154.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>       N   <span style="color:#ae81ff">829</span> <span style="color:#ae81ff">1166187.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>       B   <span style="color:#ae81ff">537</span>  <span style="color:#ae81ff">932044.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>       W   <span style="color:#ae81ff">724</span>  <span style="color:#ae81ff">760800.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>       Y   <span style="color:#ae81ff">820</span>  <span style="color:#ae81ff">664926.00</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>      E   <span style="color:#ae81ff">201</span>  <span style="color:#ae81ff">283575.00</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">data</span>(sll_ts_sectors)  <span style="color:#75715e"># load sectors abbrevations data</span>
</span></span><span style="display:flex;"><span>nancy2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">merge</span>(nancy, sll_ts_sectors, by <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sector&#34;</span>)  <span style="color:#75715e"># attach full sector names</span>
</span></span><span style="display:flex;"><span>nancy2_melt <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">melt</span>(nancy2[, <span style="color:#ae81ff">-1</span>], id.vars <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>nancy2_melt<span style="color:#f92672">$</span>value <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>(nancy2_melt<span style="color:#f92672">$</span>value)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># and lets plot some results</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(nancy2_melt, <span style="color:#a6e22e">aes</span>(sector_name, value)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_bar</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>variable,
</span></span><span style="display:flex;"><span>    scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><p><img loading="lazy" src="/public/img/unnamed-chunk-2.png" alt="center"  />
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## It looks like a lot of individual donations (the count facet) by</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## finance/insurance/realestate, but by amount, the most (by slim margin)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## is from labor organizations.</span>
</span></span></code></pre></div><p><strong>Or we may want to get a bio of a congressperson. Here we get Todd Akin of MO. And some twitter searching too? Indeed</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">nyt_cg_memberbioroles</span>(<span style="color:#e6db74">&#34;A000358&#34;</span>)  <span style="color:#75715e"># cool, lots of info, output cutoff for brevity</span>
</span></span><span style="display:flex;"><span>out[[3]][[1]][1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>member_id
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;A000358&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>first_name
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;Todd&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># we can get her twitter id from this bio, and search twitter using</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># twitteR package</span>
</span></span><span style="display:flex;"><span>akintwitter <span style="color:#f92672">&lt;-</span> out[[3]][[1]]<span style="color:#f92672">$</span>twitter_id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install.packages(&#39;twitteR&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(twitteR)
</span></span><span style="display:flex;"><span>tweets <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">userTimeline</span>(akintwitter, n <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>tweets[1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>]  <span style="color:#75715e"># there&#39;s some gems in there no doubt</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[[1]]
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;RepToddAkin: Do you receive my Akin Alert e-newsletter?  Pick the issues you’d like to get updates on and sign up here!\nhttp://t.co/nZfiRjTF&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[2]]
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;RepToddAkin: If the 2001 &amp;amp; 2003 tax policies expire, taxes will increase over $4 trillion in the next 10 years. America can&#39;t afford it. #stopthetaxhike&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[3]]
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;RepToddAkin: A govt agency&#39;s order shouldn&#39;t defy constitutional rights. I&#39;m still working for #religiousfreedom and repealing the HHS mandate. #prolife&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[4]]
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;RepToddAkin: I am a cosponsor of the bill being considered today to limit abortions in DC. RT if you agree! #prolife http://t.co/Mesrjl0w&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[5]]
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;RepToddAkin: We need to #StopTheTaxHike. Raising taxes like the President wants would destroy more than 700,000 jobs. #4jobs http://t.co/KUTd0M7U&#34;</span>
</span></span></code></pre></div><hr>
<p>Get the .Rmd file used to create this post <a href="https://github.com/sckott/sckott.github.com/tree/master/_drafts/2012-09-01-gov-dat.Rmd">at my github account</a> - or <a href="https://github.com/sckott/sckott.github.com/tree/master/_posts/2012-09-01-gov-dat.md">.md file</a>.</p>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>, and nice knitr highlighting/etc. in in <a href="http://rstudio.org/">RStudio</a>.</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
