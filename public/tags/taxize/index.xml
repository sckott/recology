<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Taxize on Recology</title>
    <link>http://localhost:1313/tags/taxize/</link>
    <description>Recent content in Taxize on Recology</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 02 Dec 2014 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/taxize/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>taxize workflows</title>
      <link>http://localhost:1313/2014/12/taxize-workflows/</link>
      <pubDate>Tue, 02 Dec 2014 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2014/12/taxize-workflows/</guid>
      <description>A missed chat on the rOpenSci website the other day asked:
Hi there, i am trying to use the taxize package and have a .csv file of species names to run through taxize updating them. What would be the code i would need to run to achieve this?
One way to answer this is to talk about the basic approach to importing data, doing stuff to the data, then recombining data.</description>
      <content:encoded><![CDATA[<p>A missed chat on the rOpenSci website the other day asked:</p>
<blockquote>
<p>Hi there, i am trying to use the taxize package and have a .csv file of species names to run through taxize updating them. What would be the code i would need to run to achieve this?</p>
</blockquote>
<p>One way to answer this is to talk about the basic approach to importing data, doing stuff to the data, then recombining data. There are many ways to do this, but I&rsquo;ll go over a few of them.</p>
<h2 id="install-taxize">Install taxize</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;taxize&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;downloader&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;taxize&#34;</span>)
</span></span></code></pre></div><h2 id="import-data">Import data</h2>
<p>We&rsquo;ll use Winston Chang&rsquo;s new <code>downloader</code> package to avoid problems with <code>https</code>, and get a dataset from our ropensci datasets repo <a href="https://github.com/ropensci/datasets">https://github.com/ropensci/datasets</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>downloader<span style="color:#f92672">::</span><span style="color:#a6e22e">download</span>(<span style="color:#e6db74">&#34;https://raw.githubusercontent.com/ropensci/datasets/master/planttraits/morphological.csv&#34;</span>, <span style="color:#e6db74">&#34;morphological.csv&#34;</span>)
</span></span><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>(<span style="color:#e6db74">&#34;morphological.csv&#34;</span>, stringsAsFactors <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(dat)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                  species log_SLA leaf_water_content log_wood_density</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1         Abies concolor    3.46               0.51            -0.52</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2          Abies grandis    3.58               0.49            -0.51</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 3        Abies magnifica    3.87               0.62            -0.53</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 4      Acacia farnesiana      NA                 NA               NA</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 5           Acer glabrum    5.07               0.69            -0.54</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 6 Adenostoma fasciculata    3.56               0.46            -0.31</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;   log_ht log_N</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1   7.72  0.02</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2   7.51 -0.31</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 3   7.58 -0.14</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 4   5.70    NA</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 5   3.25  1.02</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 6   5.33  0.29</span>
</span></span></code></pre></div><p>After importing data, there are a variety of approaches you could take:</p>
<ol>
<li>Vector: Take species names as vector from your <code>data.frame</code>, cleaning them, then re-attching to the <code>data.frame</code> later, or</li>
<li>In-Place: Use for loops or <code>lapply</code> family functions to iterate over each name while simultaneously re-inserting into the <code>data.frame</code></li>
</ol>
<h2 id="1-vector">1. Vector</h2>
<p>Make a vector of names</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>splist <span style="color:#f92672">&lt;-</span> dat<span style="color:#f92672">$</span>species
</span></span></code></pre></div><p>Then proceed to do name cleaning, e.g, we can use the <code>tnrs</code> function to see if any names are potentially not spelled correctly.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>tnrs_out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tnrs</span>(splist, source <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;iPlant_TNRS&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(tnrs_out)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;              submittedname             acceptedname    sourceid score</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1     Ceanothus prostratus     Ceanothus prostratus iPlant_TNRS     1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2          Abies magnifica          Abies magnifica iPlant_TNRS     1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 3 Arctostaphylos canescens Arctostaphylos canescens iPlant_TNRS     1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 4         Berberis nervosa         Berberis nervosa iPlant_TNRS     1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 5        Arbutus menziesii        Arbutus menziesii iPlant_TNRS     1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 6     Calocedrus decurrens     Calocedrus decurrens iPlant_TNRS     1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                matchedname      authority</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1     Ceanothus prostratus         Benth.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2          Abies magnifica  A. Murray bis</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 3 Arctostaphylos canescens         Eastw.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 4         Berberis nervosa          Pursh</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 5        Arbutus menziesii          Pursh</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 6     Calocedrus decurrens (Torr.) Florin</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                                     uri</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 http://www.tropicos.org/Name/27500276</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 http://www.tropicos.org/Name/24900142</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 3 http://www.tropicos.org/Name/12302547</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 4  http://www.tropicos.org/Name/3500175</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 5 http://www.tropicos.org/Name/12302436</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 6  http://www.tropicos.org/Name/9400069</span>
</span></span></code></pre></div><p>Those with score of less than 1 may have misspellings</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>tnrs_out[ tnrs_out<span style="color:#f92672">$</span>score <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>, ]
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                 submittedname              acceptedname    sourceid score</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 23     Adenostoma fasciculata   Adenostoma fasciculatum iPlant_TNRS  0.97</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 24 Arctostaphylos glandulosus Arctostaphylos glandulosa iPlant_TNRS  0.97</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 36        Chamaebatia foliosa     Chamaebatia foliolosa iPlant_TNRS  0.95</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 38     Juniperus californicus     Juniperus californica iPlant_TNRS  0.97</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 77         Prunus illicifolia         Prunus ilicifolia iPlant_TNRS  0.99</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 78         Prunus subcordatus         Prunus subcordata iPlant_TNRS  0.97</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                  matchedname                         authority</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 23   Adenostoma fasciculatum                      Hook. &amp; Arn.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 24 Arctostaphylos glandulosa                            Eastw.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 36     Chamaebatia foliolosa                            Benth.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 38     Juniperus californica                          Carrière</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 77         Prunus ilicifolia (Nutt. ex Hook. &amp; Arn.) D. Dietr.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 78         Prunus subcordata                            Benth.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                                      uri</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 23 http://www.tropicos.org/Name/27801458</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 24 http://www.tropicos.org/Name/12300542</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 36 http://www.tropicos.org/Name/27801486</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 38  http://www.tropicos.org/Name/9400374</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 77 http://www.tropicos.org/Name/27801102</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 78 http://www.tropicos.org/Name/27801124</span>
</span></span></code></pre></div><p>So let&rsquo;s take the <code>acceptedname</code> column as a the new names and assign to a new vector</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>cleaned_names <span style="color:#f92672">&lt;-</span> tnrs_out<span style="color:#f92672">$</span>acceptedname
</span></span></code></pre></div><p>Then join names back, replacing them, or adding as a new column</p>
<p>Replace</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat<span style="color:#f92672">$</span>species <span style="color:#f92672">&lt;-</span> cleaned_names
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(dat)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                    species log_SLA leaf_water_content log_wood_density</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1     Ceanothus prostratus    3.46               0.51            -0.52</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2          Abies magnifica    3.58               0.49            -0.51</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 3 Arctostaphylos canescens    3.87               0.62            -0.53</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 4         Berberis nervosa      NA                 NA               NA</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 5        Arbutus menziesii    5.07               0.69            -0.54</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 6     Calocedrus decurrens    3.56               0.46            -0.31</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;   log_ht log_N</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1   7.72  0.02</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2   7.51 -0.31</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 3   7.58 -0.14</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 4   5.70    NA</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 5   3.25  1.02</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 6   5.33  0.29</span>
</span></span></code></pre></div><p>New column</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat<span style="color:#f92672">$</span>species_cleaned <span style="color:#f92672">&lt;-</span> cleaned_names
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(dat)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                    species log_SLA leaf_water_content log_wood_density</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1     Ceanothus prostratus    3.46               0.51            -0.52</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2          Abies magnifica    3.58               0.49            -0.51</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 3 Arctostaphylos canescens    3.87               0.62            -0.53</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 4         Berberis nervosa      NA                 NA               NA</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 5        Arbutus menziesii    5.07               0.69            -0.54</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 6     Calocedrus decurrens    3.56               0.46            -0.31</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;   log_ht log_N          species_cleaned</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1   7.72  0.02     Ceanothus prostratus</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2   7.51 -0.31          Abies magnifica</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 3   7.58 -0.14 Arctostaphylos canescens</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 4   5.70    NA         Berberis nervosa</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 5   3.25  1.02        Arbutus menziesii</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 6   5.33  0.29     Calocedrus decurrens</span>
</span></span></code></pre></div><h2 id="2-in-place">2. In-place</h2>
<p>You can use functions from the <code>dplyr</code> package to <code>split-apply-combine</code>, where <code>split</code> is split apart your vector for each taxon, <code>apply</code> to apply a function or functions to do name cleaning, then <code>combine</code> to put them back together.</p>
<p>Here, we&rsquo;ll attach taxonomic ids from the Catalogue of Life to each species (each row) (with just a subset of the data to save time):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;dplyr&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tbl_df</span>(dat)[1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>,] <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">rowwise</span>() <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(colid <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_colid</span>(species)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">select</span>(species, colid)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Source: local data frame [5 x 2]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Groups: &lt;by row&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                    species    colid</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1     Ceanothus prostratus 19544732</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2          Abies magnifica 18158318</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 3 Arctostaphylos canescens 19358934</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 4         Berberis nervosa 19374077</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 5        Arbutus menziesii 19358819</span>
</span></span></code></pre></div><p>Let&rsquo;s do something a bit more complicated. Get common names for each taxon in a new column, if more than 1, concatenate into a single character string for easy inclusion in a <code>data.frame</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>sci2comm_concat <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(x){
</span></span><span style="display:flex;"><span>  temp <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sci2comm</span>(x, db <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;eol&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">length</span>(temp) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">NA</span> <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">paste0</span>(temp[[1]], collapse <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;, &#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dat_new <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tbl_df</span>(dat)[1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>,] <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">rowwise</span>() <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(comm <span style="color:#f92672">=</span> <span style="color:#a6e22e">sci2comm_concat</span>(species))
</span></span></code></pre></div><p>To see the new column, do</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat_new <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">select</span>(comm)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Source: local data frame [5 x 1]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Groups: &lt;by row&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                                                                          comm</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1                      Mahala-mat Ceanothus, prostrate ceanothus, squawcarpet</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 Prächtige Tanne, Goldtanne (Gold-Tanne), Kalifornische Rot-Tanne, Pracht-Ta</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 3                          hoary manzanita, hoary manzanita, Sonoma manzanita</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 4 Longleaf Oregon-grape, Cascade barberry, Dull Oregon grape, Oregon grape-ho</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 5                   pacific madrone, Madrona, madrone, Kalifornianmansikkapuu</span>
</span></span></code></pre></div>]]></content:encoded>
    </item>
    <item>
      <title>1000 commits to taxize</title>
      <link>http://localhost:1313/2014/11/taxize-1000/</link>
      <pubDate>Fri, 28 Nov 2014 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2014/11/taxize-1000/</guid>
      <description>Just today we&amp;rsquo;ve hit 1000 commits on taxize! taxize is an R client to search across lots of taxonomic databases on the web. In honor of the 1000 commit milestone, here&amp;rsquo;s some stats on the project.
Before that, lots of people have contributed to taxize, it&amp;rsquo;s a big group effort:
Eduard Szöcs Zachary Foster Carl Boettiger Karthik Ram Jari Oksanen Francis Michonneau Oliver Keyes David LeBauer Ben Marwick Anirvan Chatterjee In addition, we&amp;rsquo;ve had lots of feedback from users, including feature requests and bug reports, making taxize a lot better.</description>
      <content:encoded><![CDATA[<p>Just today we&rsquo;ve hit 1000 commits on <code>taxize</code>!  <code>taxize</code> is an R client to search across lots of taxonomic databases on the web. In honor of the 1000 commit milestone, here&rsquo;s some stats on the project.</p>
<p>Before that, lots of people have contributed to <code>taxize</code>, it&rsquo;s a big group effort:</p>
<ul>
<li><a href="https://github.com/EDiLD">Eduard Szöcs</a></li>
<li><a href="https://github.com/zachary-foster">Zachary Foster</a></li>
<li><a href="https://github.com/cboettig">Carl Boettiger</a></li>
<li><a href="https://github.com/karthik">Karthik Ram</a></li>
<li><a href="https://github.com/jarioksa">Jari Oksanen</a></li>
<li><a href="https://github.com/fmichonneau">Francis Michonneau</a></li>
<li><a href="https://github.com/Ironholds">Oliver Keyes</a></li>
<li><a href="https://github.com/dlebauer">David LeBauer</a></li>
<li><a href="https://github.com/benmarwick">Ben Marwick</a></li>
<li><a href="https://github.com/anirvan">Anirvan Chatterjee</a></li>
</ul>
<p>In addition, we&rsquo;ve had lots of feedback from users, including feature requests and bug reports, making <code>taxize</code> a lot better.</p>
<h2 id="setup">Setup</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;devtools&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;httr&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;ggplot2&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;stringr&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;plyr&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;dplyr&#34;</span>)
</span></span></code></pre></div><h2 id="define-functions">Define functions</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>github_auth <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(appname <span style="color:#f92672">=</span> <span style="color:#a6e22e">getOption</span>(<span style="color:#e6db74">&#34;gh_appname&#34;</span>), key <span style="color:#f92672">=</span> <span style="color:#a6e22e">getOption</span>(<span style="color:#e6db74">&#34;gh_id&#34;</span>),
</span></span><span style="display:flex;"><span>                        secret <span style="color:#f92672">=</span> <span style="color:#a6e22e">getOption</span>(<span style="color:#e6db74">&#34;gh_secret&#34;</span>)) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">is.null</span>(<span style="color:#a6e22e">getOption</span>(<span style="color:#e6db74">&#34;gh_token&#34;</span>))) {
</span></span><span style="display:flex;"><span>    myapp <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">oauth_app</span>(appname, key, secret)
</span></span><span style="display:flex;"><span>    token <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">oauth2.0_token</span>(<span style="color:#a6e22e">oauth_endpoints</span>(<span style="color:#e6db74">&#34;github&#34;</span>), myapp)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">options</span>(gh_token <span style="color:#f92672">=</span> token)
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    token <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">getOption</span>(<span style="color:#e6db74">&#34;gh_token&#34;</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>(token)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>make_url <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(x, y, z) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sprintf</span>(<span style="color:#e6db74">&#34;https://api.github.com/repos/%s/%s/%s&#34;</span>, x, y, z)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>process_result <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(x) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">stop_for_status</span>(x)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>x<span style="color:#f92672">$</span>headers<span style="color:#f92672">$</span>`content-type` <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;application/json; charset=utf-8&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">stop</span>(<span style="color:#e6db74">&#34;content type mismatch&#34;</span>)
</span></span><span style="display:flex;"><span>  tmp <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">content</span>(x, as <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;text&#34;</span>)
</span></span><span style="display:flex;"><span>  jsonlite<span style="color:#f92672">::</span><span style="color:#a6e22e">fromJSON</span>(tmp, flatten <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gh_commits <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(repo, owner <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ropensci&#34;</span>, <span style="color:#66d9ef">...</span>) {
</span></span><span style="display:flex;"><span>  token <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">github_auth</span>()
</span></span><span style="display:flex;"><span>  outout <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">list</span>(); iter <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">0</span>; nexturl <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;dontstop&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span>(nexturl <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;stop&#34;</span>){
</span></span><span style="display:flex;"><span>    iter <span style="color:#f92672">&lt;-</span> iter <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    req <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">grepl</span>(<span style="color:#e6db74">&#34;https:/&#34;</span>, nexturl)) <span style="color:#a6e22e">GET</span>(nexturl, config <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(token <span style="color:#f92672">=</span> token)) <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">GET</span>(<span style="color:#a6e22e">make_url</span>(owner, repo, <span style="color:#e6db74">&#34;commits&#34;</span>), query <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(per_page<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>), config <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(token <span style="color:#f92672">=</span> token))
</span></span><span style="display:flex;"><span>    outout[[iter]] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">process_result</span>(req)
</span></span><span style="display:flex;"><span>    link <span style="color:#f92672">&lt;-</span> req<span style="color:#f92672">$</span>headers<span style="color:#f92672">$</span>link
</span></span><span style="display:flex;"><span>    nexturl <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">is.null</span>(link)){ <span style="color:#e6db74">&#34;stop&#34;</span> } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">grepl</span>(<span style="color:#e6db74">&#34;next&#34;</span>, link)){
</span></span><span style="display:flex;"><span>        stringr<span style="color:#f92672">::</span><span style="color:#a6e22e">str_extract</span>(link, <span style="color:#e6db74">&#34;https://[0-9A-Za-z/?=\\._&amp;]+&#34;</span>)
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;stop&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  outout <span style="color:#f92672">&lt;-</span> outout<span style="color:#a6e22e">[sapply</span>(outout, <span style="color:#66d9ef">function</span>(x) <span style="color:#f92672">!</span><span style="color:#a6e22e">identical</span>(x, <span style="color:#a6e22e">list</span>()))]
</span></span><span style="display:flex;"><span>  dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">rbind_all</span>(outout)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gh_issues <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(repo, owner <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ropensci&#34;</span>, <span style="color:#66d9ef">...</span>) {
</span></span><span style="display:flex;"><span>  token <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">github_auth</span>()
</span></span><span style="display:flex;"><span>  outout <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">list</span>(); iter <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">0</span>; nexturl <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;dontstop&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span>(nexturl <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;stop&#34;</span>){
</span></span><span style="display:flex;"><span>    iter <span style="color:#f92672">&lt;-</span> iter <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    req <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">grepl</span>(<span style="color:#e6db74">&#34;https:/&#34;</span>, nexturl)) <span style="color:#a6e22e">GET</span>(nexturl, query<span style="color:#f92672">=</span><span style="color:#a6e22e">list</span>(state<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;all&#34;</span>), config <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(token <span style="color:#f92672">=</span> token)) <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">GET</span>(<span style="color:#a6e22e">make_url</span>(owner, repo, <span style="color:#e6db74">&#34;issues&#34;</span>), query <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(per_page<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, state<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;all&#34;</span>), config <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(token <span style="color:#f92672">=</span> token))
</span></span><span style="display:flex;"><span>    outout[[iter]] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">process_result</span>(req)
</span></span><span style="display:flex;"><span>    link <span style="color:#f92672">&lt;-</span> req<span style="color:#f92672">$</span>headers<span style="color:#f92672">$</span>link
</span></span><span style="display:flex;"><span>    nexturl <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">is.null</span>(link)){ <span style="color:#e6db74">&#34;stop&#34;</span> } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">grepl</span>(<span style="color:#e6db74">&#34;next&#34;</span>, link)){
</span></span><span style="display:flex;"><span>        stringr<span style="color:#f92672">::</span><span style="color:#a6e22e">str_extract</span>(link, <span style="color:#e6db74">&#34;https://[0-9A-Za-z/?=\\._&amp;]+&#34;</span>)
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;stop&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  outout <span style="color:#f92672">&lt;-</span> outout<span style="color:#a6e22e">[sapply</span>(outout, <span style="color:#66d9ef">function</span>(x) <span style="color:#f92672">!</span><span style="color:#a6e22e">identical</span>(x, <span style="color:#a6e22e">list</span>()))]
</span></span><span style="display:flex;"><span>  dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">rbind_all</span>(outout)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gh_commit <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(sha, repo, owner <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ropensci&#34;</span>, <span style="color:#66d9ef">...</span>) {
</span></span><span style="display:flex;"><span>  token <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">github_auth</span>()
</span></span><span style="display:flex;"><span>  req <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">GET</span>(<span style="color:#a6e22e">paste0</span>(<span style="color:#a6e22e">make_url</span>(owner, repo, <span style="color:#e6db74">&#34;commits&#34;</span>), <span style="color:#e6db74">&#34;/&#34;</span>, sha),
</span></span><span style="display:flex;"><span>             config <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(token <span style="color:#f92672">=</span> token, <span style="color:#66d9ef">...</span>))
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">process_result</span>(req)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gh_verb <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(owner <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ropensci&#34;</span>, repo, verb, args<span style="color:#f92672">=</span><span style="color:#a6e22e">list</span>(), <span style="color:#66d9ef">...</span>) {
</span></span><span style="display:flex;"><span>  token <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">github_auth</span>()
</span></span><span style="display:flex;"><span>  req <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">GET</span>(<span style="color:#a6e22e">make_url</span>(owner, repo, verb), query<span style="color:#f92672">=</span>args, config <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(token <span style="color:#f92672">=</span> token, <span style="color:#66d9ef">...</span>))
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">process_result</span>(req)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="commits">Commits</h2>
<p>List of commits</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">gh_commits</span>(<span style="color:#e6db74">&#34;taxize&#34;</span>)
</span></span></code></pre></div><p>Get changes for each commit</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>changes <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">vapply</span>(out<span style="color:#f92672">$</span>sha, <span style="color:#66d9ef">function</span>(x) <span style="color:#a6e22e">gh_commit</span>(x, repo<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;taxize&#34;</span>)<span style="color:#f92672">$</span>stats<span style="color:#f92672">$</span>total, <span style="color:#a6e22e">numeric</span>(<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>changesdf <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">data.frame</span>(changes<span style="color:#f92672">=</span><span style="color:#a6e22e">unname</span>(changes), sha<span style="color:#f92672">=</span><span style="color:#a6e22e">names</span>(changes))
</span></span></code></pre></div><p>Combine</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">inner_join</span>(out, changesdf)
</span></span></code></pre></div><p>Total changes through time (additions + deletions)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>ct <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(x) <span style="color:#a6e22e">as.POSIXct</span>(x, format<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;%Y-%m-%dT%H:%M:%SZ&#34;</span>, tz<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTC&#34;</span>)
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(commit.committer.date <span style="color:#f92672">=</span> <span style="color:#a6e22e">ct</span>(commit.committer.date)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>commit.committer.date, y<span style="color:#f92672">=</span>changes)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_area</span>(fill<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#87D2A0&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">theme_grey</span>(base_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>)
</span></span></code></pre></div><p><img loading="lazy" src="/2014-11-28-taxize-1000/unnamed-chunk-7-1.png" alt=""  />
</p>
<p>By Authors</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(author.login) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">summarise</span>(n <span style="color:#f92672">=</span> <span style="color:#a6e22e">n</span>()) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(author.login, n)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_bar</span>(stat <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;identity&#34;</span>, fill<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#87D2A0&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">theme_grey</span>(base_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>)
</span></span></code></pre></div><p><img loading="lazy" src="/2014-11-28-taxize-1000/unnamed-chunk-8-1.png" alt=""  />
</p>
<h2 id="issues">Issues</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">gh_issues</span>(<span style="color:#e6db74">&#34;taxize&#34;</span>)
</span></span></code></pre></div><p>Number of issues</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">NROW</span>(out)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 382</span>
</span></span></code></pre></div><p>Number of open issues</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span>(state <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;open&#34;</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  NROW
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 35</span>
</span></span></code></pre></div><p>Number of pull requests</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">is.na</span>(pull_request.url)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  NROW
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 119</span>
</span></span></code></pre></div><h2 id="forks-number-of">Forks, number of</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">NROW</span>(<span style="color:#a6e22e">gh_verb</span>(repo <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;taxize&#34;</span>, verb<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;forks&#34;</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 16</span>
</span></span></code></pre></div><h2 id="stars-number-of">Stars, number of</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">NROW</span>(<span style="color:#a6e22e">gh_verb</span>(repo <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;taxize&#34;</span>, verb<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stargazers&#34;</span>, args<span style="color:#f92672">=</span><span style="color:#a6e22e">list</span>(per_page<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 44</span>
</span></span></code></pre></div><h2 id="watchers-number-of">Watchers, number of</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">NROW</span>(<span style="color:#a6e22e">gh_verb</span>(repo <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;taxize&#34;</span>, verb<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;subscribers&#34;</span>, args<span style="color:#f92672">=</span><span style="color:#a6e22e">list</span>(per_page<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 12</span>
</span></span></code></pre></div>]]></content:encoded>
    </item>
    <item>
      <title>Resolving species names when you have a lot of them</title>
      <link>http://localhost:1313/2013/01/tnrs-use-case/</link>
      <pubDate>Fri, 25 Jan 2013 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2013/01/tnrs-use-case/</guid>
      <description>taxize use case: Resolving species names when you have a lot of them Species names can be a pain in the ass, especially if you are an ecologist. We ecologists aren&amp;rsquo;t trained in taxonomy, yet we often end up with huge species lists. Of course we want to correct any spelling errors in the names, and get the newest names for our species, resolve any synonyms, etc.
We are building tools into our R package taxize, that will let you check your species names to make sure they are correct.</description>
      <content:encoded><![CDATA[<h3 id="__taxize-use-case-resolving-species-names-when-you-have-a-lot-of-them__"><strong>taxize use case: Resolving species names when you have a lot of them</strong></h3>
<p>Species names can be a pain in the ass, especially if you are an ecologist. We ecologists aren&rsquo;t trained in taxonomy, yet we often end up with huge species lists.  Of course we want to correct any spelling errors in the names, and get the newest names for our species, resolve any synonyms, etc.</p>
<p>We are building tools into our R package <a href="http://ropensci.github.com/taxize_/"><code>taxize</code></a>, that will let you check your species names to make sure they are correct.</p>
<p>An important use case is when you have a lot of species. Someone wrote to us recently, saying that they had thousands of species, and they wanted to know how to check their species names efficiently in R.</p>
<p>Below is an example of how to do this.</p>
<h4 id="install-taxize">Install taxize</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;taxize_&#39;, &#39;ropensci&#39;) # install the GitHub version, not</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># the CRAN version, uncomment if you don&#39;t have it installed</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(taxize)
</span></span></code></pre></div><h4 id="get-some-species-in-this-case-all-species-in-the-scrophulariaceae-family-from-theplantlistorg">Get some species, in this case all species in the Scrophulariaceae family from theplantlist.org</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">tpl_get</span>(dir_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;~/foo2&#34;</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Scrophulariaceae&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">## Reading and writing csv files to ~/foo2...</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>(<span style="color:#e6db74">&#34;~/foo2/Scrophulariaceae.csv&#34;</span>)
</span></span></code></pre></div><h4 id="lets-grab-the-species-and-concatenate-to-genus_species">Lets grab the species and concatenate to genus_species</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>species <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.character</span>(<span style="color:#a6e22e">ddply</span>(dat[, <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Genus&#34;</span>, <span style="color:#e6db74">&#34;Species&#34;</span>)], .(), transform, 
</span></span><span style="display:flex;"><span>    gen_sp <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.factor</span>(<span style="color:#a6e22e">paste</span>(Genus, Species, sep <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; &#34;</span>)))[, <span style="color:#ae81ff">4</span>])
</span></span></code></pre></div><h4 id="its-better-to-do-many-smaller-calls-to-a-web-api-instead-of-few-big-ones-to-be-nice-to-the-database-maintainers">It&rsquo;s better to do many smaller calls to a web API instead of few big ones to be nice to the database maintainers.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">## Define function to split up your species list into useable chuncks</span>
</span></span><span style="display:flex;"><span>slice <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(input, by <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>) {
</span></span><span style="display:flex;"><span>    starts <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">length</span>(input), by)
</span></span><span style="display:flex;"><span>    tt <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lapply</span>(starts, <span style="color:#66d9ef">function</span>(y) input[y<span style="color:#f92672">:</span>(y <span style="color:#f92672">+</span> (by <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>))])
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">llply</span>(tt, <span style="color:#66d9ef">function</span>(x) x[<span style="color:#f92672">!</span><span style="color:#a6e22e">is.na</span>(x)])
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>species_split <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">slice</span>(species, by <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>)
</span></span></code></pre></div><h4 id="query-for-your-large-species-list-with-pauses-between-calls-with-3-seconds-in-between-calls-to-not-hit-the-web-service-too-hard-using-post-method-here-instead-of-get---required-when-you-have-a-lot-of-species">Query for your large species list with pauses between calls, with 3 seconds in between calls to not hit the web service too hard. Using POST method here instead of GET - required when you have a lot of species.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>tnrs_safe <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">failwith</span>(<span style="color:#66d9ef">NULL</span>, tnrs)  <span style="color:#75715e"># in case some calls fail, will continue</span>
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">llply</span>(species_split, <span style="color:#66d9ef">function</span>(x) <span style="color:#a6e22e">tnrs_safe</span>(x, getpost <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;POST&#34;</span>, sleep <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">90</span>fcd9ae425ad7c6103b06dd9fd78ae2
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">223</span>f73b83fcddcb8b6187966963660a8
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">72</span>bacdbb8938316e321d4c709c8cdd09
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">979</span>ce9cc4dec376710f61de162e1294e
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">03</span>a39a124561fec2fdfc0f483d9fb607
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span>d4bf4e5a1403f45a1be1ca3dd87785d7
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span>a9a9bdde6fda7e325d80120e27ccb480
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">215</span>ccdcf2b00362278bf19d1942e1395
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">9</span>d43c0b99b4dfb5ea1b435adab17b980
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">42e166</span>f8e43f1fb349e36459cd5938b3
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>c42e4b5227c5464f9bfeeafcdf0651d
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Looks like we got some data back for each element of our species list</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">lapply</span>(out, head)[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>]  <span style="color:#75715e"># just look at the first two</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[[1]]
</span></span><span style="display:flex;"><span>                 submittedName                 acceptedName    sourceId
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>        Aptosimum welwitschii                              iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>        Anticharis ebracteata        Anticharis ebracteata iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>            Aptosimum lineare            Aptosimum lineare iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     Antherothamnus pearsonii     Antherothamnus pearsonii iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> Barthlottia madagascariensis Barthlottia madagascariensis iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>         Agathelpis mucronata                              iPlant_TNRS
</span></span><span style="display:flex;"><span>  score                  matchedName     annotations
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>     <span style="color:#ae81ff">1</span>        Aptosimum welwitschii                
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">1</span>        Anticharis ebracteata          Schinz
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>     <span style="color:#ae81ff">1</span>            Aptosimum lineare Marloth <span style="color:#f92672">&amp;</span> Engl.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">1</span>     Antherothamnus pearsonii        N.E. Br.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>     <span style="color:#ae81ff">1</span> Barthlottia madagascariensis      Eb. Fisch.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>     <span style="color:#ae81ff">1</span>         Agathelpis mucronata                
</span></span><span style="display:flex;"><span>                                    uri
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                                      
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202501</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202525</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202728</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">50089700</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>                                      
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[2]]
</span></span><span style="display:flex;"><span>                     submittedName           acceptedName    sourceId
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> Buddleja pichinchensis x bullata Buddleja pichinchensis iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>                 Buddleja soratae       Buddleja soratae iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>              Buddleja euryphylla    Buddleja euryphylla iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>                  Buddleja incana        Buddleja incana iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>                  Buddleja incana                 Incana        NCBI
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>                    Buddleja nana Buddleja brachystachya iPlant_TNRS
</span></span><span style="display:flex;"><span>  score            matchedName        annotations
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   <span style="color:#ae81ff">0.9</span> Buddleja pichinchensis              Kunth
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   <span style="color:#ae81ff">1.0</span>       Buddleja soratae           Kraenzl.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>   <span style="color:#ae81ff">1.0</span>    Buddleja euryphylla Standl. <span style="color:#f92672">&amp;</span> Steyerm.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>   <span style="color:#ae81ff">1.0</span>        Buddleja incana        Ruiz <span style="color:#f92672">&amp;</span> Pav.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>   <span style="color:#ae81ff">1.0</span>        Buddleja incana               none
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>   <span style="color:#ae81ff">1.0</span>          Buddleja nana              Diels
</span></span><span style="display:flex;"><span>                                          uri
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19000333</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19001018</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19000790</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19000596</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> http<span style="color:#f92672">://</span>www.ncbi.nlm.nih.gov<span style="color:#f92672">/</span>taxonomy<span style="color:#f92672">/</span><span style="color:#ae81ff">405077</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19001133</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Now we can put them back together as so into one data.frame if you like</span>
</span></span><span style="display:flex;"><span>outdf <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ldply</span>(out)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(outdf)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>                 submittedName                 acceptedName    sourceId
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>        Aptosimum welwitschii                              iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>        Anticharis ebracteata        Anticharis ebracteata iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>            Aptosimum lineare            Aptosimum lineare iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     Antherothamnus pearsonii     Antherothamnus pearsonii iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> Barthlottia madagascariensis Barthlottia madagascariensis iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>         Agathelpis mucronata                              iPlant_TNRS
</span></span><span style="display:flex;"><span>  score                  matchedName     annotations
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>     <span style="color:#ae81ff">1</span>        Aptosimum welwitschii                
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">1</span>        Anticharis ebracteata          Schinz
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>     <span style="color:#ae81ff">1</span>            Aptosimum lineare Marloth <span style="color:#f92672">&amp;</span> Engl.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">1</span>     Antherothamnus pearsonii        N.E. Br.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>     <span style="color:#ae81ff">1</span> Barthlottia madagascariensis      Eb. Fisch.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>     <span style="color:#ae81ff">1</span>         Agathelpis mucronata                
</span></span><span style="display:flex;"><span>                                    uri
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                                      
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202501</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202525</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202728</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">50089700</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>
</span></span></code></pre></div><p>Note that there are multiple names for some species because data sources have different names for the same species (resulting in more than one row in the data.frame &lsquo;outdf&rsquo; for a species). We are leaving this up to the user to decide which to use. For example, for the species <em>Buddleja montana</em> there are two names for in the output</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ddply</span>(outdf, .(submittedName), summarize, <span style="color:#a6e22e">length</span>(submittedName))
</span></span><span style="display:flex;"><span>outdf[outdf<span style="color:#f92672">$</span>submittedName <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">as.character</span>(data[data<span style="color:#f92672">$</span><span style="color:#66d9ef">..1</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>, ][6, <span style="color:#e6db74">&#34;submittedName&#34;</span>]), 
</span></span><span style="display:flex;"><span>    ]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>       submittedName     acceptedName    sourceId score      matchedName
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">123</span> Buddleja montana Buddleja montana iPlant_TNRS     <span style="color:#ae81ff">1</span> Buddleja montana
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">124</span> Buddleja montana          Montana        NCBI     <span style="color:#ae81ff">1</span> Buddleja montana
</span></span><span style="display:flex;"><span>         annotations                                         uri
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">123</span> Britton ex Rusby       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19000601</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">124</span>             none http<span style="color:#f92672">://</span>www.ncbi.nlm.nih.gov<span style="color:#f92672">/</span>taxonomy<span style="color:#f92672">/</span><span style="color:#ae81ff">441235</span>
</span></span></code></pre></div><p>The source iPlant matched the name, but NCBI actually gave back a genus of cricket (follow the link under the column uri for <em>Montana</em>). If you look at the page for <em>Buddleja</em> on NCBI <a href="http://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?id=26473">here</a> there is no <em>Buddleja montana</em> at all.</p>
<p>Another thing we could do is look at the score that is returned. Let&rsquo;s look at those that are less than 1 (i.e., )</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>outdf[outdf<span style="color:#f92672">$</span>score <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>, ]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>                        submittedName           acceptedName    sourceId
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">94</span>   Buddleja pichinchensis x bullata Buddleja pichinchensis iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">340</span>                Diascia ellaphieae                        iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">495</span>              Eremophila decipiens                        iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">500</span>            Eremophila grandiflora             Eremophila iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">808</span>           Jamesbrittneia hilliard                        iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1051</span>                 Verbascum patris              Verbascum iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1081</span>             Verbascum barnadesii              Verbascum iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1097</span>              Verbascum calycosum              Verbascum iPlant_TNRS
</span></span><span style="display:flex;"><span>     score            matchedName annotations
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">94</span>    <span style="color:#ae81ff">0.90</span> Buddleja pichinchensis       Kunth
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">340</span>   <span style="color:#ae81ff">0.98</span>      Diascia ellaphiae            
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">495</span>   <span style="color:#ae81ff">0.98</span>  Eremophila decipiense            
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">500</span>   <span style="color:#ae81ff">0.50</span>             Eremophila      R. Br.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">808</span>   <span style="color:#ae81ff">0.50</span>         Jamesbrittenia            
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1051</span>  <span style="color:#ae81ff">0.50</span>              Verbascum          L.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1081</span>  <span style="color:#ae81ff">0.50</span>              Verbascum          L.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1097</span>  <span style="color:#ae81ff">0.50</span>              Verbascum          L.
</span></span><span style="display:flex;"><span>                                       uri
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">94</span>   http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19000333</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">340</span>                                       
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">495</span>                                       
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">500</span>  http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">40004761</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">808</span>                                       
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1051</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">40023766</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1081</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">40023766</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1097</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">40023766</span>
</span></span></code></pre></div><p>As we got this speies list from <a href="http://www.theplantlist.org/">theplantlist.org</a>, there aren&rsquo;t that many mistakes, but if it was my species list you know there would be many :)</p>
<p>That&rsquo;s it.  Try it out and let us know if you have any questions at <a href="mailto:info@ropensci.org">info@ropensci.org</a>, or <a href="https://github.com/ropensci/taxize_/issues">ask questions/report problems at GitHub</a>.</p>
<hr>
<p>Get the .Rmd file used to create this post <a href="https://github.com/sckott/sckott.github.com/tree/master/2013-01-25-tnrs-use-case.Rmd">at my github account</a> - or <a href="https://github.com/sckott/sckott.github.com/tree/master/_posts/2013-01-25-tnrs-use-case.md">.md file</a>.</p>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Is invasive?</title>
      <link>http://localhost:1313/2012/12/is-invasive/</link>
      <pubDate>Thu, 13 Dec 2012 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2012/12/is-invasive/</guid>
      <description>The Global Invasive Species Database (GISD) (see their website for more info here) has data on the invasiveness status of many species. From taxize you can now query the GISD database.
Introducing the function gisd_isinvasive. This function was contributed to taxize by Ignasi Bartomeus, a postdoc at the Swedish University Agricultural Sciences.
There are two possible outputs from using gisd_isinvasive: &amp;ldquo;Invasive&amp;rdquo; or &amp;ldquo;Not in GISD&amp;rdquo;. If you use simplify=TRUE in the function you get &amp;ldquo;Invasive&amp;rdquo; or &amp;ldquo;Not in GISD&amp;rdquo;, but if you use simplify=FALSE you get verbose description of the invasive species instead of just &amp;ldquo;Invasive&amp;rdquo; (and you still just get &amp;ldquo;Not in GISD&amp;rdquo;).</description>
      <content:encoded><![CDATA[<p>The Global Invasive Species Database (GISD) (see their website for more info <a href="http://www.issg.org/database/welcome/">here</a>) has data on the invasiveness status of many species. From <code>taxize</code> you can now query the GISD database.</p>
<p>Introducing the function <code>gisd_isinvasive</code>. This function was contributed to <code>taxize</code> by <a href="http://www.bartomeus.cat/es/ignasi/">Ignasi Bartomeus</a>, a postdoc at the Swedish University Agricultural Sciences.</p>
<p>There are two possible outputs from using <code>gisd_isinvasive</code>: &ldquo;Invasive&rdquo; or &ldquo;Not in GISD&rdquo;. If you use <code>simplify=TRUE</code> in the function you get &ldquo;Invasive&rdquo; or &ldquo;Not in GISD&rdquo;, but if you use <code>simplify=FALSE</code> you get verbose description of the invasive species instead of just &ldquo;Invasive&rdquo; (and you still just get &ldquo;Not in GISD&rdquo;).</p>
<hr>
<p><img loading="lazy" src="/gisd_small.png" alt="center"  />
</p>
<hr>
<h3 id="install-taxize-from-github">Install taxize from GitHub</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;taxize_&#39;, &#39;ropensci&#39;) # install if you don&#39;t already</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># have the GitHub version</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(taxize)
</span></span></code></pre></div><hr>
<h3 id="make-a-vector-of-species">Make a vector of species</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>sp <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Carpobrotus edulis&#34;</span>, <span style="color:#e6db74">&#34;Rosmarinus officinalis&#34;</span>, <span style="color:#e6db74">&#34;Nasua nasua&#34;</span>, <span style="color:#e6db74">&#34;Martes melampus&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Centaurea solstitialis&#34;</span>)
</span></span></code></pre></div><h3 id="using-the-function-gisd_isinvasive-you-can-query-the-gisd-database-for-the-invasiveness-status-of-your-species-at-least-according-to-gisd-calling-gisd_isinvasive-with-the-second-parameter-set-to-default-simplifyfalse-you-get-verbose-output-with-details-on-the-species">Using the function <code>gisd_isinvasive</code> you can query the GISD database for the invasiveness status of your species, at least according to GISD. Calling <code>gisd_isinvasive</code> with the second parameter set to default <code>simplify=FALSE</code>, you get verbose output, with details on the species.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gisd_isinvasive</span>(sp)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>Checking species <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Checking species <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Checking species <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>Checking species <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>Checking species <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>Done
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                 species
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>     Carpobrotus edulis
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> Rosmarinus officinalis
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>            Nasua nasua
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>        Martes melampus
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> Centaurea solstitialis
</span></span><span style="display:flex;"><span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               status
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                                                                                                                                                                                                                                                  You searched <span style="color:#66d9ef">for</span> invasive species named Carpobrotus edulis<span style="color:#f92672">:</span>     <span style="color:#ae81ff">1</span>.  Carpobrotus <span style="color:#a6e22e">edulis </span>(succulent)        Carpobrotus edulis is a mat<span style="color:#f92672">-</span>forming succulent native to South Africa which is invasive primarily <span style="color:#66d9ef">in</span> coastal habitats <span style="color:#66d9ef">in</span> many parts of the world. It was often introduced as an ornamental plant or used <span style="color:#66d9ef">for</span> planting along roadsides, from which it has spread to become invasive. Its main impacts are smothering, reduced regeneration of native flora and changes to soil pH and nutrient regimes.\r\nCommon Names<span style="color:#f92672">:</span> balsamo, Cape fig, figue marine, freeway iceplant, ghaukum, ghoenavy, highway ice plant, higo del Cabo, higo marino, Hottentosvy, hottentot fig, Hottentottenfeige, iceplant, ikhambi<span style="color:#f92672">-</span>lamabulawo, Kaapsevy, patata frita, perdevy, pigface, rankvy, sea fig, sour fig, suurvy, umgongozi, vyerank\r\nSynonyms<span style="color:#f92672">:</span> Mesembryanthemum edule L., Mesembryanthemum edulis
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Not <span style="color:#66d9ef">in</span> GISD
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            You searched <span style="color:#66d9ef">for</span> invasive species named Nasua nasua<span style="color:#f92672">:</span><span style="color:#ae81ff">1</span>.  Nasua <span style="color:#a6e22e">nasua </span>(mammal)             Interim profile, incomplete informationCommon Names<span style="color:#f92672">:</span> Achuni, Coatí, South American Coati, Tejón
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       You searched <span style="color:#66d9ef">for</span> invasive species named Martes melampus<span style="color:#f92672">:</span><span style="color:#ae81ff">1</span>.  Martes <span style="color:#a6e22e">melampus </span>(mammal)             Interim profile, incomplete informationCommon Names<span style="color:#f92672">:</span> Japanese Marten, Tsushima Island Marten
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> You searched <span style="color:#66d9ef">for</span> invasive species named Centaurea solstitialis<span style="color:#f92672">:</span>     <span style="color:#ae81ff">1</span>.  Centaurea <span style="color:#a6e22e">solstitialis </span>(herb)        Centaurea solstitialis is a winter annual that can form dense impenetrable stands that displace desirable vegetation <span style="color:#66d9ef">in</span> natural areas, rangelands, and other places. It is best adapted to open grasslands with deep, well<span style="color:#f92672">-</span>drained soils and an annual precipitation range of <span style="color:#ae81ff">25</span> to <span style="color:#ae81ff">150</span>cm per year. It is intolerant of shade. Although populations can occur at elevations as high as <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">400</span> m, most large infestations are found below <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">500</span> m. Human activities are the primary mechanisms <span style="color:#66d9ef">for</span> the long distance movement of C. solstitialis seed. The short, stiff, pappus bristles are covered with barbs that readily adhere to clothing, hair, and fur.  The movement of contaminated hay and uncertified seed are also important long distance transportation mechanisms. Wind disperses seeds over short distances.\r\nCommon Names<span style="color:#f92672">:</span> geeldissel, golden star thistle, sonnwend<span style="color:#f92672">-</span>Flockenblume, St. Barnaby<span style="color:#e6db74">&#39;</span><span style="color:#960050;background-color:#1e0010">s thistle, yellow centaury, yellow cockspur, yellow star thistle\r\nSynonyms: Leucantha solstitialis (L.) A.&amp; D. Löve</span>
</span></span></code></pre></div><h3 id="simpler-output-just-the-invasive-status">Simpler output, just the invasive status.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gisd_isinvasive</span>(sp, simplify <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>Checking species <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Checking species <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Checking species <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>Checking species <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>Checking species <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>Done
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                 species      status
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>     Carpobrotus edulis    Invasive
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> Rosmarinus officinalis Not <span style="color:#66d9ef">in</span> GISD
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>            Nasua nasua    Invasive
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>        Martes melampus    Invasive
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> Centaurea solstitialis    Invasive
</span></span></code></pre></div><hr>
<p>Get the .Rmd file used to create this post <a href="https://github.com/sckott/sckott.github.com/tree/master/_drafts/2012-12-13-is-invasive.Rmd">at my github account</a> - or <a href="https://github.com/sckott/sckott.github.com/tree/master/_posts/2012-12-13-is-invasive.md">.md file</a>.</p>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>One R package for all your taxonomic needs</title>
      <link>http://localhost:1313/2012/12/taxize/</link>
      <pubDate>Thu, 06 Dec 2012 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2012/12/taxize/</guid>
      <description>UPDATE: there were some errors in the tests for taxize, so the binaries aren&amp;rsquo;t avaiable yet. You can install from source though, see below.
Getting taxonomic information for the set of species you are studying can be a pain in the ass. You have to manually type, or paste in, your species one-by-one. Or, if you are lucky, there is a web service in which you can upload a list of species.</description>
      <content:encoded><![CDATA[<blockquote>
<p>UPDATE: there were some errors in the tests for <code>taxize</code>, so the binaries aren&rsquo;t avaiable yet. You can install from source though, see below.</p>
</blockquote>
<p>Getting taxonomic information for the set of species you are studying can be a pain in the ass. You have to manually type, or paste in, your species one-by-one. Or, if you are lucky, there is a web service in which you can upload a list of species. Encyclopedia of Life (EOL) has a service where you can do this <a href="http://gni.globalnames.org/parsers/new">here</a>. But is this reproducible? No.</p>
<p>Getting your taxonomic information for your species can now be done programatically in R. Do you want to get taxonomic information from ITIS. We got that. Tropicos? We got that too. uBio? No worries, we got that. What about theplantlist.org? Yep, got that. Encyclopedia of Life? Indeed. What about getting sequence data for a taxon? Oh hell yeah, you can get sequences available for a taxon across all genes, or get all records for a taxon for a specific gene.</p>
<p>Of course this is all possible because these data providers have open APIs so that we can facilitate your computer talking to their database. Fun!</p>
<p>Why get your taxonomic data programatically? Because it&rsquo;s 1) faster than by hand in web sites/looking up in books, 2) reproducible, especially if you share your code (damnit!), and 3) you can easily mash up your new taxonomic data to get sequences to build a phylogeny, etc.</p>
<p>I&rsquo;ll give a few examples of using <code>taxize</code> based around use cases, that is, stuff someone might actually do instead of what particular functions do.</p>
<hr>
<h3 id="install-packages--you-can-get-from-cran-or-github">Install packages.  You can get from CRAN or GitHub.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install.packages(&#34;ritis&#34;) # uncomment if not already installed</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;taxize_&#39;, &#39;ropensci&#39;) # uncomment if not already installed</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install.packages(&#34;taxize&#34;, type=&#34;source&#34;) # uncomment if not already installed</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ritis)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(taxize)
</span></span></code></pre></div><hr>
<h3 id="attach-family-names-to-a-list-of-species">Attach family names to a list of species.</h3>
<h4 id="i-often-have-a-list-of-species-that-i-studied-and-simply-want-to-get-their-family-names-to-for-example-make-a-table-for-the-paper-im-writing">I often have a list of species that I studied and simply want to get their family names to, for example, make a table for the paper I&rsquo;m writing.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># For one species</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">itis_name</span>(query <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Poa annua&#34;</span>, get <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;family&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Poa annua &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;Poaceae&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For many species</span>
</span></span><span style="display:flex;"><span>species <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Poa annua&#34;</span>, <span style="color:#e6db74">&#34;Abies procera&#34;</span>, <span style="color:#e6db74">&#34;Helianthus annuus&#34;</span>, <span style="color:#e6db74">&#34;Coffea arabica&#34;</span>)
</span></span><span style="display:flex;"><span>famnames <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sapply</span>(species, itis_name, get <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;family&#34;</span>, USE.NAMES <span style="color:#f92672">=</span> F)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Poa annua &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Abies procera &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Helianthus annuus &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Coffea arabica &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">data.frame</span>(species <span style="color:#f92672">=</span> species, family <span style="color:#f92672">=</span> famnames)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>            species     family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>         Poa annua    Poaceae
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>     Abies procera   Pinaceae
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> Helianthus annuus Asteraceae
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    Coffea arabica  Rubiaceae
</span></span></code></pre></div><hr>
<h3 id="resolve-taxonomic-names">Resolve taxonomic names.</h3>
<h4 id="this-is-a-common-use-case-for-ecologistsevolutionary-biologists-or-at-least-should-be-that-is-species-names-you-have-for-your-own-data-or-when-using-others-data-could-be-old-names---and-if-you-need-the-newest-names-for-your-species-list-how-can-you-make-this-as-painless-as-possible-you-can-query-taxonomic-data-from-many-different-sources-with-taxize">This is a common use case for ecologists/evolutionary biologists, or at least should be. That is, species names you have for your own data, or when using other&rsquo;s data, could be old names - and if you need the newest names for your species list, how can you make this as painless as possible? You can query taxonomic data from many different sources with <code>taxize</code>.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># The iPlantCollaborative provides access via API to their taxonomic name</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># resolution service (TNRS)</span>
</span></span><span style="display:flex;"><span>mynames <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;shorea robusta&#34;</span>, <span style="color:#e6db74">&#34;pandanus patina&#34;</span>, <span style="color:#e6db74">&#34;oryza sativa&#34;</span>, <span style="color:#e6db74">&#34;durio zibethinus&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;rubus ulmifolius&#34;</span>, <span style="color:#e6db74">&#34;asclepias curassavica&#34;</span>, <span style="color:#e6db74">&#34;pistacia lentiscus&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">iplant_tnrsmatch</span>(retrieve <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;all&#34;</span>, taxnames <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;helianthus annuus&#34;</span>, <span style="color:#e6db74">&#34;acacia&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;gossypium&#34;</span>), output <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;names&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>       AcceptedName   MatchFam MatchGenus MatchScore    Accept<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> Helianthus annuus Asteraceae Helianthus          <span style="color:#ae81ff">1</span> No opinion
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>            Acacia   Fabaceae     Acacia          <span style="color:#ae81ff">1</span> No opinion
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>                                  Acacia          <span style="color:#ae81ff">1</span> No opinion
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>         Gossypium  Malvaceae  Gossypium          <span style="color:#ae81ff">1</span> No opinion
</span></span><span style="display:flex;"><span>     SubmittedNames
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> helianthus annuus
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>            acacia
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>            acacia
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>         gossypium
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The global names resolver is another attempt at this, hitting many</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># different data sources</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">gnr_resolve</span>(names <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Helianthus annuus&#34;</span>, <span style="color:#e6db74">&#34;Homo sapiens&#34;</span>), returndf <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>   data_source_id    submitted_name       name_string score
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>               <span style="color:#ae81ff">4</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>              <span style="color:#ae81ff">10</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>              <span style="color:#ae81ff">12</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>             <span style="color:#ae81ff">110</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>            <span style="color:#ae81ff">159</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">13</span>            <span style="color:#ae81ff">166</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">15</span>            <span style="color:#ae81ff">169</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>               <span style="color:#ae81ff">4</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>              <span style="color:#ae81ff">10</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>              <span style="color:#ae81ff">12</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>             <span style="color:#ae81ff">107</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>             <span style="color:#ae81ff">122</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>            <span style="color:#ae81ff">123</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>            <span style="color:#ae81ff">159</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">14</span>            <span style="color:#ae81ff">168</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">16</span>            <span style="color:#ae81ff">169</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span>                     title
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                     NCBI
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>                 Freebase
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>                      EOL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>     Illinois Wildflowers
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>                 CU<span style="color:#f92672">*</span>STAR
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">13</span>                   nlbif
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">15</span>           uBio NameBank
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>                     NCBI
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>                 Freebase
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>                      EOL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>                AskNature
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>                 BioPedia
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>                   AnAge
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>                 CU<span style="color:#f92672">*</span>STAR
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">14</span> Index to Organism Names
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">16</span>           uBio NameBank
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># We can hit the Plantminer API too</span>
</span></span><span style="display:flex;"><span>plants <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Myrcia lingua&#34;</span>, <span style="color:#e6db74">&#34;Myrcia bella&#34;</span>, <span style="color:#e6db74">&#34;Ocotea pulchella&#34;</span>, <span style="color:#e6db74">&#34;Miconia&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Coffea arabica var. amarella&#34;</span>, <span style="color:#e6db74">&#34;Bleh&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plantminer</span>(plants)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>Myrcia lingua 
</span></span><span style="display:flex;"><span>Myrcia bella 
</span></span><span style="display:flex;"><span>Ocotea pulchella 
</span></span><span style="display:flex;"><span>Miconia 
</span></span><span style="display:flex;"><span>Coffea arabica var. amarella 
</span></span><span style="display:flex;"><span>Bleh 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>              fam   genus                    sp             author
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       Myrtaceae  Myrcia                <span style="color:#a6e22e">lingua   </span>(O. Berg) Mattos
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       Myrtaceae  Myrcia                 bella           Cambess.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>       Lauraceae  Ocotea             <span style="color:#a6e22e">pulchella </span>(Nees <span style="color:#f92672">&amp;</span> Mart.) Mez
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> Melastomataceae Miconia                    <span style="color:#66d9ef">NA</span>        Ruiz <span style="color:#f92672">&amp;</span> Pav.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       Rubiaceae  Coffea arabica var. amarella        A. Froehner
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>              <span style="color:#66d9ef">NA</span>    Bleh                    <span style="color:#66d9ef">NA</span>                 <span style="color:#66d9ef">NA</span>
</span></span><span style="display:flex;"><span>            source source.id   status confidence suggestion       database
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>              TRO <span style="color:#ae81ff">100227036</span>       <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>       Tropicos
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>             WCSP    <span style="color:#ae81ff">131057</span> Accepted          H         <span style="color:#66d9ef">NA</span> The Plant List
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> <span style="color:#a6e22e">WCSP </span>(<span style="color:#66d9ef">in</span> review)    <span style="color:#ae81ff">989758</span> Accepted          M         <span style="color:#66d9ef">NA</span> The Plant List
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>              TRO  <span style="color:#ae81ff">40018467</span>       <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>       Tropicos
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>              TRO <span style="color:#ae81ff">100170231</span>       <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>       Tropicos
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>               <span style="color:#66d9ef">NA</span>        <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>       Baea             <span style="color:#66d9ef">NA</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># We made a light wrapper around the Taxonstand package to search</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Theplantlist.org too</span>
</span></span><span style="display:flex;"><span>splist <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Heliathus annuus&#34;</span>, <span style="color:#e6db74">&#34;Abies procera&#34;</span>, <span style="color:#e6db74">&#34;Poa annua&#34;</span>, <span style="color:#e6db74">&#34;Platanus occidentalis&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Carex abrupta&#34;</span>, <span style="color:#e6db74">&#34;Arctostaphylos canescens&#34;</span>, <span style="color:#e6db74">&#34;Ocimum basilicum&#34;</span>, <span style="color:#e6db74">&#34;Vicia faba&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Quercus kelloggii&#34;</span>, <span style="color:#e6db74">&#34;Lactuca serriola&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tpl_search</span>(taxon <span style="color:#f92672">=</span> splist)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>            Genus      Species Infraspecific Plant.Name.Index
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       Heliathus       annuus                          <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>           Abies      procera                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>             Poa        annua                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>        Platanus occidentalis                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>           Carex      abrupta                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>  Arctostaphylos    canescens                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>          Ocimum    basilicum                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>           Vicia         faba                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>         Quercus    kelloggii                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>        Lactuca     serriola                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span>   Taxonomic.status      Family      New.Genus  New.Species
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                                    Heliathus       annuus
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>          Accepted    Pinaceae          Abies      procera
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>          Accepted     Poaceae            Poa        annua
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>          Accepted Platanaceae       Platanus occidentalis
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>          Accepted  Cyperaceae          Carex      abrupta
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>          Accepted   Ericaceae Arctostaphylos    canescens
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>          Accepted   Lamiaceae         Ocimum    basilicum
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>          Accepted Leguminosae          Vicia         faba
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>          Accepted    Fagaceae        Quercus    kelloggii
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>         Accepted  Compositae        Lactuca     serriola
</span></span><span style="display:flex;"><span>   New.Infraspecific Authority  Typo WFormat
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                              <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>                       Rehder <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>                           L. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>                           L. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>               <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">NA</span><span style="color:#f92672">&gt;</span>     Mack. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>                       Eastw. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>                           L. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>                           L. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>               <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">NA</span><span style="color:#f92672">&gt;</span>     Newb. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>                          L. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span></code></pre></div><hr>
<h3 id="taxonomic-hierarchies">Taxonomic hierarchies</h3>
<h4 id="i-often-want-the-full-taxonomic-hierarchy-for-a-set-of-species-that-is-give-me-the-family-order-class-etc-for-my-list-of-species-there-are-two-different-easy-ways-to-do-this-with-taxize-the-first-example-uses-eol">I often want the full taxonomic hierarchy for a set of species. That is, give me the family, order, class, etc. for my list of species. There are two different easy ways to do this with <code>taxize</code>. The first example uses EOL.</h4>
<hr>
<h4 id="using-eol">Using EOL.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>pageid <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">eol_search</span>(<span style="color:#e6db74">&#34;Quercus douglasii&#34;</span>)<span style="color:#f92672">$</span>id[1]  <span style="color:#75715e"># first need to search for the taxon&#39;s page on EOL</span>
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">eol_pages</span>(taxonconceptID <span style="color:#f92672">=</span> pageid)  <span style="color:#75715e"># then we nee to get the taxon ID used by EOL</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Notice that there are multiple different sources you can pull the</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># hierarchy from. Note even that you can get the hierarchy from the ITIS</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># service via this EOL API.</span>
</span></span><span style="display:flex;"><span>out
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  identifier                 scientificName
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   <span style="color:#ae81ff">46203061</span> Quercus douglasii Hook. <span style="color:#f92672">&amp;</span> Arn.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   <span style="color:#ae81ff">48373995</span> Quercus douglasii Hook. <span style="color:#f92672">&amp;</span> Arn.
</span></span><span style="display:flex;"><span>                                  nameAccordingTo sourceIdentfier
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>  Integrated Taxonomic Information <span style="color:#a6e22e">System </span>(ITIS)           <span style="color:#ae81ff">19322</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> Species <span style="color:#ae81ff">2000</span> <span style="color:#f92672">&amp;</span> ITIS Catalogue of Life<span style="color:#f92672">:</span> May <span style="color:#ae81ff">2012</span>         <span style="color:#ae81ff">9723391</span>
</span></span><span style="display:flex;"><span>  taxonRank
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   Species
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   Species
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Then the hierarchy!</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">eol_hierarchy</span>(out[out<span style="color:#f92672">$</span>nameAccordingTo <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Species 2000 &amp; ITIS Catalogue of Life: May 2012&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;identifier&#34;</span>])
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  sourceIdentifier  taxonID parentNameUsageID taxonConceptID
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">11017504</span> <span style="color:#ae81ff">48276627</span>                 <span style="color:#ae81ff">0</span>            <span style="color:#ae81ff">281</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">11017505</span> <span style="color:#ae81ff">48276628</span>          <span style="color:#ae81ff">48276627</span>            <span style="color:#ae81ff">282</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>         <span style="color:#ae81ff">11017506</span> <span style="color:#ae81ff">48276629</span>          <span style="color:#ae81ff">48276628</span>            <span style="color:#ae81ff">283</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>         <span style="color:#ae81ff">11022500</span> <span style="color:#ae81ff">48373354</span>          <span style="color:#ae81ff">48276629</span>           <span style="color:#ae81ff">4184</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>         <span style="color:#ae81ff">11025284</span> <span style="color:#ae81ff">48373677</span>          <span style="color:#ae81ff">48373354</span>           <span style="color:#ae81ff">4197</span>
</span></span><span style="display:flex;"><span>  scientificName taxonRank
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>        Plantae   kingdom
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>  Magnoliophyta    phylum
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>  Magnoliopsida     class
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>        Fagales     order
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       Fagaceae    family
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">eol_hierarchy</span>(out[out<span style="color:#f92672">$</span>nameAccordingTo <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Integrated Taxonomic Information System (ITIS)&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;identifier&#34;</span>])  <span style="color:#75715e"># and from ITIS, slightly different than ITIS output below, which includes taxa all the way down.</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>   sourceIdentifier  taxonID parentNameUsageID taxonConceptID
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>            <span style="color:#ae81ff">202422</span> <span style="color:#ae81ff">46150613</span>                 <span style="color:#ae81ff">0</span>            <span style="color:#ae81ff">281</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>            <span style="color:#ae81ff">846492</span> <span style="color:#ae81ff">46159776</span>          <span style="color:#ae81ff">46150613</span>        <span style="color:#ae81ff">8654492</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>            <span style="color:#ae81ff">846494</span> <span style="color:#ae81ff">46161961</span>          <span style="color:#ae81ff">46159776</span>       <span style="color:#ae81ff">28818077</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>            <span style="color:#ae81ff">846496</span> <span style="color:#ae81ff">46167532</span>          <span style="color:#ae81ff">46161961</span>           <span style="color:#ae81ff">4494</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>            <span style="color:#ae81ff">846504</span> <span style="color:#ae81ff">46169010</span>          <span style="color:#ae81ff">46167532</span>       <span style="color:#ae81ff">28825126</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>            <span style="color:#ae81ff">846505</span> <span style="color:#ae81ff">46169011</span>          <span style="color:#ae81ff">46169010</span>            <span style="color:#ae81ff">282</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>             <span style="color:#ae81ff">18063</span> <span style="color:#ae81ff">46169012</span>          <span style="color:#ae81ff">46169011</span>            <span style="color:#ae81ff">283</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>            <span style="color:#ae81ff">846548</span> <span style="color:#ae81ff">46202954</span>          <span style="color:#ae81ff">46169012</span>       <span style="color:#ae81ff">28859070</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>             <span style="color:#ae81ff">19273</span> <span style="color:#ae81ff">46202955</span>          <span style="color:#ae81ff">46202954</span>           <span style="color:#ae81ff">4184</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>            <span style="color:#ae81ff">19275</span> <span style="color:#ae81ff">46203022</span>          <span style="color:#ae81ff">46202955</span>           <span style="color:#ae81ff">4197</span>
</span></span><span style="display:flex;"><span>    scientificName     taxonRank
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>          Plantae       kingdom
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   Viridaeplantae    subkingdom
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>     Streptophyta  infrakingdom
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     Tracheophyta      division
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>  Spermatophytina   subdivision
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>     Angiospermae infradivision
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>    Magnoliopsida         class
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>          Rosanae    superorder
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>          Fagales         order
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>        Fagaceae        family
</span></span></code></pre></div><hr>
<h4 id="and-getting-a-taxonomic-hierarchy-using-itis">And getting a taxonomic hierarchy using ITIS.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># First, get the taxonomic serial number (TSN) that ITIS uses</span>
</span></span><span style="display:flex;"><span>mytsn <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_tsn</span>(<span style="color:#e6db74">&#34;Quercus douglasii&#34;</span>, <span style="color:#e6db74">&#34;sciname&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Quercus douglasii &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the full taxonomic hierarchy for a taxon from the TSN</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">itis</span>(mytsn, <span style="color:#e6db74">&#34;getfullhierarchyfromtsn&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>`1`
</span></span><span style="display:flex;"><span>        parentName parentTsn      rankName         taxonName    tsn
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                                  Kingdom           Plantae <span style="color:#ae81ff">202422</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>          Plantae    <span style="color:#ae81ff">202422</span>    Subkingdom    Viridaeplantae <span style="color:#ae81ff">846492</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>   Viridaeplantae    <span style="color:#ae81ff">846492</span>  Infrakingdom      Streptophyta <span style="color:#ae81ff">846494</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     Streptophyta    <span style="color:#ae81ff">846494</span>      Division      Tracheophyta <span style="color:#ae81ff">846496</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>     Tracheophyta    <span style="color:#ae81ff">846496</span>   Subdivision   Spermatophytina <span style="color:#ae81ff">846504</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>  Spermatophytina    <span style="color:#ae81ff">846504</span> Infradivision      Angiospermae <span style="color:#ae81ff">846505</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>     Angiospermae    <span style="color:#ae81ff">846505</span>         Class     Magnoliopsida  <span style="color:#ae81ff">18063</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>    Magnoliopsida     <span style="color:#ae81ff">18063</span>    Superorder           Rosanae <span style="color:#ae81ff">846548</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>          Rosanae    <span style="color:#ae81ff">846548</span>         Order           Fagales  <span style="color:#ae81ff">19273</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>         Fagales     <span style="color:#ae81ff">19273</span>        Family          Fagaceae  <span style="color:#ae81ff">19275</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>        Fagaceae     <span style="color:#ae81ff">19275</span>         Genus           Quercus  <span style="color:#ae81ff">19276</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>         Quercus     <span style="color:#ae81ff">19276</span>       Species Quercus douglasii  <span style="color:#ae81ff">19322</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># But this can be even easier!</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">classification</span>(<span style="color:#a6e22e">get_tsn</span>(<span style="color:#e6db74">&#34;Quercus douglasii&#34;</span>))  <span style="color:#75715e"># Boom!</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Quercus douglasii &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>`1`
</span></span><span style="display:flex;"><span>        parentName parentTsn      rankName         taxonName    tsn
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                                  Kingdom           Plantae <span style="color:#ae81ff">202422</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>          Plantae    <span style="color:#ae81ff">202422</span>    Subkingdom    Viridaeplantae <span style="color:#ae81ff">846492</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>   Viridaeplantae    <span style="color:#ae81ff">846492</span>  Infrakingdom      Streptophyta <span style="color:#ae81ff">846494</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     Streptophyta    <span style="color:#ae81ff">846494</span>      Division      Tracheophyta <span style="color:#ae81ff">846496</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>     Tracheophyta    <span style="color:#ae81ff">846496</span>   Subdivision   Spermatophytina <span style="color:#ae81ff">846504</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>  Spermatophytina    <span style="color:#ae81ff">846504</span> Infradivision      Angiospermae <span style="color:#ae81ff">846505</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>     Angiospermae    <span style="color:#ae81ff">846505</span>         Class     Magnoliopsida  <span style="color:#ae81ff">18063</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>    Magnoliopsida     <span style="color:#ae81ff">18063</span>    Superorder           Rosanae <span style="color:#ae81ff">846548</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>          Rosanae    <span style="color:#ae81ff">846548</span>         Order           Fagales  <span style="color:#ae81ff">19273</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>         Fagales     <span style="color:#ae81ff">19273</span>        Family          Fagaceae  <span style="color:#ae81ff">19275</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>        Fagaceae     <span style="color:#ae81ff">19275</span>         Genus           Quercus  <span style="color:#ae81ff">19276</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>         Quercus     <span style="color:#ae81ff">19276</span>       Species Quercus douglasii  <span style="color:#ae81ff">19322</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># You can also do this easy-peasy route to a taxonomic hierarchy using</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># uBio</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">classification</span>(<span style="color:#a6e22e">get_uid</span>(<span style="color:#e6db74">&#34;Ornithorhynchus anatinus&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>`1`
</span></span><span style="display:flex;"><span>       ScientificName         Rank    UID
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>  cellular organisms      no rank <span style="color:#ae81ff">131567</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>           Eukaryota superkingdom   <span style="color:#ae81ff">2759</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>        Opisthokonta      no rank  <span style="color:#ae81ff">33154</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>             Metazoa      kingdom  <span style="color:#ae81ff">33208</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>           Eumetazoa      no rank   <span style="color:#ae81ff">6072</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>           Bilateria      no rank  <span style="color:#ae81ff">33213</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>           Coelomata      no rank  <span style="color:#ae81ff">33316</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>       Deuterostomia      no rank  <span style="color:#ae81ff">33511</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>            Chordata       phylum   <span style="color:#ae81ff">7711</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>           Craniata    subphylum  <span style="color:#ae81ff">89593</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>         Vertebrata      no rank   <span style="color:#ae81ff">7742</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>      Gnathostomata   superclass   <span style="color:#ae81ff">7776</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">13</span>         Teleostomi      no rank <span style="color:#ae81ff">117570</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">14</span>       Euteleostomi      no rank <span style="color:#ae81ff">117571</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">15</span>      Sarcopterygii      no rank   <span style="color:#ae81ff">8287</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">16</span>          Tetrapoda      no rank  <span style="color:#ae81ff">32523</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">17</span>            Amniota      no rank  <span style="color:#ae81ff">32524</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">18</span>           Mammalia        class  <span style="color:#ae81ff">40674</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">19</span>        Prototheria      no rank   <span style="color:#ae81ff">9254</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">20</span>        Monotremata        order   <span style="color:#ae81ff">9255</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">21</span>  Ornithorhynchidae       family   <span style="color:#ae81ff">9256</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">22</span>    Ornithorhynchus        genus   <span style="color:#ae81ff">9257</span>
</span></span></code></pre></div><hr>
<h3 id="sequences">Sequences?</h3>
<h4 id="while-you-are-at-doing-taxonomic-stuff-you-often-wonder-hmmm-i-wonder-if-there-are-any-sequence-data-available-for-my-species-so-you-can-use-get_seqs-to-search-for-specific-genes-for-a-species-and-get_genes_avail-to-find-out-what-genes-are-available-for-a-certain-species-these-functions-search-for-data-on-ncbihttpwwwncbinlmnihgov">While you are at doing taxonomic stuff, you often wonder &ldquo;hmmm, I wonder if there are any sequence data available for my species?&rdquo; So, you can use <code>get_seqs</code> to search for specific genes for a species, and <code>get_genes_avail</code> to find out what genes are available for a certain species. These functions search for data on <a href="http://www.ncbi.nlm.nih.gov/">NCBI</a>.</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Get sequences (sequence is provied in output, but hiding here for</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># brevity). What&#39;s nice about this is that it gets the longest sequence</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># avaialable for the gene you searched for, and if there isn&#39;t anything</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># available, it lets you get a sequence from a congener if you set</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># getrelated=TRUE. The last column in the output data.frame also tells you</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># what species the sequence is from.</span>
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_seqs</span>(taxon_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Acipenser brevirostrum&#34;</span>, gene <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;5S rRNA&#34;</span>), 
</span></span><span style="display:flex;"><span>    seqrange <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1:3000&#34;</span>, getrelated <span style="color:#f92672">=</span> T, writetodf <span style="color:#f92672">=</span> F)
</span></span><span style="display:flex;"><span>out[, <span style="color:#f92672">!</span><span style="color:#a6e22e">names</span>(out) <span style="color:#f92672">%in%</span> <span style="color:#e6db74">&#34;sequence&#34;</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>                   taxon                                         gene_desc
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> Acipenser brevirostrum Acipenser brevirostrum <span style="color:#ae81ff">5</span>S rRNA gene, clone BRE92A
</span></span><span style="display:flex;"><span>     gi_no     acc_no length                 spused
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">60417159</span> AJ745069.1    <span style="color:#ae81ff">121</span> Acipenser brevirostrum
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Search for available sequences</span>
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_genes_avail</span>(taxon_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Umbra limi&#34;</span>, seqrange <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1:2000&#34;</span>, getrelated <span style="color:#f92672">=</span> F)
</span></span><span style="display:flex;"><span>out<span style="color:#a6e22e">[grep</span>(<span style="color:#e6db74">&#34;RAG1&#34;</span>, out<span style="color:#f92672">$</span>genesavail, ignore.case <span style="color:#f92672">=</span> T), ]  <span style="color:#75715e"># does the string &#39;RAG1&#39; exist in any of the gene names</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>        spused length
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">414</span> Umbra limi    <span style="color:#ae81ff">732</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">427</span> Umbra limi    <span style="color:#ae81ff">959</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">434</span> Umbra limi   <span style="color:#ae81ff">1631</span>
</span></span><span style="display:flex;"><span>                                                                            genesavail
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">414</span> isolate UlimA recombinase activating protein <span style="color:#ae81ff">1</span> (rag1) gene, exon <span style="color:#ae81ff">3</span> and partial cds
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">427</span>           recombination<span style="color:#f92672">-</span>activating protein <span style="color:#ae81ff">1</span> (RAG1) gene, intron <span style="color:#ae81ff">2</span> and partial cds
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">434</span>                        recombination<span style="color:#f92672">-</span>activating protein <span style="color:#ae81ff">1</span> (RAG1) gene, partial cds
</span></span><span style="display:flex;"><span>    predicted
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">414</span>  JX190826
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">427</span>  AY459526
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">434</span>  AY380548
</span></span></code></pre></div><hr>
<p>Get the .Rmd file used to create this post <a href="https://github.com/sckott/sckott.github.com/tree/master/_drafts/2012-12-06-taxize.Rmd">at my github account</a> - or <a href="https://github.com/sckott/sckott.github.com/tree/master/_posts/2012-12-06-taxize.md">.md file</a>.</p>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Getting taxonomic names downstream</title>
      <link>http://localhost:1313/2012/10/get-taxa-downstream/</link>
      <pubDate>Tue, 16 Oct 2012 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2012/10/get-taxa-downstream/</guid>
      <description>It can be a pain in the ass to get taxonomic names. For example, I sometimes need to get all the Class names for a set of species. This is a relatively easy problem using the ITIS API (example below).
The much harder problem is getting all the taxonomic names downstream. ITIS doesn&amp;rsquo;t provide an API method for this - well, they do (getHirerachyDownFromTSN), but it only provides direct children (e.</description>
      <content:encoded><![CDATA[<p>It can be a pain in the ass to get taxonomic names. For example, I sometimes need to get all the Class names for a set of species.  This is a relatively easy problem using the <a href="http://www.itis.gov/ws_description.html">ITIS API</a> (example below).</p>
<p>The much harder problem is getting all the taxonomic names downstream. ITIS doesn&rsquo;t provide an API method for this - well, they do (<a href="http://www.itis.gov/ws_hierApiDescription.html#getHierarchyDn"><code>getHirerachyDownFromTSN</code></a>), but it only provides direct children (e.g., the genera within a tribe - but it won&rsquo;t give all the species within each genus).</p>
<p>So in the <code>taxize</code> package, we wrote a function called <code>downstream</code>, which allows you to get taxonomic names to any downstream point, e.g.:</p>
<ul>
<li>get all Classes within Animalia,</li>
<li>get all Species within a Family</li>
<li>etc.</li>
</ul>
<h3 id="install-packages--you-can-get-other-packages-from-cran-but-taxize-is-only-on-github-for-now">Install packages.  You can get other packages from CRAN, but taxize is only on GitHub for now.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;ritis&#39;, &#39;ropensci&#39;) # uncomment if not already installed</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;taxize&#39;, &#39;ropensci&#39;) # uncomment if not already</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ritis)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(taxize)
</span></span></code></pre></div><h3 id="get-upstream-taxonomic-names">Get upstream taxonomic names.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Search for a TSN by scientific name</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">searchbyscientificname</span>(<span style="color:#e6db74">&#34;Tardigrada&#34;</span>)
</span></span><span style="display:flex;"><span>tsn <span style="color:#f92672">&lt;-</span> df[df<span style="color:#f92672">$</span>combinedname <span style="color:#f92672">%in%</span> <span style="color:#e6db74">&#34;Tardigrada&#34;</span>, <span style="color:#e6db74">&#34;tsn&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get just one immediate higher taxonomic name</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">gethierarchyupfromtsn</span>(tsn <span style="color:#f92672">=</span> tsn)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  parentName parentTsn rankName  taxonName    tsn
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   Animalia    <span style="color:#ae81ff">202423</span>   Phylum Tardigrada <span style="color:#ae81ff">155166</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get full hierarchy upstream from TSN</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">getfullhierarchyfromtsn</span>(tsn <span style="color:#f92672">=</span> tsn)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  parentName parentTsn rankName        taxonName    tsn
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                       Kingdom         Animalia <span style="color:#ae81ff">202423</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   Animalia    <span style="color:#ae81ff">202423</span>   Phylum       Tardigrada <span style="color:#ae81ff">155166</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> Tardigrada    <span style="color:#ae81ff">155166</span>    Class     Eutardigrada <span style="color:#ae81ff">155362</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> Tardigrada    <span style="color:#ae81ff">155166</span>    Class Heterotardigrada <span style="color:#ae81ff">155167</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> Tardigrada    <span style="color:#ae81ff">155166</span>    Class   Mesotardigrada <span style="color:#ae81ff">155358</span>
</span></span></code></pre></div><h3 id="get-taxonomc-names-downstream">Get taxonomc names downstream.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Get genera downstream fromthe Class Bangiophyceae</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">downstream</span>(<span style="color:#ae81ff">846509</span>, <span style="color:#e6db74">&#34;Genus&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>    tsn parentName parentTsn   taxonName rankId rankName
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">11531</span> Bangiaceae     <span style="color:#ae81ff">11530</span>      Bangia    <span style="color:#ae81ff">180</span>    Genus
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> <span style="color:#ae81ff">11540</span> Bangiaceae     <span style="color:#ae81ff">11530</span>    Porphyra    <span style="color:#ae81ff">180</span>    Genus
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> <span style="color:#ae81ff">11577</span> Bangiaceae     <span style="color:#ae81ff">11530</span> Porphyrella    <span style="color:#ae81ff">180</span>    Genus
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> <span style="color:#ae81ff">11580</span> Bangiaceae     <span style="color:#ae81ff">11530</span> Conchocelis    <span style="color:#ae81ff">180</span>    Genus
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Get families downstream from Acridoidea</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">downstream</span>(<span style="color:#ae81ff">650497</span>, <span style="color:#e6db74">&#34;Family&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>      tsn parentName parentTsn      taxonName rankId rankName
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">102195</span> Acridoidea    <span style="color:#ae81ff">650497</span>      Acrididae    <span style="color:#ae81ff">140</span>   Family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">650502</span> Acridoidea    <span style="color:#ae81ff">650497</span>     Romaleidae    <span style="color:#ae81ff">140</span>   Family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">657472</span> Acridoidea    <span style="color:#ae81ff">650497</span>    Charilaidae    <span style="color:#ae81ff">140</span>   Family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">657473</span> Acridoidea    <span style="color:#ae81ff">650497</span>   Lathiceridae    <span style="color:#ae81ff">140</span>   Family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">657474</span> Acridoidea    <span style="color:#ae81ff">650497</span>     Lentulidae    <span style="color:#ae81ff">140</span>   Family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">657475</span> Acridoidea    <span style="color:#ae81ff">650497</span>    Lithidiidae    <span style="color:#ae81ff">140</span>   Family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>  <span style="color:#ae81ff">657476</span> Acridoidea    <span style="color:#ae81ff">650497</span>   Ommexechidae    <span style="color:#ae81ff">140</span>   Family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>  <span style="color:#ae81ff">657477</span> Acridoidea    <span style="color:#ae81ff">650497</span>    Pamphagidae    <span style="color:#ae81ff">140</span>   Family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>  <span style="color:#ae81ff">657478</span> Acridoidea    <span style="color:#ae81ff">650497</span>  Pyrgacrididae    <span style="color:#ae81ff">140</span>   Family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">657479</span> Acridoidea    <span style="color:#ae81ff">650497</span>    Tristiridae    <span style="color:#ae81ff">140</span>   Family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span> <span style="color:#ae81ff">657492</span> Acridoidea    <span style="color:#ae81ff">650497</span> Dericorythidae    <span style="color:#ae81ff">140</span>   Family
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get species downstream from Ursus</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">downstream</span>(<span style="color:#ae81ff">180541</span>, <span style="color:#e6db74">&#34;Species&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>     tsn parentName parentTsn        taxonName rankId rankName
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">180542</span>      Ursus    <span style="color:#ae81ff">180541</span>  Ursus maritimus    <span style="color:#ae81ff">220</span>  Species
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> <span style="color:#ae81ff">180543</span>      Ursus    <span style="color:#ae81ff">180541</span>     Ursus arctos    <span style="color:#ae81ff">220</span>  Species
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> <span style="color:#ae81ff">180544</span>      Ursus    <span style="color:#ae81ff">180541</span> Ursus americanus    <span style="color:#ae81ff">220</span>  Species
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> <span style="color:#ae81ff">621850</span>      Ursus    <span style="color:#ae81ff">180541</span> Ursus thibetanus    <span style="color:#ae81ff">220</span>  Species
</span></span></code></pre></div><hr>
<p>Get the .Rmd file used to create this post <a href="https://github.com/sckott/sckott.github.com/tree/master/_drafts/2012-10-16-get-taxa-downstream.Rmd">at my github account</a> - or <a href="https://github.com/sckott/sckott.github.com/tree/master/_posts/2012-10-16-get-taxa-downstream.md">.md file</a>.</p>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Hitting the Global Names Resolver API</title>
      <link>http://localhost:1313/2012/07/global-names-resolver/</link>
      <pubDate>Fri, 20 Jul 2012 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2012/07/global-names-resolver/</guid>
      <description>Example of using the Global Names Resolver API to check species names There are a number of options for resolution of taxonomic names. The Taxonomic Name Resolution Service (TNRS) comes to mind. There is a new service for taxonomic name resoultion called the Global Names Resolver. They describe the service thusly &amp;ldquo;Resolve lists of scientific names against known sources. This service parses incoming names, executes exact or fuzzy matching as required, and displays a confidence score for each match along with its identifier.</description>
      <content:encoded><![CDATA[<h2 id="example-of-using-the-global-names-resolver-api-to-check-species-names">Example of using the Global Names Resolver API to check species names</h2>
<p>There are a number of options for resolution of taxonomic names. The <a href="http://tnrs.iplantcollaborative.org/">Taxonomic Name Resolution Service (TNRS)</a> comes to mind. There is a new service for taxonomic name resoultion called the <a href="http://resolver.globalnames.org/">Global Names Resolver</a>. They describe the service thusly &ldquo;<em>Resolve lists of scientific names against known sources. This service parses incoming names, executes exact or fuzzy matching as required, and displays a confidence score for each match along with its identifier.</em>&rdquo;.</p>
<h2 id="load-required-packages">Load required packages</h2>
<h3 id="just-uncomment-the-code-to-use">Just uncomment the code to use.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># If you don&#39;t have them already</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install.packages(c(&#39;RJSONIO&#39;,&#39;plyr&#39;,&#39;devtools&#39;)) require(devtools)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;taxize_&#39;,&#39;ropensci&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(RJSONIO)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(plyr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(taxize)
</span></span></code></pre></div><h2 id="get-the-data-sources-available">Get the data sources available</h2>
<h3 id="get-just-ids-and-names-of-sources-in-a-dataframe">Get just id&rsquo;s and names of sources in a data.frame</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">tail</span>(<span style="color:#a6e22e">gnr_datasources</span>(todf <span style="color:#f92672">=</span> T))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">##     id                                title</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 82 164                            BioLib.cz</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 83 165 Tropicos - Missouri Botanical Garden</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 84 166                                nlbif</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 85 167                                 IPNI</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 86 168              Index to Organism Names</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 87 169                        uBio NameBank</span>
</span></span></code></pre></div><hr>
<h3 id="give-me-the-id-for-eol-encyclopedia-of-life">Give me the id for EOL (Encyclopedia of Life)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">gnr_datasources</span>(todf <span style="color:#f92672">=</span> T)
</span></span><span style="display:flex;"><span>out[out<span style="color:#f92672">$</span>title <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;EOL&#34;</span>, <span style="color:#e6db74">&#34;id&#34;</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">## [1] 12</span>
</span></span></code></pre></div><hr>
<h3 id="fuzzy-search-for-sources-with-the-word-zoo">Fuzzy search for sources with the word &ldquo;zoo&rdquo;</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">gnr_datasources</span>(todf <span style="color:#f92672">=</span> T)
</span></span><span style="display:flex;"><span>outdf <span style="color:#f92672">&lt;-</span> out<span style="color:#a6e22e">[agrep</span>(<span style="color:#e6db74">&#34;zoo&#34;</span>, out<span style="color:#f92672">$</span>title, ignore.case <span style="color:#f92672">=</span> T), ]
</span></span><span style="display:flex;"><span>outdf[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>, ]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">##     id             title</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 20 100 Mushroom Observer</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 25 105           ZooKeys</span>
</span></span></code></pre></div><h2 id="resolve-some-names">Resolve some names</h2>
<h3 id="search-for-_helianthus-annuus_-and-_homo-sapiens_-return-a-dataframe">Search for <em>Helianthus annuus</em> and <em>Homo sapiens</em>, return a data.frame</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gnr</span>(names <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Helianthus annuus&#34;</span>, <span style="color:#e6db74">&#34;Homo sapiens&#34;</span>), returndf <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>, ]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">##   data_source_id    submitted_name       name_string score    title</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 1              4 Helianthus annuus Helianthus annuus 0.988     NCBI</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 3             10 Helianthus annuus Helianthus annuus 0.988 Freebase</span>
</span></span></code></pre></div><hr>
<h3 id="search-for-the-same-species-with-only-using-data-source-12-ie-eol">Search for the same species, with only using data source 12 (i.e., EOL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gnr</span>(names <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Helianthus annuus&#34;</span>, <span style="color:#e6db74">&#34;Homo sapiens&#34;</span>), data_source_ids <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;12&#34;</span>, 
</span></span><span style="display:flex;"><span>    returndf <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">##   data_source_id    submitted_name       name_string score title</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 1             12 Helianthus annuus Helianthus annuus 0.988   EOL</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 2             12      Homo sapiens      Homo sapiens 0.988   EOL</span>
</span></span></code></pre></div><h3 id="thats-it-have-fun-and-put-bugscommentsetc-herehttpsgithubcomropenscitaxize_issues">That&rsquo;s it. Have fun! And put bugs/comments/etc. <a href="https://github.com/ropensci/taxize_/issues">here</a>.</h3>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>, and nice knitr highlighting/etc. in in <a href="http://rstudio.org/">RStudio</a>.</p>
<h3 id="i-prepared-the-markdown-for-this-post-by">I prepared the markdown for this post by:</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>KnitPost <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(input, base.url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">require</span>(knitr)
</span></span><span style="display:flex;"><span>    opts_knit<span style="color:#f92672">$</span><span style="color:#a6e22e">set</span>(base.url <span style="color:#f92672">=</span> base.url)
</span></span><span style="display:flex;"><span>    fig.path <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;img/&#34;</span>, <span style="color:#a6e22e">sub</span>(<span style="color:#e6db74">&#34;.Rmd$&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">basename</span>(input)), <span style="color:#e6db74">&#34;/&#34;</span>)
</span></span><span style="display:flex;"><span>    opts_chunk<span style="color:#f92672">$</span><span style="color:#a6e22e">set</span>(fig.path <span style="color:#f92672">=</span> fig.path)
</span></span><span style="display:flex;"><span>    opts_chunk<span style="color:#f92672">$</span><span style="color:#a6e22e">set</span>(fig.cap <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;center&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">render_jekyll</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">knit</span>(input, envir <span style="color:#f92672">=</span> <span style="color:#a6e22e">parent.frame</span>())
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">setwd</span>(<span style="color:#e6db74">&#34;/path/to/_posts&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">KnitPost</span>(<span style="color:#e6db74">&#34;/path/to/postfile.Rmd&#34;</span>)
</span></span></code></pre></div><p>from <a href="http://jfisher-usgs.github.com/r/2012/07/03/knitr-jekyll/">jfisher</a>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>searching ITIS and fetching Phylomatic trees</title>
      <link>http://localhost:1313/2011/06/searching-itis-and-fetching-phylomatic-trees/</link>
      <pubDate>Fri, 03 Jun 2011 17:35:00 -0500</pubDate>
      <guid>http://localhost:1313/2011/06/searching-itis-and-fetching-phylomatic-trees/</guid>
      <description>I am writing a set of functions to search ITIS for taxonomic information (more databases to come) and functions to fetch plant phylogenetic trees from Phylomatic. Code at github.
Also, see the examples in the demos folder on the Github site above.</description>
      <content:encoded><![CDATA[<p>I am writing a set of functions to search ITIS for taxonomic information (more databases to come) and functions to fetch plant phylogenetic trees from Phylomatic. <a href="https://github.com/sckott/taxize_">Code at github</a>.</p>
<p>Also, see the examples in the demos folder on the Github site above.</p>
<p><a href="http://1.bp.blogspot.com/-rcw5OIf3Hak/Telhj896L0I/AAAAAAAAEh4/p6GhpNRW6IA/s1600/examplephylogenyplot.png"><img loading="lazy" src="http://1.bp.blogspot.com/-rcw5OIf3Hak/Telhj896L0I/AAAAAAAAEh4/p6GhpNRW6IA/s400/examplephylogenyplot.png" alt=""  />
</a></p>
]]></content:encoded>
    </item>
  </channel>
</rss>
