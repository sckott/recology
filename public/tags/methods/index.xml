<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Methods on Recology</title>
    <link>http://localhost:1313/tags/methods/</link>
    <description>Recent content in Methods on Recology</description>
    <generator>Hugo -- 0.140.2</generator>
    <language>en-us</language>
    <lastBuildDate>Fri, 09 Sep 2011 13:03:00 -0500</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/methods/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>My take on an R introduction talk</title>
      <link>http://localhost:1313/2011/09/my-take-on-r-introduction-talk/</link>
      <pubDate>Fri, 09 Sep 2011 13:03:00 -0500</pubDate>
      <guid>http://localhost:1313/2011/09/my-take-on-r-introduction-talk/</guid>
      <description>&lt;p&gt;UPDATE: I put in an R tutorial as a Github gist below.&lt;/p&gt;
&lt;p&gt;Here is a short intro R talk I gave today&amp;hellip;for what it&amp;rsquo;s worth&amp;hellip;&lt;/p&gt;

&lt;div id=&#34;__ss_9195930&#34; style=&#34;width: 425px;&#34;&gt;&lt;strong style=&#34;display: block; margin: 12px 0 4px;&#34;&gt;&lt;a href=&#34;http://www.slideshare.net/schamber/r-introduction&#34; target=&#34;_blank&#34; title=&#34;R Introduction&#34;&gt;R Introduction&lt;/a&gt;&lt;/strong&gt; &lt;iframe frameborder=&#34;0&#34; height=&#34;355&#34; marginheight=&#34;0&#34; marginwidth=&#34;0&#34; scrolling=&#34;no&#34; src=&#34;http://www.slideshare.net/slideshow/embed_code/9195930&#34; width=&#34;425&#34;&gt;

&lt;/iframe&gt; &lt;br /&gt;&lt;div style=&#34;padding: 5px 0 12px;&#34;&gt;View more &lt;a href=&#34;http://www.slideshare.net/&#34; target=&#34;_blank&#34;&gt;presentations&lt;/a&gt; from &lt;a href=&#34;http://www.slideshare.net/schamber&#34; target=&#34;_blank&#34;&gt;schamber&lt;/a&gt; &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here&amp;rsquo;s the tutorial in a GitHub gist: &lt;a href=&#34;https://gist.github.com/1208321&#34;&gt;https://gist.github.com/1208321&lt;/a&gt;&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>UPDATE: I put in an R tutorial as a Github gist below.</p>
<p>Here is a short intro R talk I gave today&hellip;for what it&rsquo;s worth&hellip;</p>

<div id="__ss_9195930" style="width: 425px;"><strong style="display: block; margin: 12px 0 4px;"><a href="http://www.slideshare.net/schamber/r-introduction" target="_blank" title="R Introduction">R Introduction</a></strong> <iframe frameborder="0" height="355" marginheight="0" marginwidth="0" scrolling="no" src="http://www.slideshare.net/slideshow/embed_code/9195930" width="425">

</iframe> <br /><div style="padding: 5px 0 12px;">View more <a href="http://www.slideshare.net/" target="_blank">presentations</a> from <a href="http://www.slideshare.net/schamber" target="_blank">schamber</a> <br /><br /><br /><br /></div></div>

<p>Here&rsquo;s the tutorial in a GitHub gist: <a href="https://gist.github.com/1208321">https://gist.github.com/1208321</a></p>
]]></content:encoded>
    </item>
    <item>
      <title>iEvoBio 2011 Synopsis</title>
      <link>http://localhost:1313/2011/06/ievobio-2011-synopsis/</link>
      <pubDate>Wed, 22 Jun 2011 21:38:00 -0500</pubDate>
      <guid>http://localhost:1313/2011/06/ievobio-2011-synopsis/</guid>
      <description>&lt;p&gt;We just wrapped up the &lt;!-- raw HTML omitted --&gt;2011 iEvoBio meeting&lt;!-- raw HTML omitted --&gt;. It was awesome! If you didn&amp;rsquo;t go this year or last year, definitely think about going next year.&lt;/p&gt;
&lt;p&gt;Here is a list of the cool projects that were discussed at the meeting (apologies if I left some out):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;Vistrails&lt;!-- raw HTML omitted --&gt;: workflow tool, awesome project by Claudio Silva&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;Commplish&lt;!-- raw HTML omitted --&gt;: purpose is to use via API&amp;rsquo;s, not with the web UI&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;Phylopic&lt;!-- raw HTML omitted --&gt;: a database of life-form silouhettes, including an API for remote access, sweet!&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;Gloome&lt;!-- raw HTML omitted --&gt;&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;MappingLife&lt;!-- raw HTML omitted --&gt;: awesome geographic/etc data visualization interace on the web&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;SuiteSMA&lt;!-- raw HTML omitted --&gt;: visualizating multiple alignments&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;treeBASE&lt;!-- raw HTML omitted --&gt;: R interface to treebase, by &lt;!-- raw HTML omitted --&gt;Carl Boettiger&lt;!-- raw HTML omitted --&gt;&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;VertNet&lt;!-- raw HTML omitted --&gt;: database for vertebrate natural history collections&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;RevBayes&lt;!-- raw HTML omitted --&gt;: revamp of MrBayes, with GUI, etc. &lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;Phenoscape Knowledge Base&lt;!-- raw HTML omitted --&gt;&lt;/li&gt;
&lt;li&gt;Peter Midford lightning talk: talked about matching taxonomic and genetic data&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;BiSciCol&lt;!-- raw HTML omitted --&gt;: biological science collections tracker&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;Ontogrator&lt;!-- raw HTML omitted --&gt; &lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;TNRS&lt;!-- raw HTML omitted --&gt;: taxonomic name resolution service&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;Barcode of Life data systems&lt;!-- raw HTML omitted --&gt;, and &lt;!-- raw HTML omitted --&gt;remote access&lt;!-- raw HTML omitted --&gt;&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;Moorea Biocode Project&lt;!-- raw HTML omitted --&gt;&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;Microbial LTER&amp;rsquo;s data&lt;!-- raw HTML omitted --&gt;&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;BirdVis&lt;!-- raw HTML omitted --&gt;: interactive bird data visualization (Claudio Silva in collaboration with Cornell Lab of Ornithology)&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;Crowdlabs&lt;!-- raw HTML omitted --&gt;: I think the site is down right now, another project by Claudio Silva&lt;/li&gt;
&lt;li&gt;&lt;!-- raw HTML omitted --&gt;Phycas&lt;!-- raw HTML omitted --&gt;: Bayesian phylogenetics, can you just call this from R?&lt;/li&gt;
&lt;li&gt;RIP MrBayes!!!! replaced by RevBayes (see 9 above)&lt;/li&gt;
&lt;li&gt;Slides of presentations will be at &lt;!-- raw HTML omitted --&gt;Slideshare&lt;!-- raw HTML omitted --&gt; (not all presentations up yet)          &lt;/li&gt;
&lt;li&gt;A birds of a feather group I was involved in proposed an idea (TOL-o-matic) like Phylomatic, but of broader scope, for easy access and submission of trees, and perhaps even social (think just pushing a &amp;lsquo;SHARE&amp;rsquo; button within PAUP, RevBayes, or other phylogenetics software)! &lt;/li&gt;
&lt;li&gt;Synopses of Birds of a Feather discussion groups: &lt;!-- raw HTML omitted --&gt;&lt;a href=&#34;http://piratepad.net/iEvoBio11-BoF-reportouts&#34;&gt;http://piratepad.net/iEvoBio11-BoF-reportouts&lt;/a&gt;&lt;!-- raw HTML omitted --&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
      <content:encoded><![CDATA[<p>We just wrapped up the <!-- raw HTML omitted -->2011 iEvoBio meeting<!-- raw HTML omitted -->. It was awesome! If you didn&rsquo;t go this year or last year, definitely think about going next year.</p>
<p>Here is a list of the cool projects that were discussed at the meeting (apologies if I left some out):</p>
<ul>
<li><!-- raw HTML omitted -->Vistrails<!-- raw HTML omitted -->: workflow tool, awesome project by Claudio Silva</li>
<li><!-- raw HTML omitted -->Commplish<!-- raw HTML omitted -->: purpose is to use via API&rsquo;s, not with the web UI</li>
<li><!-- raw HTML omitted -->Phylopic<!-- raw HTML omitted -->: a database of life-form silouhettes, including an API for remote access, sweet!</li>
<li><!-- raw HTML omitted -->Gloome<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->MappingLife<!-- raw HTML omitted -->: awesome geographic/etc data visualization interace on the web</li>
<li><!-- raw HTML omitted -->SuiteSMA<!-- raw HTML omitted -->: visualizating multiple alignments</li>
<li><!-- raw HTML omitted -->treeBASE<!-- raw HTML omitted -->: R interface to treebase, by <!-- raw HTML omitted -->Carl Boettiger<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->VertNet<!-- raw HTML omitted -->: database for vertebrate natural history collections</li>
<li><!-- raw HTML omitted -->RevBayes<!-- raw HTML omitted -->: revamp of MrBayes, with GUI, etc. </li>
<li><!-- raw HTML omitted -->Phenoscape Knowledge Base<!-- raw HTML omitted --></li>
<li>Peter Midford lightning talk: talked about matching taxonomic and genetic data</li>
<li><!-- raw HTML omitted -->BiSciCol<!-- raw HTML omitted -->: biological science collections tracker</li>
<li><!-- raw HTML omitted -->Ontogrator<!-- raw HTML omitted --> </li>
<li><!-- raw HTML omitted -->TNRS<!-- raw HTML omitted -->: taxonomic name resolution service</li>
<li><!-- raw HTML omitted -->Barcode of Life data systems<!-- raw HTML omitted -->, and <!-- raw HTML omitted -->remote access<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->Moorea Biocode Project<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->Microbial LTER&rsquo;s data<!-- raw HTML omitted --></li>
<li><!-- raw HTML omitted -->BirdVis<!-- raw HTML omitted -->: interactive bird data visualization (Claudio Silva in collaboration with Cornell Lab of Ornithology)</li>
<li><!-- raw HTML omitted -->Crowdlabs<!-- raw HTML omitted -->: I think the site is down right now, another project by Claudio Silva</li>
<li><!-- raw HTML omitted -->Phycas<!-- raw HTML omitted -->: Bayesian phylogenetics, can you just call this from R?</li>
<li>RIP MrBayes!!!! replaced by RevBayes (see 9 above)</li>
<li>Slides of presentations will be at <!-- raw HTML omitted -->Slideshare<!-- raw HTML omitted --> (not all presentations up yet)          </li>
<li>A birds of a feather group I was involved in proposed an idea (TOL-o-matic) like Phylomatic, but of broader scope, for easy access and submission of trees, and perhaps even social (think just pushing a &lsquo;SHARE&rsquo; button within PAUP, RevBayes, or other phylogenetics software)! </li>
<li>Synopses of Birds of a Feather discussion groups: <!-- raw HTML omitted --><a href="http://piratepad.net/iEvoBio11-BoF-reportouts">http://piratepad.net/iEvoBio11-BoF-reportouts</a><!-- raw HTML omitted --></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>How to fit power laws</title>
      <link>http://localhost:1313/2011/06/how-to-fit-power-laws/</link>
      <pubDate>Tue, 07 Jun 2011 15:24:00 -0500</pubDate>
      <guid>http://localhost:1313/2011/06/how-to-fit-power-laws/</guid>
      <description>&lt;p&gt;A new paper out in Ecology by Xiao and colleagues (in press, &lt;a href=&#34;http://www.esajournals.org/doi/abs/10.1890/11-0538.1&#34;&gt;here&lt;/a&gt;) compares the use of log-transformation to non-linear regression for analyzing power-laws.&lt;/p&gt;
&lt;p&gt;They suggest that the error distribution should determine which method performs better. When your errors are additive, homoscedastic, and normally distributed, they propose using non-linear regression. When errors are multiplicative, heteroscedastic, and lognormally distributed, they suggest using linear regression on log-transformed data. The assumptions about these two methods are different, so cannot be correct for a single dataset.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>A new paper out in Ecology by Xiao and colleagues (in press, <a href="http://www.esajournals.org/doi/abs/10.1890/11-0538.1">here</a>) compares the use of log-transformation to non-linear regression for analyzing power-laws.</p>
<p>They suggest that the error distribution should determine which method performs better. When your errors are additive, homoscedastic, and normally distributed, they propose using non-linear regression. When errors are multiplicative, heteroscedastic, and lognormally distributed, they suggest using linear regression on log-transformed data. The assumptions about these two methods are different, so cannot be correct for a single dataset.</p>
<p>They will provide their R code for their methods once they are up on Ecological Archives (they weren&rsquo;t up there by the time of this post).</p>
]]></content:encoded>
    </item>
    <item>
      <title>RHIPE package in R for interfacing between Hadoop and R</title>
      <link>http://localhost:1313/2011/05/rhipe-package-in-r-for-interfacing-between-hadoop-and-r/</link>
      <pubDate>Wed, 04 May 2011 19:11:00 -0500</pubDate>
      <guid>http://localhost:1313/2011/05/rhipe-package-in-r-for-interfacing-between-hadoop-and-r/</guid>
      <description>&lt;p&gt;&lt;strong&gt;&lt;a href=&#34;http://www.lecturemaker.com/2011/02/rhipe/#video&#34; title=&#34;Click link to go to the video page&#34;&gt;RHIPE: An Interface Between Hadoop and R&lt;/a&gt;&lt;/strong&gt;&lt;br&gt;
Presented by Saptarshi Guha&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.lecturemaker.com/2011/02/rhipe/#video&#34;&gt;&lt;img alt=&#34;Video Link&#34; loading=&#34;lazy&#34; src=&#34;http://www.lecturemaker.com/lectures/RMeetUp2010/RHIPE_Lecture.jpg&#34; title=&#34;Click image to go to the video page&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;And &lt;a href=&#34;http://blog.piccolboni.info/2011/04/looking-for-map-reduce-language.html&#34;&gt;this review&lt;/a&gt; of methods for interfacing with Hadoop suggests R&amp;rsquo;s RHIPE is quite nice.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p><strong><a href="http://www.lecturemaker.com/2011/02/rhipe/#video" title="Click link to go to the video page">RHIPE: An Interface Between Hadoop and R</a></strong><br>
Presented by Saptarshi Guha</p>
<p><a href="http://www.lecturemaker.com/2011/02/rhipe/#video"><img alt="Video Link" loading="lazy" src="http://www.lecturemaker.com/lectures/RMeetUp2010/RHIPE_Lecture.jpg" title="Click image to go to the video page"></a></p>
<p>And <a href="http://blog.piccolboni.info/2011/04/looking-for-map-reduce-language.html">this review</a> of methods for interfacing with Hadoop suggests R&rsquo;s RHIPE is quite nice.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Phylometa from R: Randomization via Tip Shuffle</title>
      <link>http://localhost:1313/2011/04/phylometa-from-r-randomization-via-tip-shuffle/</link>
      <pubDate>Sat, 16 Apr 2011 13:44:00 -0500</pubDate>
      <guid>http://localhost:1313/2011/04/phylometa-from-r-randomization-via-tip-shuffle/</guid>
      <description>&lt;p&gt;&amp;mdash;UPDATE: I am now using code formatting from gist.github, so I replaced the old prettyR code (sorry guys). The github way is much easier and prettier. I hope readers like the change.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://localhost:1313/posts/2011-04-01-phylometa-from-r-udpate/&#34;&gt;I wrote earlier&lt;/a&gt; about some code I wrote for running Phylometa (software to do phylogenetic meta-analysis) from R.&lt;/p&gt;
&lt;p&gt;I have been concerned about what exactly is the right penalty for including phylogeny in a meta-analysis. E.g.: AIC is calculated from Q in Phylometa, and Q increases with tree size.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>&mdash;UPDATE: I am now using code formatting from gist.github, so I replaced the old prettyR code (sorry guys). The github way is much easier and prettier. I hope readers like the change.</p>
<p><a href="/posts/2011-04-01-phylometa-from-r-udpate/">I wrote earlier</a> about some code I wrote for running Phylometa (software to do phylogenetic meta-analysis) from R.</p>
<p>I have been concerned about what exactly is the right penalty for including phylogeny in a meta-analysis. E.g.: AIC is calculated from Q in Phylometa, and Q increases with tree size.</p>
<p>So, I wrote some code to shuffle the tips of your tree N number of times, run Phylometa, and extract just the &ldquo;Phylogenetic MA&rdquo; part of the output. So, we compare the observed output (without tip shuffling) to the distribution of the tip shuffled output, and we can calculate a P-value from that. The code I wrote simply extracts the pooled effect size for fixed and also random-effects models. But you could change the code to extract whatever you like for the randomization.</p>
<p>I think the point of this code is not to estimate your pooled effects, etc., but may be an alternative way to compare traditional to phylogenetic MA where hopefully simply incorporating a tree is not penalizing the meta-analysis so much that you will always accept the traditional MA as better.</p>
<p>Get the code <a href="https://gist.github.com/925343#file_phylometa_rand_fxn_one.r">here</a>, and also below. Get the example <a href="http://wp.me/PRT1F-2R">tree file</a> and <a href="http://wp.me/PRT1F-2S">data file</a>, named &ldquo;phylogeny.txt&rdquo; and &ldquo;metadata_2g.txt&rdquo;, respectively below (or use your own data!). You need the file &ldquo;phylometa_fxn.r&rdquo; from my website, get <a href="https://gist.github.com/939970">here</a>, but just call it using source as seen below.</p>
<p>
<script src="https://gist.github.com/925343.js?file=phylometa_rand_fxn_one.R"></script>
`</p>
<p>As you can see, the observed values fall well within the distribution of values obtained from shuffling tips.  P-values were 0.64 and 0.68 for fixed- and random-effects MA&rsquo;s, respectively. This suggests, to me at least, that the traditional (distribution of tip shuffled analyses, the histograms below) and phylogenetic (red lines) MA&rsquo;s are not different. The way I would use this is as an additional analysis to the actual Phylometa output.</p>
<p><img loading="lazy" src="https://4.bp.blogspot.com/-fpEjXUBvAw8/TanftVw49QI/AAAAAAAAEbY/z9rJKThxRMo/s400/metadata_2g.txt.jpeg"></p>
]]></content:encoded>
    </item>
    <item>
      <title>Adjust branch lengths with node ages: comparison of two methods</title>
      <link>http://localhost:1313/2011/04/adjust-branch-lengths-with-node-ages-comparison-of-two-methods/</link>
      <pubDate>Sun, 10 Apr 2011 13:02:00 -0500</pubDate>
      <guid>http://localhost:1313/2011/04/adjust-branch-lengths-with-node-ages-comparison-of-two-methods/</guid>
      <description>&lt;p&gt;Here is an approach for comparing two methods of adjusting branch lengths on trees: bladj in the program Phylocom and a fxn written by Gene Hunt at the Smithsonian.&lt;/p&gt;
&lt;p&gt;Get the code and example files (tree and node ages) at &lt;a href=&#34;https://gist.github.com/938313&#34;&gt;https://gist.github.com/938313&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Get phylocom at &lt;a href=&#34;http://www.phylodiversity.net/phylocom/&#34;&gt;http://www.phylodiversity.net/phylocom/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Gene Hunt&amp;rsquo;s method has many options you can mess with, including setting tip ages (not available in bladj), setting node ages, and minimum branch length imposed. You will notice that Gene&amp;rsquo;s method may be not the appropriate if you only have extant taxa.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>Here is an approach for comparing two methods of adjusting branch lengths on trees: bladj in the program Phylocom and a fxn written by Gene Hunt at the Smithsonian.</p>
<p>Get the code and example files (tree and node ages) at <a href="https://gist.github.com/938313">https://gist.github.com/938313</a></p>
<p>Get phylocom at <a href="http://www.phylodiversity.net/phylocom/">http://www.phylodiversity.net/phylocom/</a></p>
<p>Gene Hunt&rsquo;s method has many options you can mess with, including setting tip ages (not available in bladj), setting node ages, and minimum branch length imposed. You will notice that Gene&rsquo;s method may be not the appropriate if you only have extant taxa.</p>
<p>The function AdjBrLens uses as input a newick tree file and a text file of node ages, and uses functions you can simply run by &ldquo;source&rdquo; the R file bladjing_twomethods.R file from <a href="https://gist.github.com/938313">here</a>.</p>
<p>Note that blad does not like numbers for node names, so you have to put a character in front of a number of just character names for nodes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># This is where the work happens... </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Directory below needs to have at least three items:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  1. phylocom executable for windows or mac</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  2. tree newick file</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  3. node ages file as required by phylocom, see their manual</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Output: trees_out is a list of three trees, the original, bladj, and Gene Hunt&#39;s method</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Also, within the function all three trees are written to file as PDFs</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">setwd</span>(<span style="color:#e6db74">&#34;/Mac/R_stuff/Blog_etc/Bladjing&#34;</span>) <span style="color:#75715e"># set working directory</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">source</span>(<span style="color:#e6db74">&#34;bladjing_twomethods.R&#34;</span>) <span style="color:#75715e"># run functions from source file</span>
</span></span><span style="display:flex;"><span>trees_out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">AdjBrLens</span>(<span style="color:#e6db74">&#34;tree.txt&#34;</span>, <span style="color:#e6db74">&#34;nodeages.txt&#34;</span>)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># plot trees of three methods together, </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># with nodes with age estimates labeled</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">jpeg</span>(<span style="color:#e6db74">&#34;threeplots.jpeg&#34;</span>, quality<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">layout</span>(<span style="color:#a6e22e">matrix</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot</span>(trees_out[[1]])
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">nodelabels</span>(trees_out[[1]]<span style="color:#f92672">$</span>node.label, cex <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.6</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">title</span>(<span style="color:#e6db74">&#34;original tree&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot</span>(trees_out[[2]])
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">nodelabels</span>(trees_out[[2]]<span style="color:#f92672">$</span>node.label, cex <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.6</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">title</span>(<span style="color:#e6db74">&#34;bladj method&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot</span>(trees_out[[3]])
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">nodelabels</span>(trees_out[[3]]<span style="color:#f92672">$</span>node.label, cex <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.6</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">title</span>(<span style="color:#e6db74">&#34;gene hunt method, scalePhylo&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dev.off</span>()
</span></span></code></pre></div><p><img loading="lazy" src="https://2.bp.blogspot.com/-tLK1y12TYlI/TaHwayCs3GI/AAAAAAAAEbU/rPsFYqSEDuI/s1600/threeplots.jpeg"></p>
]]></content:encoded>
    </item>
    <item>
      <title>cloudnumbers.com</title>
      <link>http://localhost:1313/2011/03/cloudnumbers-com/</link>
      <pubDate>Fri, 11 Mar 2011 07:28:00 -0600</pubDate>
      <guid>http://localhost:1313/2011/03/cloudnumbers-com/</guid>
      <description>&lt;p&gt;UPDATE: I guess it still is not actually available. Bummer&amp;hellip;&lt;/p&gt;
&lt;p&gt;Has anyone used cloudnumbers.com?&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cloudnumbers.com/&#34;&gt;http://www.cloudnumbers.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;They provide cloud computing, and have built in applications, including R.&lt;/p&gt;
&lt;p&gt;How well does it work? Does it increase processing speed? I guess it may at the least free up RAM and processor space on your own machine.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>UPDATE: I guess it still is not actually available. Bummer&hellip;</p>
<p>Has anyone used cloudnumbers.com?</p>
<p><a href="http://www.cloudnumbers.com/">http://www.cloudnumbers.com/</a></p>
<p>They provide cloud computing, and have built in applications, including R.</p>
<p>How well does it work? Does it increase processing speed? I guess it may at the least free up RAM and processor space on your own machine.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Five ways to visualize your pairwise comparisons</title>
      <link>http://localhost:1313/2011/03/for-all-your-pairwise-comparison-needs/</link>
      <pubDate>Sat, 05 Mar 2011 12:49:00 -0600</pubDate>
      <guid>http://localhost:1313/2011/03/for-all-your-pairwise-comparison-needs/</guid>
      <description>&lt;p&gt;UPDATE: &lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;At the bottom are two additional methods, and some additions (underlined) are added to the original 5 methods. Thanks for all the feedback&amp;hellip;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;p&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;-Also, another post &lt;!-- raw HTML omitted --&gt;here&lt;!-- raw HTML omitted --&gt; about ordered-categorical data&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;-Also #2, a method combining splom and hexbin packages &lt;!-- raw HTML omitted --&gt;here&lt;!-- raw HTML omitted --&gt;, for larger datasets&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>UPDATE: <!-- raw HTML omitted --><!-- raw HTML omitted -->At the bottom are two additional methods, and some additions (underlined) are added to the original 5 methods. Thanks for all the feedback&hellip;<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->-Also, another post <!-- raw HTML omitted -->here<!-- raw HTML omitted --> about ordered-categorical data<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->-Also #2, a method combining splom and hexbin packages <!-- raw HTML omitted -->here<!-- raw HTML omitted -->, for larger datasets<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>In data analysis it is often nice to look at all pairwise combinations of continuous variables in scatterplots. Up until recently, I have used the function splom in the package lattice, but ggplot2 has superior aesthetics, I think anyway.</p>
<p>Here a few ways to accomplish the task:</p>

<pre class="r geshifilter-R" style="font-family: monospace; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><a href="http://inside-r.org/r-doc/base/require"><span style="color: #003399; font-weight: bold;">require</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/lattice">lattice</a><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/require"><span style="color: #003399; font-weight: bold;">require</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ggplot2">ggplot2</a><span style="color: #009900;">)</span>&nbsp;<br /></pre><div><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><a href="http://inside-r.org/r-doc/base/require"><span style="color: #003399; font-weight: bold;">require</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/car">car</a><span style="color: #009900;">)</span></pre></div></div><br /></div>

<ol>
<li>Using base graphics, function &ldquo;pairs&rdquo;</li>
</ol>

<div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><a href="http://inside-r.org/r-doc/graphics/pairs"><span style="color: #003399; font-weight: bold;">pairs</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399; font-weight: bold;">iris</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span> pch = <span style="color: #cc66cc;">21</span><span style="color: #009900;">)</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://lh3.googleusercontent.com/-QrjiX4jAPxo/TXJ-Qj0mpfI/AAAAAAAAEac/DQkKhzJgl7c/s1600/pairs.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="https://lh3.googleusercontent.com/-QrjiX4jAPxo/TXJ-Qj0mpfI/AAAAAAAAEac/DQkKhzJgl7c/s400/pairs.png" width="400" /></a></div>

<ol start="2">
<li>Using lattice package, function &ldquo;splom&rdquo;</li>
</ol>

-<u>Additional code to improve splom plots <a href="http://www.mail-archive.com/r-help@stat.math.ethz.ch/msg94527.html">here</a> (and see Oscar's code below in comments)</u><br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><a href="http://inside-r.org/r-doc/lattice/splom"><span style="color: #003399; font-weight: bold;">splom</span></a><span style="color: #009900;">(</span>~<a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399; font-weight: bold;">iris</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://lh6.googleusercontent.com/-boKmTPP2s60/TXKAc4YcbCI/AAAAAAAAEak/ImCWlnGkpmc/s1600/splom.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="https://lh6.googleusercontent.com/-boKmTPP2s60/TXKAc4YcbCI/AAAAAAAAEak/ImCWlnGkpmc/s400/splom.png" width="400" /></a></div>

<ol start="3">
<li>Using package ggplot2, function &ldquo;plotmatrix&rdquo;</li>
</ol>

<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;">plotmatrix<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399; font-weight: bold;">iris</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://lh4.googleusercontent.com/-3aqCYfmVpNw/TXJ-RG6Zs8I/AAAAAAAAEag/ADZRrR8QB8g/s1600/plotmatrix.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="https://lh4.googleusercontent.com/-3aqCYfmVpNw/TXJ-RG6Zs8I/AAAAAAAAEag/ADZRrR8QB8g/s400/plotmatrix.png" width="400" /></a></div>

<ol start="4">
<li>a function called ggcorplot by Mike Lawrence at Dalhousie University</li>
</ol>

get ggcorplot function at <a href="http://groups.google.com/group/ggplot2/attach/6bf632a9718dddd6/ggcorplot.R?part=2">this link</a><br />-<u>ggcorplot is also built in to Deducer (<a href="http://www.deducer.org/pmwiki/pmwiki.php?n=Main.DeducerManual">get here</a>); see Ian's code below in the comments</u><br />-<u>Lastly, an improved version of ggcorplot is built in to the ez package (<a href="http://cran.r-project.org/web/packages/ez/index.html">get here</a>)</u><br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;">ggcorplot<span style="color: #009900;">(</span><br />  <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a> = <a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399; font-weight: bold;">iris</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span><br />  var_text_size = <span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span><br />  cor_text_limits = <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://lh6.googleusercontent.com/-jw2x1p68lp0/TXJ-Qs3JgwI/AAAAAAAAEaY/42UfLSleVHc/s1600/ggcorplot.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="https://lh6.googleusercontent.com/-jw2x1p68lp0/TXJ-Qs3JgwI/AAAAAAAAEaY/42UfLSleVHc/s400/ggcorplot.png" width="400" /></a></div>

<ol start="5">
<li>panel.cor function using pairs, similar to ggcorplot, but using base graphics. Not sure who wrote this function, but <a href="http://addictedtor.free.fr/graphiques/graphcode.php?graph=137">here</a> is where I found it.</li>
</ol>

<div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"></pre></div></div><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;">panel.cor &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span> y<span style="color: #339933;">,</span> digits=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> prefix=<span style="color: blue;">""</span><span style="color: #339933;">,</span> cex.cor<span style="color: #009900;">)</span> <br /><span style="color: #009900;">{</span><br />    usr &lt;- <a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">(</span><span style="color: blue;">"usr"</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span> <a href="http://inside-r.org/r-doc/base/on.exit"><span style="color: #003399; font-weight: bold;">on.exit</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">(</span>usr<span style="color: #009900;">)</span><span style="color: #009900;">)</span> <br />    <a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">(</span>usr = <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <br />    r &lt;- <a href="http://inside-r.org/r-doc/base/abs"><span style="color: #003399; font-weight: bold;">abs</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/stats/cor"><span style="color: #003399; font-weight: bold;">cor</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span> y<span style="color: #009900;">)</span><span style="color: #009900;">)</span> <br />    txt &lt;- <a href="http://inside-r.org/r-doc/base/format"><span style="color: #003399; font-weight: bold;">format</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span>r<span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.123456789</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> digits=digits<span style="color: #009900;">)</span><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> <br />    txt &lt;- <a href="http://inside-r.org/r-doc/base/paste"><span style="color: #003399; font-weight: bold;">paste</span></a><span style="color: #009900;">(</span>prefix<span style="color: #339933;">,</span> txt<span style="color: #339933;">,</span> sep=<span style="color: blue;">""</span><span style="color: #009900;">)</span> <br />    <span style="color: black; font-weight: bold;">if</span><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/missing"><span style="color: #003399; font-weight: bold;">missing</span></a><span style="color: #009900;">(</span>cex.cor<span style="color: #009900;">)</span><span style="color: #009900;">)</span> cex &lt;- <span style="color: #cc66cc;">0.8</span>/strwidth<span style="color: #009900;">(</span>txt<span style="color: #009900;">)</span> <br />&nbsp;<br />    test &lt;- <a href="http://inside-r.org/r-doc/stats/cor.test"><span style="color: #003399; font-weight: bold;">cor.test</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>y<span style="color: #009900;">)</span> <br />    <span style="color: #666666; font-style: italic;"># borrowed from printCoefmat</span><br />    Signif &lt;- <a href="http://inside-r.org/r-doc/stats/symnum"><span style="color: #003399; font-weight: bold;">symnum</span></a><span style="color: #009900;">(</span>test$p.value<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/boot/corr"><span style="color: #003399; font-weight: bold;">corr</span></a> = <span style="color: black; font-weight: bold;">FALSE</span><span style="color: #339933;">,</span> na = <span style="color: black; font-weight: bold;">FALSE</span><span style="color: #339933;">,</span> <br />                  cutpoints = <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.001</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.01</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.05</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.1</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />                  <a href="http://inside-r.org/r-doc/graphics/symbols"><span style="color: #003399; font-weight: bold;">symbols</span></a> = <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">"***"</span><span style="color: #339933;">,</span> <span style="color: blue;">"**"</span><span style="color: #339933;">,</span> <span style="color: blue;">"*"</span><span style="color: #339933;">,</span> <span style="color: blue;">"."</span><span style="color: #339933;">,</span> <span style="color: blue;">" "</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <br />&nbsp;<br />    <a href="http://inside-r.org/r-doc/graphics/text"><span style="color: #003399; font-weight: bold;">text</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span> txt<span style="color: #339933;">,</span> cex = cex * r<span style="color: #009900;">)</span> <br />    <a href="http://inside-r.org/r-doc/graphics/text"><span style="color: #003399; font-weight: bold;">text</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">.8</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">.8</span><span style="color: #339933;">,</span> Signif<span style="color: #339933;">,</span> cex=cex<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span> <br /><span style="color: #009900;">}</span><br />&nbsp;</pre><pre class="r geshifilter-R" style="font-family: monospace;"><a href="http://inside-r.org/r-doc/graphics/pairs"><span style="color: #003399; font-weight: bold;">pairs</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399; font-weight: bold;">iris</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span> lower.panel=<a href="http://inside-r.org/r-doc/graphics/panel.smooth"><span style="color: #003399; font-weight: bold;">panel.smooth</span></a><span style="color: #339933;">,</span> upper.panel=panel.cor<span style="color: #009900;">)</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://lh3.googleusercontent.com/-df9_9d84Qdg/TXJ9s9OZQgI/AAAAAAAAEaU/zHwWtTQZFSw/s1600/panel.cor.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="https://lh3.googleusercontent.com/-df9_9d84Qdg/TXJ9s9OZQgI/AAAAAAAAEaU/zHwWtTQZFSw/s400/panel.cor.png" width="400" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />A comparison of run times...<br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;">&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/graphics/pairs"><span style="color: #003399; font-weight: bold;">pairs</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399; font-weight: bold;">iris</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">0.138</span>   <span style="color: #cc66cc;">0.008</span>   <span style="color: #cc66cc;">0.156</span> <br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/lattice/splom"><span style="color: #003399; font-weight: bold;">splom</span></a><span style="color: #009900;">(</span>~<a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399; font-weight: bold;">iris</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">0.003</span>   <span style="color: #cc66cc;">0.000</span>   <span style="color: #cc66cc;">0.003</span> <br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span>plotmatrix<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399; font-weight: bold;">iris</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">0.052</span>   <span style="color: #cc66cc;">0.000</span>   <span style="color: #cc66cc;">0.052</span> <br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span>ggcorplot<span style="color: #009900;">(</span><br />+ <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a> = <a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399; font-weight: bold;">iris</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span><br />  var_text_size = <span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span><br />  cor_text_limits = <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />&nbsp;<br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">0.130</span>   <span style="color: #cc66cc;">0.001</span>   <span style="color: #cc66cc;">0.131</span> <br />&gt; <a href="http://inside-r.org/r-doc/base/system.time"><span style="color: #003399; font-weight: bold;">system.time</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/graphics/pairs"><span style="color: #003399; font-weight: bold;">pairs</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399; font-weight: bold;">iris</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span> lower.panel=<a href="http://inside-r.org/r-doc/graphics/panel.smooth"><span style="color: #003399; font-weight: bold;">panel.smooth</span></a><span style="color: #339933;">,</span> upper.panel=panel.cor<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />   user  <a href="http://inside-r.org/r-doc/base/system"><span style="color: #003399; font-weight: bold;">system</span></a> elapsed <br />  <span style="color: #cc66cc;">0.170</span>   <span style="color: #cc66cc;">0.011</span>   <span style="color: #cc66cc;">0.200</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br />

<p>&hellip;shows that splom is the fastest method, with the method using the panel.cor function pulling up the rear.</p>
<ol start="6">
<li>given by a reader in the comments (get her/his code <!-- raw HTML omitted -->here<!-- raw HTML omitted -->). This one is nice as it gives 95% CI&rsquo;s for the correlation coefficients, AND histograms of each variable.<!-- raw HTML omitted --><!-- raw HTML omitted --></li>
</ol>

<a href="https://lh5.googleusercontent.com/-zC6MFpoo5w8/TXO0aJt1UtI/AAAAAAAAEao/lMOOaniqYPU/s1600/pairs_anehandlesman.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="https://lh5.googleusercontent.com/-zC6MFpoo5w8/TXO0aJt1UtI/AAAAAAAAEao/lMOOaniqYPU/s400/pairs_anehandlesman.png" style="cursor: move;" width="400" /></a>

<p>7) a reader in the comments suggested the scatterplotMatrix (spm can be used) function in the car package. This one has the advantage of plotting distributions of each variable, and providing fits to each data with confidence intervals.</p>

<div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;">spm<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/datasets/iris"><span style="color: #003399; font-weight: bold;">iris</span></a><span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">4</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span></pre></div></div><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://lh4.googleusercontent.com/-gV9rB3jhZUU/TXTY57Z0bwI/AAAAAAAAEas/GuEWgTGpVzk/s1600/car.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="https://lh4.googleusercontent.com/-gV9rB3jhZUU/TXTY57Z0bwI/AAAAAAAAEas/GuEWgTGpVzk/s400/car.png" width="400" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://lh5.googleusercontent.com/-zC6MFpoo5w8/TXO0aJt1UtI/AAAAAAAAEao/lMOOaniqYPU/s1600/pairs_anehandlesman.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="https://lh5.googleusercontent.com/-zC6MFpoo5w8/TXO0aJt1UtI/AAAAAAAAEao/lMOOaniqYPU/s1600/pairs_anehandlesman.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="https://lh5.googleusercontent.com/-zC6MFpoo5w8/TXO0aJt1UtI/AAAAAAAAEao/lMOOaniqYPU/s1600/pairs_anehandlesman.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="https://lh5.googleusercontent.com/-zC6MFpoo5w8/TXO0aJt1UtI/AAAAAAAAEao/lMOOaniqYPU/s1600/pairs_anehandlesman.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="https://lh5.googleusercontent.com/-zC6MFpoo5w8/TXO0aJt1UtI/AAAAAAAAEao/lMOOaniqYPU/s1600/pairs_anehandlesman.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="https://lh5.googleusercontent.com/-zC6MFpoo5w8/TXO0aJt1UtI/AAAAAAAAEao/lMOOaniqYPU/s1600/pairs_anehandlesman.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a></div>

]]></content:encoded>
    </item>
    <item>
      <title>Phenotypic selection analysis in R</title>
      <link>http://localhost:1313/2011/02/phenotypic-selection-analysis-in-r/</link>
      <pubDate>Thu, 24 Feb 2011 09:43:00 -0600</pubDate>
      <guid>http://localhost:1313/2011/02/phenotypic-selection-analysis-in-r/</guid>
      <description>&lt;p&gt;I have up to recently always done my phenotypic selection analyses in SAS. I finally got some code I think works to do everything SAS would do. Feedback much appreciated!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-r&#34; data-lang=&#34;r&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;########################Selection analyses#############################&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;install.packages&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;car&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;reshape&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ggplot2&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;require&lt;/span&gt;(car)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;require&lt;/span&gt;(reshape)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;require&lt;/span&gt;(ggplot2)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Create data set&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dat &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;data.frame&lt;/span&gt;(plant &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;seq&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; trait1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;rep&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0.1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.15&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.21&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.25&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.6&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.8&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.9&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;13&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;14&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;), each &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;), trait2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;runif&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; fitness &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;rep&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;50&lt;/span&gt;), each &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Make relative fitness column&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dat_ &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cbind&lt;/span&gt;(dat, dat&lt;span style=&#34;color:#f92672&#34;&gt;$&lt;/span&gt;fitness&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mean&lt;/span&gt;(dat&lt;span style=&#34;color:#f92672&#34;&gt;$&lt;/span&gt;fitness))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;names&lt;/span&gt;(dat_)[5] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;relfitness&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Standardize traits&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dat_ &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cbind&lt;/span&gt;(dat_[,&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)], &lt;span style=&#34;color:#a6e22e&#34;&gt;rescaler&lt;/span&gt;(dat_[,&lt;span style=&#34;color:#a6e22e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)],&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;sd&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;####Selection differentials and correlations among traits, cor.prob uses function in functions.R file&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;############################################################################&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;####### Function for calculating correlation matrix, corrs below diagonal,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;####### and P-values above diagonal&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;############################################################################&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cor.prob &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt;(X, dfr &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;nrow&lt;/span&gt;(X) &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         R &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cor&lt;/span&gt;(X)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         above &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;row&lt;/span&gt;(R) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;col&lt;/span&gt;(R)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         r2 &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; R[above]^2
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         Fstat &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; r2 &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; dfr &lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; r2)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         R[above] &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;pf&lt;/span&gt;(Fstat, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, dfr)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;         R
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;} 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Get selection differentials and correlations among traits in one data frame&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dat_seldiffs &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cov&lt;/span&gt;(dat_[,&lt;span style=&#34;color:#a6e22e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)]) &lt;span style=&#34;color:#75715e&#34;&gt;# calculates sel&amp;#39;n differentials using cov&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dat_selcorrs &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cor.prob&lt;/span&gt;(dat_[,&lt;span style=&#34;color:#a6e22e&#34;&gt;c&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)]) &lt;span style=&#34;color:#75715e&#34;&gt;# use P-values above diagonal for significance of sel&amp;#39;n differentials in dat_seldiffs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dat_seldiffs_selcorrs &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;data.frame&lt;/span&gt;(dat_seldiffs, dat_selcorrs) &lt;span style=&#34;color:#75715e&#34;&gt;# combine the two&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;##########################################################################&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;####Selection gradients&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;dat_selngrad &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;lm&lt;/span&gt;(relfitness &lt;span style=&#34;color:#f92672&#34;&gt;~&lt;/span&gt; trait1 &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; trait2, data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dat_)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;summary&lt;/span&gt;(dat_selngrad) &lt;span style=&#34;color:#75715e&#34;&gt;# where &amp;#34;Estimate&amp;#34; is our sel&amp;#39;n gradient&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;####Check assumptions&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;shapiro.test&lt;/span&gt;(dat_selngrad&lt;span style=&#34;color:#f92672&#34;&gt;$&lt;/span&gt;residuals) &lt;span style=&#34;color:#75715e&#34;&gt;# normality, bummer, non-normal&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;hist&lt;/span&gt;(dat_selngrad&lt;span style=&#34;color:#f92672&#34;&gt;$&lt;/span&gt;residuals) &lt;span style=&#34;color:#75715e&#34;&gt;# plot residuals&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;vif&lt;/span&gt;(dat_selngrad) &lt;span style=&#34;color:#75715e&#34;&gt;# check variance inflation factors (need package car), everything looks fine&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;plot&lt;/span&gt;(dat_selngrad) &lt;span style=&#34;color:#75715e&#34;&gt;# cycle through diagnostic plots&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;############################################################################&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Plot data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;ggplot&lt;/span&gt;(dat_, &lt;span style=&#34;color:#a6e22e&#34;&gt;aes&lt;/span&gt;(trait1, relfitness)) &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;geom_point&lt;/span&gt;() &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;geom_smooth&lt;/span&gt;(method &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;lm&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;labs&lt;/span&gt;(x&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Trait 1&amp;#34;&lt;/span&gt;,y&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Relative fitness&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;ggsave&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;myplot.jpeg&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Plot of relative fitness vs. trait 1 standardized&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>I have up to recently always done my phenotypic selection analyses in SAS. I finally got some code I think works to do everything SAS would do. Feedback much appreciated!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">########################Selection analyses#############################</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;car&#34;</span>,<span style="color:#e6db74">&#34;reshape&#34;</span>,<span style="color:#e6db74">&#34;ggplot2&#34;</span>))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">require</span>(car)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">require</span>(reshape)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">require</span>(ggplot2)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create data set</span>
</span></span><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">data.frame</span>(plant <span style="color:#f92672">=</span> <span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">100</span>,<span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span> trait1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.1</span>,<span style="color:#ae81ff">0.15</span>,<span style="color:#ae81ff">0.2</span>,<span style="color:#ae81ff">0.21</span>,<span style="color:#ae81ff">0.25</span>,<span style="color:#ae81ff">0.3</span>,<span style="color:#ae81ff">0.5</span>,<span style="color:#ae81ff">0.6</span>,<span style="color:#ae81ff">0.8</span>,<span style="color:#ae81ff">0.9</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">16</span>), each <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>), trait2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">runif</span>(<span style="color:#ae81ff">100</span>),
</span></span><span style="display:flex;"><span> fitness <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">50</span>), each <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>))
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Make relative fitness column</span>
</span></span><span style="display:flex;"><span>dat_ <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cbind</span>(dat, dat<span style="color:#f92672">$</span>fitness<span style="color:#f92672">/</span><span style="color:#a6e22e">mean</span>(dat<span style="color:#f92672">$</span>fitness))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(dat_)[5] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;relfitness&#34;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Standardize traits</span>
</span></span><span style="display:flex;"><span>dat_ <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cbind</span>(dat_[,<span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>)], <span style="color:#a6e22e">rescaler</span>(dat_[,<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>)],<span style="color:#e6db74">&#34;sd&#34;</span>))
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e">####Selection differentials and correlations among traits, cor.prob uses function in functions.R file</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">############################################################################</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">####### Function for calculating correlation matrix, corrs below diagonal,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">####### and P-values above diagonal</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">############################################################################</span>
</span></span><span style="display:flex;"><span>cor.prob <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(X, dfr <span style="color:#f92672">=</span> <span style="color:#a6e22e">nrow</span>(X) <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>) {
</span></span><span style="display:flex;"><span>         R <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cor</span>(X)
</span></span><span style="display:flex;"><span>         above <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">row</span>(R) <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">col</span>(R)
</span></span><span style="display:flex;"><span>         r2 <span style="color:#f92672">&lt;-</span> R[above]^2
</span></span><span style="display:flex;"><span>         Fstat <span style="color:#f92672">&lt;-</span> r2 <span style="color:#f92672">*</span> dfr <span style="color:#f92672">/</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> r2)
</span></span><span style="display:flex;"><span>         R[above] <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">pf</span>(Fstat, <span style="color:#ae81ff">1</span>, dfr)
</span></span><span style="display:flex;"><span>         R
</span></span><span style="display:flex;"><span>} 
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get selection differentials and correlations among traits in one data frame</span>
</span></span><span style="display:flex;"><span>dat_seldiffs <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cov</span>(dat_[,<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>)]) <span style="color:#75715e"># calculates sel&#39;n differentials using cov</span>
</span></span><span style="display:flex;"><span>dat_selcorrs <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cor.prob</span>(dat_[,<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>)]) <span style="color:#75715e"># use P-values above diagonal for significance of sel&#39;n differentials in dat_seldiffs</span>
</span></span><span style="display:flex;"><span>dat_seldiffs_selcorrs <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">data.frame</span>(dat_seldiffs, dat_selcorrs) <span style="color:#75715e"># combine the two</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e">##########################################################################</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">####Selection gradients</span>
</span></span><span style="display:flex;"><span>dat_selngrad <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(relfitness <span style="color:#f92672">~</span> trait1 <span style="color:#f92672">*</span> trait2, data <span style="color:#f92672">=</span> dat_)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span>(dat_selngrad) <span style="color:#75715e"># where &#34;Estimate&#34; is our sel&#39;n gradient</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e">####Check assumptions</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">shapiro.test</span>(dat_selngrad<span style="color:#f92672">$</span>residuals) <span style="color:#75715e"># normality, bummer, non-normal</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">hist</span>(dat_selngrad<span style="color:#f92672">$</span>residuals) <span style="color:#75715e"># plot residuals</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">vif</span>(dat_selngrad) <span style="color:#75715e"># check variance inflation factors (need package car), everything looks fine</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot</span>(dat_selngrad) <span style="color:#75715e"># cycle through diagnostic plots</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e">############################################################################</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot data</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(dat_, <span style="color:#a6e22e">aes</span>(trait1, relfitness)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">labs</span>(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Trait 1&#34;</span>,y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Relative fitness&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggsave</span>(<span style="color:#e6db74">&#34;myplot.jpeg&#34;</span>)
</span></span></code></pre></div><p>Plot of relative fitness vs. trait 1 standardized</p>
<p><img loading="lazy" src="https://2.bp.blogspot.com/-OVQl92LOmZY/TWZ8RW9lHlI/AAAAAAAAEaQ/MGB39Lyghig/s400/myplot.jpeg"></p>
]]></content:encoded>
    </item>
  </channel>
</rss>
