<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Phylogenetic on Recology</title>
    <link>http://localhost:1313/tags/phylogenetic/</link>
    <description>Recent content in Phylogenetic on Recology</description>
    <generator>Hugo -- 0.144.1</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 01 Jun 2013 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/phylogenetic/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Fylopic, an R wrapper to Phylopic</title>
      <link>http://localhost:1313/2013/06/fylopic/</link>
      <pubDate>Sat, 01 Jun 2013 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2013/06/fylopic/</guid>
      <description>&lt;h2 id=&#34;what-is-phylopic&#34;&gt;What is PhyloPic?&lt;/h2&gt;
&lt;p&gt;PhyloPic is an awesome new service - I&amp;rsquo;ll let the creator, &lt;a href=&#34;http://tmkeesey.net/&#34;&gt;Mike Keesey&lt;/a&gt;, explain what it is (paraphrasing here):&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;PhyloPic stores silhouette images of organisms, and each image is associated with taxonomic names, and stores the taxonomy of all taxa, allowing searching by taxonomic names. Anyone can submit silhouettes to PhyloPic.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;What is a silhouette?  It&amp;rsquo;s like this:&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;A silhouette&#34; loading=&#34;lazy&#34; src=&#34;http://phylopic.org/assets/images/submissions/bedd622a-4de2-4067-8c70-4aa44326d229.128.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;by Gareth Monger&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;What makes PhyloPic not just awesome, but super awesome? All or most images are licensed under &lt;a href=&#34;http://creativecommons.org/&#34;&gt;Creative Commons licenses&lt;/a&gt;. This means you can use the silhouettes without having to ask or pay - just attribute.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="what-is-phylopic">What is PhyloPic?</h2>
<p>PhyloPic is an awesome new service - I&rsquo;ll let the creator, <a href="http://tmkeesey.net/">Mike Keesey</a>, explain what it is (paraphrasing here):</p>
<blockquote>
<p>PhyloPic stores silhouette images of organisms, and each image is associated with taxonomic names, and stores the taxonomy of all taxa, allowing searching by taxonomic names. Anyone can submit silhouettes to PhyloPic.</p></blockquote>
<p>What is a silhouette?  It&rsquo;s like this:</p>
<p><img alt="A silhouette" loading="lazy" src="http://phylopic.org/assets/images/submissions/bedd622a-4de2-4067-8c70-4aa44326d229.128.png"></p>
<p><em>by Gareth Monger</em></p>
<p>What makes PhyloPic not just awesome, but super awesome? All or most images are licensed under <a href="http://creativecommons.org/">Creative Commons licenses</a>. This means you can use the silhouettes without having to ask or pay - just attribute.</p>
<h2 id="what-is-fylopic">What is fylopic?</h2>
<p>The idea behind Fylopic is to create modular bits and pieces (i.e., functions) to allow you to add silhouettes to not only ggplot2 plots, but base plots as well. That is, you can simply load fylopic in your R session, and add some silhouettes to your phylogeny, or your barchart, etc. - that is, <code>fylopic</code> is meant to be a helper in your workflow to add in silhouettes to visualizations.</p>
<p>Some people prefer base plots while others prefer ggplot2 plots (me!), so it would be nice to have both options. Phylogenies at the moment render faster in base plots. I don&rsquo;t yet have implementations for base plots, but will come soon, or you can send a pull request to add it.</p>
<p>One interesting use case could be to be able to get a set of silhouettes, then get a phylogeny for taxa associatd with the silhouettess using the NCBI taxonomy, but it&rsquo;s not easily available yet (though I may be able to use <a href="https://github.com/bendmorris/phylocommons">Ben Morris&rsquo; phylocommons</a> soon. This isn&rsquo;t doable yet, so in the example below the function <code>make_phylo</code> creates a phylogeny using <code>ape::rcoal</code>.</p>
<p>You could also do the reverse -&gt; you have a phylogeny and then you could search Phylopic for silhouettes.</p>
<h2 id="info">Info</h2>
<p>Check out the Phylopic website <a href="http://phylopic.org/">here</a>, and Phylopic API developer documentation <a href="http://phylopic.org/api/">here</a>.</p>
<p>Also check out Ben Morris&rsquo; Python wrapper to Phylopic <a href="https://github.com/bendmorris/python-phylopic">here</a>.</p>
<h2 id="what-can-you-do-with-fylopic">What can you do with fylopic?</h2>
<h4 id="install-fylopic">Install fylopic</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;devtools&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(devtools)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">install_github</span>(<span style="color:#e6db74">&#34;fylopic&#34;</span>, <span style="color:#e6db74">&#34;sckott&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(fylopic, quietly <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span></code></pre></div><h4 id="plot-a-phylogeny-with-silhouettes-at-the-tips">Plot a phylogeny with silhouettes at the tips</h4>
<p>Here, I search for names based on keyword <em>Homo sapiens</em> - which returns many matche codes. With those results we search for any silhouettes associated with those codes. Then we download images. Finally, make a phylogeny with the silhouettes at the tips. Note that in this eample the phylogeny is just a random coalescent tree made using <code>ape::rcoal</code> - obviously, in the real world you&rsquo;d want to do something more useful.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">## search on Homo sapiens</span>
</span></span><span style="display:flex;"><span>searchres <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">search_text</span>(text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Homo sapiens&#34;</span>, options <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;names&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">### which returns UUIDs</span>
</span></span><span style="display:flex;"><span>searchres[1<span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;74aea16b-666b-497a-b2cb-72201ad75a8e&#34;</span>
</span></span><span style="display:flex;"><span>[2] <span style="color:#e6db74">&#34;1ee65cf3-53db-4a52-9960-a9f7093d845d&#34;</span>
</span></span><span style="display:flex;"><span>[3] <span style="color:#e6db74">&#34;cc9ad8ee-3a82-4add-8d50-bc78f4ff6956&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## search for images based on the UUIds</span>
</span></span><span style="display:flex;"><span>output <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">search_images</span>(uuid <span style="color:#f92672">=</span> searchres, options <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;pngFiles&#34;</span>, <span style="color:#e6db74">&#34;credit&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;canonicalName&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">### we got eight matches</span>
</span></span><span style="display:flex;"><span>output
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>`15444b9c-f17f-4d6e-89b5-5990096bcfb0`
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>`15444b9c-f17f-4d6e-89b5-5990096bcfb0`<span style="color:#f92672">$</span>supertaxa
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;e547cd01-7dd1-495b-8239-52cf9971a609&#34;</span>
</span></span><span style="display:flex;"><span>[2] <span style="color:#e6db74">&#34;bd88f674-6976-4cb2-a46e-e6a12a8ba463&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>`fedf0e5f-f20a-442c-accf-eb84a3af8c6b`
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>`fedf0e5f-f20a-442c-accf-eb84a3af8c6b`<span style="color:#f92672">$</span>supertaxa
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;e547cd01-7dd1-495b-8239-52cf9971a609&#34;</span>
</span></span><span style="display:flex;"><span>[2] <span style="color:#e6db74">&#34;bd88f674-6976-4cb2-a46e-e6a12a8ba463&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>`a88d3a4c-44d3-409e-87b6-516bd188c709`
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>`a88d3a4c-44d3-409e-87b6-516bd188c709`<span style="color:#f92672">$</span>supertaxa
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;e547cd01-7dd1-495b-8239-52cf9971a609&#34;</span>
</span></span><span style="display:flex;"><span>[2] <span style="color:#e6db74">&#34;bd88f674-6976-4cb2-a46e-e6a12a8ba463&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>`d88164ec-3152-444b-b41c-4757a344a764`
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>`d88164ec-3152-444b-b41c-4757a344a764`<span style="color:#f92672">$</span>supertaxa
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;9c6af553-390c-4bdd-baeb-6992cbc540b1&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>`da5eaeb7-1ed2-4b2e-ad4a-49993881d706`
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>`da5eaeb7-1ed2-4b2e-ad4a-49993881d706`<span style="color:#f92672">$</span>supertaxa
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;9c6af553-390c-4bdd-baeb-6992cbc540b1&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## download images</span>
</span></span><span style="display:flex;"><span>myobjs <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_image</span>(uuids <span style="color:#f92672">=</span> output, size <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;128&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## make the phylogeny</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">make_phylo</span>(pngobj <span style="color:#f92672">=</span> myobjs)
</span></span></code></pre></div><p><img alt="center" loading="lazy" src="/2013-06-01-fylopic/unnamed-chunk-1.png"></p>
<h4 id="plot-a-silhouette-behind-a-plot">Plot a silhouette behind a plot</h4>
<p>Notice in the below example that you can use normal <code>ggplot2</code> syntax, and simply add another layer (<code>add_phylopic</code> from <code>fylopic</code>) to the plot.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggplot2)
</span></span><span style="display:flex;"><span>img <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_image</span>(<span style="color:#e6db74">&#34;27356f15-3cf8-47e8-ab41-71c6260b2724&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;512&#34;</span>)[[1]]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">qplot</span>(x <span style="color:#f92672">=</span> Sepal.Length, y <span style="color:#f92672">=</span> Sepal.Width, data <span style="color:#f92672">=</span> iris, geom <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;point&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">add_phylopic</span>(img)
</span></span></code></pre></div><p><img alt="center" loading="lazy" src="/2013-06-01-fylopic/unnamed-chunk-2.png"></p>
<h2 id="whats-next">What&rsquo;s next?</h2>
<p>This is a side project, so if anyone has interest in helping please do contribute code, report bugs, request features, etc.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Getting a simple tree via NCBI</title>
      <link>http://localhost:1313/2013/02/common-tree/</link>
      <pubDate>Thu, 14 Feb 2013 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2013/02/common-tree/</guid>
      <description>&lt;p&gt;I was just at the &lt;a href=&#34;http://www.evoio.org/wiki/Phylotastic&#34;&gt;Phylotastic hackathon&lt;/a&gt; in Tucson, AZ at the &lt;a href=&#34;http://www.iplantcollaborative.org/&#34;&gt;iPlant&lt;/a&gt; facilities at the UofA.&lt;/p&gt;
&lt;p&gt;A problem that needs to be solved is getting the incrasingly vast phylogenetic information to folks not comfortable building their own phylogenies. &lt;a href=&#34;http://phylodiversity.net/phylomatic/&#34;&gt;Phylomatic&lt;/a&gt; has made this super easy for people that want plant phylogenies (at least 250 or so papers have used and cited Phylomatic in their papers) - however, there are few options for those that want phylogenies for other taxonomic groups.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>I was just at the <a href="http://www.evoio.org/wiki/Phylotastic">Phylotastic hackathon</a> in Tucson, AZ at the <a href="http://www.iplantcollaborative.org/">iPlant</a> facilities at the UofA.</p>
<p>A problem that needs to be solved is getting the incrasingly vast phylogenetic information to folks not comfortable building their own phylogenies. <a href="http://phylodiversity.net/phylomatic/">Phylomatic</a> has made this super easy for people that want plant phylogenies (at least 250 or so papers have used and cited Phylomatic in their papers) - however, there are few options for those that want phylogenies for other taxonomic groups.</p>
<p>One cool tool that was brought up was the <a href="http://www.ncbi.nlm.nih.gov/Taxonomy/CommonTree/wwwcmt.cgi">Common Tree</a> service provided by NCBI. <a href="http://www.ncbi.nlm.nih.gov/Taxonomy/CommonTree/cmthelp.html">Here&rsquo;s</a> some help on the service. Unlike Phylomatic, Common Tree is purely based off of taxonomic relationships (A and B are both in the C family, so are sisters), not an actual phylogeny as Phylomatic is based on.</p>
<p>But how do you use Common Tree?</p>
<h3 id="get-a-species-list">Get a species list</h3>
<p>Grab the taxon list from my github account <a href="https://raw.github.com/sckott/sckott.github.com/master/public/img/species.txt">here</a></p>
<h3 id="go-to-the-site">Go to the site</h3>
<p>Go to the Common Tree site <a href="http://www.ncbi.nlm.nih.gov/Taxonomy/CommonTree/wwwcmt.cgi">here</a></p>
<h3 id="choose-file">Choose file</h3>
<p>Hit the &ldquo;choose file&rdquo; button, then select the <code>species.txt</code> file you downloaded in the first step.</p>
<h3 id="add-the-species-list-to-make-the-tree">Add the species list to make the tree</h3>
<p>Then hit &ldquo;add from file&rdquo;, and you got a &ldquo;tree&rdquo;</p>
<p><img alt="image" loading="lazy" src="https://raw.github.com/sckott/sckott.github.com/master/public/img/ncbi.png"></p>
<h2 id="download">Download</h2>
<p>You can download the tree in a variety of formats, including a .phy file</p>
<p><img alt="image" loading="lazy" src="https://raw.github.com/sckott/sckott.github.com/master/public/img/ncbi2.png"></p>
<h2 id="plot-the-tree-on-your-machine">Plot the tree on your machine</h2>
<p>Make a tree, in R for me</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install.packages(&#39;ape&#39;) # install if you don&#39;t have ape</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ape)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Read the tree in. YOu get the tree back with alot of newlines (\n) -</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># can easily take these out with a good text editor.</span>
</span></span><span style="display:flex;"><span>tree <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.tree</span>(text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;(Lampetra:4,((((((Umbra:4,((Lota:4,Microgadus:4)Gadiformes:4,((Culaea:4,Apeltes:4,Pungitius:4,Gasterosteus:4)Gasterosteidae:4,(Morone:4,(Ambloplites:4,Micropterus:4,Lepomis:4)Centrarchidae:4,(Sander:4,Perca:4)Percidae:4)Percoidei:4,Cottus:4)Percomorpha:4)Holacanthopterygii:4)Neognathi:4,(((Prosopium:4,Coregonus:4)Coregoninae:4,(Salvelinus:4,Salmo:4,Oncorhynchus:4)Salmoninae:4)Salmonidae:4,Osmerus:4)Protacanthopterygii:4)Euteleostei:4,(Alosa:4,(Ameiurus:4,(Catostomus:4,(Semotilus:4,Rhinichthys:4,Margariscus:4,Couesius:4,Pimephales:4,Luxilus:4,Notemigonus:4,Notropis:4,Carassius:4)Cyprinidae:4)Cypriniformes:4)Otophysi:4)Otocephala:4)Clupeocephala:4,Anguilla:4)Elopocephala:4,Acipenser:4)Actinopteri:4,Scyliorhinus:4)Gnathostomata:4)Vertebrata:4;&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># stretch the branches so tips line up</span>
</span></span><span style="display:flex;"><span>tree2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">compute.brlen</span>(tree, method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Grafen&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot the tree</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot</span>(tree2, no.margin <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>, cex <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.7</span>)
</span></span></code></pre></div><h3 id="w00p-there-it-is">w00p, there it is&hellip;</h3>
<p><img alt="image4" loading="lazy" src="https://raw.github.com/sckott/sckott.github.com/master/public/img/ncbi_tree.png"></p>
<p>And the answer is <em>NO</em> to the question: Is there an API for Common Tree?</p>
<hr>
<p>Get the .Rmd file used to create this post <a href="https://github.com/sckott/sckott.github.com/tree/master/_drafts/2013-02-14-common-tree.Rmd">at my github account</a> - or <a href="https://github.com/sckott/sckott.github.com/tree/master/_posts/2013-02-14-common-tree.md">.md file</a>.</p>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Exploring phylogenetic tree balance metrics</title>
      <link>http://localhost:1313/2012/10/phylogenetic-tree-balance/</link>
      <pubDate>Wed, 10 Oct 2012 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2012/10/phylogenetic-tree-balance/</guid>
      <description>&lt;p&gt;I need to simulate balanced and unbalanced phylogenetic trees for some research I am doing.  In order to do this, I do rejection sampling: simulate a tree -&amp;gt; measure tree shape -&amp;gt; reject if not balanced or unbalanced &lt;strong&gt;enough&lt;/strong&gt;.  But what is enough?  We need to define some cutoff value to determine what will be our set of balanced and unbalanced trees.&lt;/p&gt;
&lt;h3 id=&#34;calculate-shape-metrics&#34;&gt;calculate shape metrics&lt;/h3&gt;
&lt;p&gt;A function to calculate shape metrics, and a custom theme for plottingn phylogenies.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>I need to simulate balanced and unbalanced phylogenetic trees for some research I am doing.  In order to do this, I do rejection sampling: simulate a tree -&gt; measure tree shape -&gt; reject if not balanced or unbalanced <strong>enough</strong>.  But what is enough?  We need to define some cutoff value to determine what will be our set of balanced and unbalanced trees.</p>
<h3 id="calculate-shape-metrics">calculate shape metrics</h3>
<p>A function to calculate shape metrics, and a custom theme for plottingn phylogenies.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>foo <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(x, metric <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;colless&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (metric <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;colless&#34;</span>) {
</span></span><span style="display:flex;"><span>        xx <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.treeshape</span>(x)  <span style="color:#75715e"># convert to apTreeshape format</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">colless</span>(xx, <span style="color:#e6db74">&#34;yule&#34;</span>)  <span style="color:#75715e"># calculate colless&#39; metric</span>
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (metric <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;gamma&#34;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">gammaStat</span>(x)
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">stop</span>(<span style="color:#e6db74">&#34;metric should be one of colless or gamma&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>theme_myblank <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">stopifnot</span>(<span style="color:#a6e22e">require</span>(ggplot2))
</span></span><span style="display:flex;"><span>    theme_blank <span style="color:#f92672">&lt;-</span> ggplot2<span style="color:#f92672">::</span>theme_blank
</span></span><span style="display:flex;"><span>    ggplot2<span style="color:#f92672">::</span><span style="color:#a6e22e">theme</span>(panel.grid.major <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(), panel.grid.minor <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(), 
</span></span><span style="display:flex;"><span>        panel.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(), plot.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(), 
</span></span><span style="display:flex;"><span>        axis.title.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(colour <span style="color:#f92672">=</span> <span style="color:#66d9ef">NA</span>), axis.title.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(), 
</span></span><span style="display:flex;"><span>        axis.text.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(), axis.text.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(), axis.line <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(), 
</span></span><span style="display:flex;"><span>        axis.ticks <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="simulate-some-trees">Simulate some trees</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ape)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(phytools)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>numtrees <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">1000</span>  <span style="color:#75715e"># lets simulate 1000 trees</span>
</span></span><span style="display:flex;"><span>trees <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">pbtree</span>(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>, nsim <span style="color:#f92672">=</span> numtrees, ape <span style="color:#f92672">=</span> F)  <span style="color:#75715e"># simulate 500 pure-birth trees with 100 spp each, ape = F makes it run faster</span>
</span></span></code></pre></div><h3 id="calculate-colless-shape-metric-on-each-tree">Calculate Colless&rsquo; shape metric on each tree</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(plyr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(apTreeshape)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>colless_df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ldply</span>(trees, foo, metric <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;colless&#34;</span>)  <span style="color:#75715e"># calculate metric for each tree</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(colless_df)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>       V1
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">-0.1761</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">0.2839</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">0.4639</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">0.9439</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> <span style="color:#ae81ff">-0.6961</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span> <span style="color:#ae81ff">-0.1161</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Calculate the percent of trees that will fall into the cutoff for balanced and unbalanced trees</span>
</span></span><span style="display:flex;"><span>col_percent_low <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">round</span>(<span style="color:#a6e22e">length</span>(colless_df[colless_df<span style="color:#f92672">$</span>V1 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">-0.7</span>, <span style="color:#e6db74">&#34;V1&#34;</span>])<span style="color:#f92672">/</span>numtrees, <span style="color:#ae81ff">2</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>col_percent_high <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">round</span>(<span style="color:#a6e22e">length</span>(colless_df[colless_df<span style="color:#f92672">$</span>V1 <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0.7</span>, <span style="color:#e6db74">&#34;V1&#34;</span>])<span style="color:#f92672">/</span>numtrees, <span style="color:#ae81ff">2</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
</span></span></code></pre></div><h3 id="create-a-distribution-of-the-metric-values">Create a distribution of the metric values</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggplot2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggplot</span>(colless_df, <span style="color:#a6e22e">aes</span>(V1)) <span style="color:#f92672">+</span>  <span style="color:#75715e"># plot histogram of distribution of values</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">geom_histogram</span>() <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">theme_bw</span>(base_size<span style="color:#f92672">=</span><span style="color:#ae81ff">18</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">scale_x_continuous</span>(limits<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-3</span>,<span style="color:#ae81ff">3</span>), breaks<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-3</span>,<span style="color:#ae81ff">-2</span>,<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>)) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">geom_vline</span>(xintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">-0.7</span>, colour<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>, linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;longdash&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">geom_vline</span>(xintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.7</span>, colour<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>, linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;longdash&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ggtitle</span>(<span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;Distribution of Colless&#39; metric for 1000 trees, cutoffs at -0.7 and 0.7 results in\n &#34;</span>, col_percent_low, <span style="color:#e6db74">&#34;% (&#34;</span>, numtrees<span style="color:#f92672">*</span>(col_percent_low<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>), <span style="color:#e6db74">&#34;) &#39;balanced&#39; trees (left) and &#34;</span>, col_percent_low, <span style="color:#e6db74">&#34;% (&#34;</span>, numtrees<span style="color:#f92672">*</span>(col_percent_low<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>), <span style="color:#e6db74">&#34;) &#39;unbalanced&#39; trees (right)&#34;</span>)) <span style="color:#f92672">+</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Colless&#39; Metric Value&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Number of phylogenetic trees&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">theme</span>(plot.title  <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a
</span></span></code></pre></div><p><img alt="center" loading="lazy" src="/collesshist.png"></p>
<h3 id="create-phylogenies-representing-balanced-and-unbalanced-trees-using-the-custom-theme">Create phylogenies representing balanced and unbalanced trees (using the custom theme)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggphylo)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggphylo</span>(trees<span style="color:#a6e22e">[which.min</span>(colless_df<span style="color:#f92672">$</span>V1)], do.plot <span style="color:#f92672">=</span> F) <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_myblank</span>()
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggphylo</span>(trees<span style="color:#a6e22e">[which.max</span>(colless_df<span style="color:#f92672">$</span>V1)], do.plot <span style="color:#f92672">=</span> F) <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_myblank</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>b
</span></span></code></pre></div><p><img alt="center" loading="lazy" src="/collessphylog.png"></p>
<h3 id="now-put-it-all-together-in-one-plot-using-some-gridextra-magic">Now, put it all together in one plot using some gridExtra magic.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(gridExtra)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">grid.newpage</span>()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pushViewport</span>(<span style="color:#a6e22e">viewport</span>(layout <span style="color:#f92672">=</span> <span style="color:#a6e22e">grid.layout</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)))
</span></span><span style="display:flex;"><span>vpa_ <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">viewport</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.49</span>)
</span></span><span style="display:flex;"><span>vpb_ <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">viewport</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.35</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.35</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.23</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.7</span>)
</span></span><span style="display:flex;"><span>vpc_ <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">viewport</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.35</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.35</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.82</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.7</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">print</span>(a, vp <span style="color:#f92672">=</span> vpa_)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">print</span>(b, vp <span style="color:#f92672">=</span> vpb_)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">print</span>(c, vp <span style="color:#f92672">=</span> vpc_)
</span></span></code></pre></div><p><img alt="center" loading="lazy" src="/collessall.png"></p>
<h3 id="and-the-same-for-gamma-stat-which-measures-the-distribution-of-nodes-in-time">And the same for Gamma stat, which measures the distribution of nodes in time.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>gamma_df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ldply</span>(trees, foo, metric<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;gamma&#34;</span>) <span style="color:#75715e"># calculate metric for each tree</span>
</span></span><span style="display:flex;"><span>gam_percent_low <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">round</span>(<span style="color:#a6e22e">length</span>(gamma_df[gamma_df<span style="color:#f92672">$</span>V1 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">-1</span>, <span style="color:#e6db74">&#34;V1&#34;</span>])<span style="color:#f92672">/</span>numtrees, <span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>gam_percent_high <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">round</span>(<span style="color:#a6e22e">length</span>(gamma_df[gamma_df<span style="color:#f92672">$</span>V1 <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;V1&#34;</span>])<span style="color:#f92672">/</span>numtrees, <span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggplot</span>(gamma_df, <span style="color:#a6e22e">aes</span>(V1)) <span style="color:#f92672">+</span>  <span style="color:#75715e"># plot histogram of distribution of values</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">geom_histogram</span>() <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">theme_bw</span>(base_size<span style="color:#f92672">=</span><span style="color:#ae81ff">18</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">scale_x_continuous</span>(breaks<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-3</span>,<span style="color:#ae81ff">-2</span>,<span style="color:#ae81ff">-1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>)) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">geom_vline</span>(xintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">-1</span>, colour<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>, linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;longdash&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">geom_vline</span>(xintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, colour<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>, linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;longdash&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ggtitle</span>(<span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;Distribution of Gamma metric for 1000 trees, cutoffs at -1 and 1 results in\n &#34;</span>, gam_percent_low, <span style="color:#e6db74">&#34;% (&#34;</span>, numtrees<span style="color:#f92672">*</span>(gam_percent_low<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>), <span style="color:#e6db74">&#34;) trees with deeper nodes (left) and &#34;</span>, gam_percent_high, <span style="color:#e6db74">&#34;% (&#34;</span>, numtrees<span style="color:#f92672">*</span>(gam_percent_high<span style="color:#f92672">/</span><span style="color:#ae81ff">100</span>), <span style="color:#e6db74">&#34;) trees with shallower nodes (right)&#34;</span>)) <span style="color:#f92672">+</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Gamma Metric Value&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Number of phylogenetic trees&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">theme</span>(plot.title  <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>))
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggphylo</span>(trees<span style="color:#a6e22e">[which.min</span>(gamma_df<span style="color:#f92672">$</span>V1)], do.plot<span style="color:#f92672">=</span>F) <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_myblank</span>()
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggphylo</span>(trees<span style="color:#a6e22e">[which.max</span>(gamma_df<span style="color:#f92672">$</span>V1)], do.plot<span style="color:#f92672">=</span>F) <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_myblank</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">grid.newpage</span>()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pushViewport</span>(<span style="color:#a6e22e">viewport</span>(layout <span style="color:#f92672">=</span> <span style="color:#a6e22e">grid.layout</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>)))
</span></span><span style="display:flex;"><span>vpa_ <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">viewport</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.49</span>)
</span></span><span style="display:flex;"><span>vpb_ <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">viewport</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.35</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.35</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.23</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.7</span>)
</span></span><span style="display:flex;"><span>vpc_ <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">viewport</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.35</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.35</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.82</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.7</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">print</span>(a, vp <span style="color:#f92672">=</span> vpa_)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">print</span>(b, vp <span style="color:#f92672">=</span> vpb_)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">print</span>(c, vp <span style="color:#f92672">=</span> vpc_)
</span></span></code></pre></div><p><img alt="center" loading="lazy" src="/gammaall.png"></p>
<hr>
<p>Get the .Rmd file used to create this post <a href="https://github.com/sckott/sckott.github.com/tree/master/_drafts/2012-10-10-phylogenetic-tree-balance.Rmd">at my github account</a> - or <a href="https://github.com/sckott/sckott.github.com/tree/master/_posts/2012-10-10-phylogenetic-tree-balance.md">.md file</a>.</p>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>.</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
