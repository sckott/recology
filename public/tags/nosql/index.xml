<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Nosql on Recology</title>
    <link>http://localhost:1313/tags/nosql/</link>
    <description>Recent content in Nosql on Recology</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 18 Nov 2014 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/nosql/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>sofa - reboot</title>
      <link>http://localhost:1313/2014/11/sofa/</link>
      <pubDate>Tue, 18 Nov 2014 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2014/11/sofa/</guid>
      <description><![CDATA[<p>I&rsquo;ve reworked <code>sofa</code> recently after someone reported a bug in the package. Since the last post on this package on 2013-06-21, there&rsquo;s a bunch of changes:</p>
<ul>
<li>Removed the <code>sofa_</code> prefix from all functions as it wasn&rsquo;t really necessary.</li>
<li>Replaced <code>rjson</code>/<code>RJSONIO</code> with <code>jsonlite</code> for JSON I/O.</li>
<li>New functions:
<ul>
<li><code>revisions()</code> - to get the revision numbers for a document.</li>
<li><code>uuids()</code> - get any number of UUIDs - e.g., if you want to set document IDs with UUIDs</li>
</ul>
</li>
<li>Most functions that deal with documents are prefixed with <code>doc_</code></li>
<li>Functions that deal with databases are prefixed with <code>db_</code></li>
<li>Simplified all code, reducing duplication</li>
<li>All functions take <code>cushion</code> as the first parameter, for consistency sake.</li>
<li>Changed <code>cushion()</code> function so that you can only register one cushion with each function call,
and the function takes parameters for each element now, <code>name</code> (name of the cushion, whatever you want), <code>user</code> (user name, if applicable), <code>pwd</code> (password, if applicable), <code>type</code> (one of localhost, cloudant, or iriscouch), and <code>port</code> (if applicable).</li>
<li>Changed package license from <code>CC0</code> to <code>MIT</code></li>
</ul>
<p>There&rsquo;s still more to do, but I&rsquo;m pretty happy with the recent changes, and I hope at least some find the package useful. Also, would love people to try it out as all bugs are shallow and all that&hellip;</p>
<p>The following are a few examples of package use.</p>
<h2 id="install-couchdb">Install CouchDB</h2>
<p>Instructions <a href="https://wiki.apache.org/couchdb/Installation">here</a></p>
<h2 id="start-couchdb">Start CouchDB</h2>
<p>In your terminal</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>couchdb
</span></span></code></pre></div><p>You can interact with your CouchDB databases as well in your browser. Navigate to <a href="http://localhost:5984/_utils">http://localhost:5984/_utils</a></p>
<h2 id="install-sofa">Install sofa</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;devtools&#34;</span>)
</span></span><span style="display:flex;"><span>devtools<span style="color:#f92672">::</span><span style="color:#a6e22e">install_github</span>(<span style="color:#e6db74">&#34;sckott/sofa&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#39;sofa&#39;</span>)
</span></span></code></pre></div><h2 id="authenticate---cushions">Authenticate - Cushions</h2>
<p>As an example, here&rsquo;s how I set up details for connecting to my Cloudant couch:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">cushion</span>(name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;cloudant&#39;</span>, user <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;user name&gt;&#39;</span>, pwd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;password&gt;&#39;</span>, type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;cloudant&#34;</span>)
</span></span></code></pre></div><p>By default there is a built-in <code>cushion</code> for localhost so you don&rsquo;t have to do that, unless you want to change those details, e.g., the port number. Right now cushions aren&rsquo;t preserved across R sessions, but working on that.</p>
<p>For example, I&rsquo;ll lay down a cushion for Cloudant, then I can call <code>cushions()</code> to see my cushions:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">cushion</span>(name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;cloudant&#39;</span>, user <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;user name&gt;&#39;</span>, pwd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;pwd&gt;&#39;</span>, type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;cloudant&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cushions</span>()
</span></span></code></pre></div><p>By default, if you don&rsquo;t provide a cushion name, you are using localhost.</p>
<h2 id="ping-the-server">Ping the server</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ping</span>()
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $couchdb</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Welcome&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $uuid</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;2c10f0c6d9bd17205b692ae93cd4cf1d&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $version</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;1.6.0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $vendor</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $vendor$version</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;1.6.0-1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $vendor$name</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Homebrew&#34;</span>
</span></span></code></pre></div><p>Nice, it&rsquo;s working.</p>
<h2 id="create-a-new-database-and-list-available-databases">Create a new database, and list available databases</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">db_create</span>(dbname<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sofadb&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $ok</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] TRUE</span>
</span></span></code></pre></div><p>see if its there now</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">db_list</span>()
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;  [1] &#34;_replicator&#34; &#34;_users&#34;      &#34;alm_couchdb&#34; &#34;cachecall&#34;   &#34;hello_earth&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;  [6] &#34;leothelion&#34;  &#34;mran&#34;        &#34;mydb&#34;        &#34;newdbs&#34;      &#34;sofadb&#34;</span>
</span></span></code></pre></div><h2 id="create-documents">Create documents</h2>
<p>Create a document WITH a name (uses PUT)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>doc1 <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{&#34;name&#34;:&#34;sofa&#34;,&#34;beer&#34;:&#34;IPA&#34;}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">doc_create</span>(dbname<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sofadb&#34;</span>, doc<span style="color:#f92672">=</span>doc1, docid<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;a_beer&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $ok</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;a_beer&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rev</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;1-a48c98c945bcc05d482bc6f938c89882&#34;</span>
</span></span></code></pre></div><p>Create a document WITHOUT a name (uses POST)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>doc2 <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{&#34;name&#34;:&#34;sofa&#34;,&#34;icecream&#34;:&#34;rocky road&#34;}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">doc_create</span>(dbname<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sofadb&#34;</span>, doc<span style="color:#f92672">=</span>doc2)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $ok</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;c5c5c332c25cf62cc584647a81006f6d&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rev</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;1-fd0da7fcb8d3afbfc5757d065c92362c&#34;</span>
</span></span></code></pre></div><h2 id="list-documents">List documents</h2>
<p>List them</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">alldocs</span>(dbname<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sofadb&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                                 id                              key</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1                           a_beer                           a_beer</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 c5c5c332c25cf62cc584647a81006f6d c5c5c332c25cf62cc584647a81006f6d</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                                  rev</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 1-a48c98c945bcc05d482bc6f938c89882</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 1-fd0da7fcb8d3afbfc5757d065c92362c</span>
</span></span></code></pre></div><p>Optionally include the documents, returned as a list by default as it would be hard to parse an endless number of document formats.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">alldocs</span>(dbname<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sofadb&#34;</span>, include_docs <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $total_rows</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $offset</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[1]]$id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;a_beer&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[1]]$key</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;a_beer&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[1]]$value</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[1]]$value$rev</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;1-a48c98c945bcc05d482bc6f938c89882&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[1]]$doc</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[1]]$doc$`_id`</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;a_beer&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[1]]$doc$`_rev`</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;1-a48c98c945bcc05d482bc6f938c89882&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[1]]$doc$name</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;sofa&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[1]]$doc$beer</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;IPA&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[2]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[2]]$id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;c5c5c332c25cf62cc584647a81006f6d&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[2]]$key</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;c5c5c332c25cf62cc584647a81006f6d&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[2]]$value</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[2]]$value$rev</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;1-fd0da7fcb8d3afbfc5757d065c92362c&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[2]]$doc</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[2]]$doc$`_id`</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;c5c5c332c25cf62cc584647a81006f6d&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[2]]$doc$`_rev`</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;1-fd0da7fcb8d3afbfc5757d065c92362c&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[2]]$doc$name</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;sofa&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rows[[2]]$doc$icecream</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;rocky road&#34;</span>
</span></span></code></pre></div><h2 id="update-a-document">Update a document</h2>
<p>Change <em>IPA</em> (india pale ale) to <em>IPL</em> (india pale lager). We need to get revisions first as we need to include revision number when we update a document.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>(revs <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">revisions</span>(dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sofadb&#34;</span>, docid <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;a_beer&#34;</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;1-a48c98c945bcc05d482bc6f938c89882&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>newdoc <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{&#34;name&#34;:&#34;sofa&#34;,&#34;beer&#34;:&#34;IPL&#34;}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">doc_update</span>(dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sofadb&#34;</span>, doc <span style="color:#f92672">=</span> newdoc, docid <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;a_beer&#34;</span>, rev <span style="color:#f92672">=</span> revs[1])
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $ok</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;a_beer&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $rev</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;2-f2390eb18b8f9a870c915c6712a7f65e&#34;</span>
</span></span></code></pre></div><p>Should be two revisions now</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">revisions</span>(dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sofadb&#34;</span>, docid <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;a_beer&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;2-f2390eb18b8f9a870c915c6712a7f65e&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [2] &#34;1-a48c98c945bcc05d482bc6f938c89882&#34;</span>
</span></span></code></pre></div><h2 id="get-headers-for-a-document">Get headers for a document</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">doc_head</span>(dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sofadb&#34;</span>, docid <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;a_beer&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[1]]$status</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 200</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[1]]$version</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;HTTP/1.1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[1]]$headers</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $server</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;CouchDB/1.6.0 (Erlang OTP/17)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $etag</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;\&#34;2-f2390eb18b8f9a870c915c6712a7f65e\&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $date</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Tue, 18 Nov 2014 21:19:16 GMT&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $`content-type`</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;application/json&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $`content-length`</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;88&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $`cache-control`</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;must-revalidate&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;insensitive&#34; &#34;list&#34;</span>
</span></span></code></pre></div><h2 id="json-vs-list">JSON vs. list</h2>
<p>Across all/most functions you can request json or list as output with the <code>as</code> parameter.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">db_list</span>(as <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;list&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;  [1] &#34;_replicator&#34; &#34;_users&#34;      &#34;alm_couchdb&#34; &#34;cachecall&#34;   &#34;hello_earth&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;  [6] &#34;leothelion&#34;  &#34;mran&#34;        &#34;mydb&#34;        &#34;newdbs&#34;      &#34;sofadb&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">db_list</span>(as <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;json&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;[\&#34;_replicator\&#34;,\&#34;_users\&#34;,\&#34;alm_couchdb\&#34;,\&#34;cachecall\&#34;,\&#34;hello_earth\&#34;,\&#34;leothelion\&#34;,\&#34;mran\&#34;,\&#34;mydb\&#34;,\&#34;newdbs\&#34;,\&#34;sofadb\&#34;]\n&#34;</span>
</span></span></code></pre></div><h2 id="curl-options">Curl options</h2>
<p>Across all functions you can pass in curl options. We&rsquo;re using <code>httr</code> internally, so you can use <code>httr</code> helper functions to make some curl options easier. Examples:</p>
<p>Verbose output</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;httr&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db_list</span>(config<span style="color:#f92672">=</span><span style="color:#a6e22e">verbose</span>())
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;  [1] &#34;_replicator&#34; &#34;_users&#34;      &#34;alm_couchdb&#34; &#34;cachecall&#34;   &#34;hello_earth&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;  [6] &#34;leothelion&#34;  &#34;mran&#34;        &#34;mydb&#34;        &#34;newdbs&#34;      &#34;sofadb&#34;</span>
</span></span></code></pre></div><p>Progress</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">db_list</span>(config<span style="color:#f92672">=</span><span style="color:#a6e22e">progress</span>())
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">|</span>                                                                       
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">|</span>                                                                 <span style="color:#f92672">|</span>   <span style="color:#ae81ff">0</span><span style="color:#f92672">%
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">  |                                                                       
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">  |=================================================================| 100%</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;  [1] &#34;_replicator&#34; &#34;_users&#34;      &#34;alm_couchdb&#34; &#34;cachecall&#34;   &#34;hello_earth&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;  [6] &#34;leothelion&#34;  &#34;mran&#34;        &#34;mydb&#34;        &#34;newdbs&#34;      &#34;sofadb&#34;</span>
</span></span></code></pre></div><p>Set a timeout</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">db_list</span>(config<span style="color:#f92672">=</span><span style="color:#a6e22e">timeout</span>(seconds <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.001</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Error in function (type, msg, asError = TRUE)  : </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;    Operation timed out after 3 milliseconds with 0 out of -1 bytes received</span>
</span></span></code></pre></div><h2 id="full-text-search">Full text search</h2>
<p>I&rsquo;m working on an R client for Elaticsearch called <code>elastic</code> - find it at <a href="https://github.com/ropensci/elastic">https://github.com/ropensci/elastic</a></p>
<p>Thinking about where to include functions to allow <code>elastic</code> and <code>sofa</code> to work together&hellip;if you have any thoughts hit up the issues. I&rsquo;ll probably include helper functions for CouchDB search in the <code>elastic</code> package, interfacing with the <a href="https://github.com/elasticsearch/elasticsearch-river-couchdb">CouchDB plugin for Elasticsearch</a>.</p>
]]></description>
    </item>
    <item>
      <title>Stashing and playing with raw data locally from the web</title>
      <link>http://localhost:1313/2013/06/couch/</link>
      <pubDate>Mon, 17 Jun 2013 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2013/06/couch/</guid>
      <description><![CDATA[<p>It is getting easier to get data directly into R from the web. Often R packages that retrieve data from the web return useful R data structures to users like a data.frame. This is a good thing of course to make things user friendly.</p>
<p>However, what if you want to drill down into the data that&rsquo;s returned from a query to a database in R?  What if you want to get that nice data.frame in R, but you think you may want to look at the raw data later? The raw data from web queries are often JSON or XML data. This type of data, especially JSON, can be easily stored in schemaless so-called NoSQL databases, and queried later.</p>
<p>A brief aside: What are JSON and XML? This is what JSON looks like (ps if you ever wonder if your JSON is correct, go <a href="http://jsonlint.com/">here</a>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;joe&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;hobby&#34;</span>: <span style="color:#e6db74">&#34;codemonkey&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;lives&#34;</span>: <span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;city&#34;</span>: <span style="color:#e6db74">&#34;San Jose&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;state&#34;</span>: <span style="color:#e6db74">&#34;CA&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>This is what XML looks like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;name&gt;</span>joe<span style="color:#f92672">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;hobby&gt;</span>codemonkey<span style="color:#f92672">&lt;/hobby&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;lives&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;city&gt;</span>San Jose<span style="color:#f92672">&lt;/city&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;state&gt;</span>CA<span style="color:#f92672">&lt;/state&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;/lives&gt;</span>
</span></span></code></pre></div><p>But don&rsquo;t worry if it looks complicated - the project I talk about below, sofa, tries to make the interface to JSON and XML easy. Web APIs almost always return either JSON or XML, so this is the raw data.</p>
<p>So here&rsquo;s the use case I imagine, or workflow:</p>
<ul>
<li>Query a database on the web, and choose to write the raw data to a local database.</li>
<li>Do whatever you want with the output R object - analyze, visualize, etc.</li>
<li>Now you want to go back and search through some of the raw data. But, that query took an hour. Since you wrote it to a local database, you can search the data.</li>
<li>If you hadn&rsquo;t written it locally, you would have to make a new web call.</li>
</ul>
<p>Note that if you are doing calls to web APIs that get small amounts of data you don&rsquo;t need to worry too much as you can easily just do the call again.</p>
<p>I&rsquo;ve started an R package to interact with the NoSQL database <a href="http://couchdb.apache.org/">CouchDB</a>. CouchDB is a schemaless database that speaks JSON, so you can store JSON and get back JSON (don&rsquo;t worry XML, we got you covered - we can just wrap the XML in JSON before putting it in CouchDB). What&rsquo;s especially cool is you can interact with CouchDB via <a href="http://docs.couchdb.org/en/latest/api-basics.html">a RESTful API</a>. CouchDB doesn&rsquo;t have full text search built in (though you can build map-reduce <em>Views</em>, basically preset queries on the database), so I added functions (and docs to help) to interact with the <a href="https://github.com/elasticsearch/elasticsearch-river-couchdb/blob/master/README.md">CouchDB River plugin</a> for <a href="http://www.elasticsearch.org/">Elasticsearch</a>, which provides powerful full text search via an API interface. But nevermind the tech details - all this just means you can search on the full text of your stored data.</p>
<p>There are plenty of databases you can interact with from R, so why CouchDB? For one, it makes a lot of sense to write to a NoSQL database since this blog post is dealing with a use case writing JSON, which isn&rsquo;t a good fit for databases like MySQL, SQLite, PostgreSQL, etc. (<a href="http://wiki.postgresql.org/wiki/What's_new_in_PostgreSQL_9.2#JSON_datatype">though postgres allows you to write JSON</a>). It didn&rsquo;t have to be CouchDB, but at least to me it seems relatively easy to install, you can interact with it via an HTTP API (if you&rsquo;re into that, which I am), and it has a nice web interface (navigate to <a href="http://localhost:5984/_utils/">http://localhost:5984/_utils/</a> after starting <code>couchdb</code>).</p>
<p>Is this for the casual R user? Probably not. But, I imagine there are R users out there that want some more flexibility when it comes to interacting with web data in R. It is nice and tidy to get back an R data.frame from a web call, but having the raw data at your fingertips could be super powerful. I&rsquo;ll describe using an R package to interact with a web database with <code>sofa</code> baked in, and discuss a bit about the functions within <code>sofa</code>.</p>
<h3 id="first-start-couchdb-in-your-terminal">First start CouchDB in your terminal</h3>
<p>You can do this from anywhere in your directory. See <a href="http://couchdb.apache.org/">here</a> for instructions on how to install CouchDB.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>couchdb
</span></span></code></pre></div><h3 id="then-start-elasticsearch-in-your-terminal">Then start elasticsearch in your terminal</h3>
<p>See <a href="https://github.com/sckott/sofa">here</a> for instructions on how to install Elasticsearch and the River CouchDB plugin.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd /usr/local/elasticsearch
</span></span><span style="display:flex;"><span>bin/elasticsearch -f
</span></span></code></pre></div><h3 id="install-sofa">Install sofa</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Uncomment these lines if you don&#39;t have these packages installed</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install.packages(&#39;devtools&#39;) library(devtools) install_github(&#39;sofa&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># &#39;schamberlain&#39;) install_github(&#39;alm&#39;, &#39;ropensci&#39;, ref=&#39;couch&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(sofa)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(alm)
</span></span></code></pre></div><h3 id="simultaneously-write-data-to-couchdb-along-with-api-calls-using-the-alm-package-to-get-altmetrics-data-on-plos-papers-ping-to-make-sure-couchdb-is-on">Simultaneously write data to CouchDB along with API calls using the alm package to get altmetrics data on PLoS papers. Ping to make sure CouchDB is on</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">sofa_ping</span>()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  couchdb   version 
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Welcome&#34;</span>   <span style="color:#e6db74">&#34;1.2.1&#34;</span> 
</span></span></code></pre></div><h3 id="create-a-new-database">Create a new database</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">sofa_createdb</span>(dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;alm_db&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  ok 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">TRUE</span> 
</span></span></code></pre></div><h3 id="write-couchdb-database-name-to-options">Write couchdb database name to options</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">options</span>(couch_db_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;alm_db&#34;</span>)
</span></span></code></pre></div><h3 id="list-the-databases">List the databases</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">sofa_listdbs</span>()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span> [1] <span style="color:#e6db74">&#34;_replicator&#34;</span>                <span style="color:#e6db74">&#34;_users&#34;</span>                    
</span></span><span style="display:flex;"><span> [3] <span style="color:#e6db74">&#34;alm_couchdb&#34;</span>                <span style="color:#e6db74">&#34;alm_db&#34;</span>                    
</span></span><span style="display:flex;"><span> [5] <span style="color:#e6db74">&#34;dudedb&#34;</span>                     <span style="color:#e6db74">&#34;example&#34;</span>                   
</span></span><span style="display:flex;"><span> [7] <span style="color:#e6db74">&#34;poop&#34;</span>                       <span style="color:#e6db74">&#34;rplos_db&#34;</span>                  
</span></span><span style="display:flex;"><span> [9] <span style="color:#e6db74">&#34;shit&#34;</span>                       <span style="color:#e6db74">&#34;shitty&#34;</span>                    
</span></span><span style="display:flex;"><span>[11] <span style="color:#e6db74">&#34;shitty2&#34;</span>                    <span style="color:#e6db74">&#34;test_suite_db&#34;</span>             
</span></span><span style="display:flex;"><span>[13] <span style="color:#e6db74">&#34;test_suite_db/with_slashes&#34;</span> <span style="color:#e6db74">&#34;test_suite_reports&#34;</span>        
</span></span><span style="display:flex;"><span>[15] <span style="color:#e6db74">&#34;testr2couch&#34;</span>                <span style="color:#e6db74">&#34;twitter_db&#34;</span>                
</span></span></code></pre></div><h3 id="search-for-altmetrics-normally-wo-writing-to-a-database">Search for altmetrics normally, w/o writing to a database</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(<span style="color:#a6e22e">alm</span>(doi <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.1371/journal.pone.0029797&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>          .id pdf html shares groups comments likes citations total
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   bloglines  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   citeulike  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>      <span style="color:#ae81ff">1</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>        <span style="color:#66d9ef">NA</span>     <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    connotea  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    crossref  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">6</span>     <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>      nature  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span> postgenomic  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h3 id="search-for-altmetrics-normally-while-writing-to-a-database">Search for altmetrics normally, while writing to a database</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(<span style="color:#a6e22e">alm</span>(doi <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.1371/journal.pone.0029797&#34;</span>, write2couch <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>          .id pdf html shares groups comments likes citations total
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   bloglines  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   citeulike  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>      <span style="color:#ae81ff">1</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>        <span style="color:#66d9ef">NA</span>     <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    connotea  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    crossref  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">6</span>     <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>      nature  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span> postgenomic  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h3 id="make-lots-of-calls-and-write-them-simultaneously">Make lots of calls, and write them simultaneously</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;rplos&#39;, &#39;ropensci&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(rplos)
</span></span><span style="display:flex;"><span>dois <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">searchplos</span>(terms <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;evolution&#34;</span>, fields <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;id&#34;</span>, limit <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">alm</span>(doi <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.character</span>(dois[, <span style="color:#ae81ff">1</span>]), write2couch <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">lapply</span>(out[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>], head)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>`01`
</span></span><span style="display:flex;"><span>          .id pdf html shares groups comments likes citations total
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   bloglines  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   citeulike  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>      <span style="color:#ae81ff">0</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>        <span style="color:#66d9ef">NA</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    connotea  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    crossref  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>      nature  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span> postgenomic  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>`02`
</span></span><span style="display:flex;"><span>          .id pdf html shares groups comments likes citations total
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   bloglines  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   citeulike  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>      <span style="color:#ae81ff">1</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>        <span style="color:#66d9ef">NA</span>     <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>    connotea  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    crossref  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>      nature  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span> postgenomic  <span style="color:#66d9ef">NA</span>   <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>     <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>    <span style="color:#66d9ef">NA</span>         <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h3 id="writing-data-to-couchdb-does-take-a-bit-longer">Writing data to CouchDB does take a bit longer</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">system.time</span>(<span style="color:#a6e22e">alm</span>(doi <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.character</span>(dois[, <span style="color:#ae81ff">1</span>])[1<span style="color:#f92672">:</span><span style="color:#ae81ff">60</span>], write2couch <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>   user  system elapsed 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">1.739</span>   <span style="color:#ae81ff">0.016</span>   <span style="color:#ae81ff">4.554</span> 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">system.time</span>(<span style="color:#a6e22e">alm</span>(doi <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.character</span>(dois[, <span style="color:#ae81ff">1</span>])[1<span style="color:#f92672">:</span><span style="color:#ae81ff">60</span>], write2couch <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>   user  system elapsed 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">3.579</span>   <span style="color:#ae81ff">0.062</span>   <span style="color:#ae81ff">6.460</span> 
</span></span></code></pre></div><h3 id="search-using-elasticsearch">Search using elasticsearch</h3>
<h4 id="tell-elasticsearch-to-start-indexing-your-database">tell elasticsearch to start indexing your database</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">elastic_start</span>(dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;alm_db&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>ok
</span></span><span style="display:flex;"><span>[1] <span style="color:#66d9ef">TRUE</span>
</span></span></code></pre></div><h4 id="search-your-database">Search your database</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">elastic_search</span>(dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;alm_db&#34;</span>, q <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;twitter&#34;</span>, parse_ <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>out<span style="color:#f92672">$</span>hits<span style="color:#f92672">$</span>total
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[1] <span style="color:#ae81ff">679</span>
</span></span></code></pre></div><h3 id="using-views">Using views</h3>
<h4 id="write-a-view---here-letting-key-be-the-default-of-null">Write a view - here letting key be the default of null</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">sofa_view_put</span>(dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;alm_db&#34;</span>, design_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;myview&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;doc.baseurl&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>ok
</span></span><span style="display:flex;"><span>[1] <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>id
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;_design/myview&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>rev
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;1-e7c17cff1b96e4595c3781da53e16ad8&#34;</span>
</span></span></code></pre></div><h4 id="get-info-on-your-new-view">Get info on your new view</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">sofa_view_get</span>(dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;alm_db&#34;</span>, design_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;myview&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>`_id`
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;_design/myview&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>`_rev`
</span></span><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;1-e7c17cff1b96e4595c3781da53e16ad8&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>views
</span></span><span style="display:flex;"><span><span style="color:#f92672">$</span>views<span style="color:#f92672">$</span>foo
</span></span><span style="display:flex;"><span>                                    map 
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;function(doc){emit(null,doc.baseurl)}&#34;</span> 
</span></span></code></pre></div><h4 id="get-data-using-a-view">Get data using a view</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sofa_view_search</span>(dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;alm_db&#34;</span>, design_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;myview&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">length</span>(out<span style="color:#f92672">$</span>rows)  <span style="color:#75715e"># 160 results</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[1] <span style="color:#ae81ff">161</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">sapply</span>(out<span style="color:#f92672">$</span>rows, <span style="color:#66d9ef">function</span>(x) x<span style="color:#f92672">$</span>value)[1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>]  <span style="color:#75715e"># the values, just the API call URLs</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;http://alm.plos.org/api/v3/articles&#34;</span>
</span></span><span style="display:flex;"><span>[2] <span style="color:#e6db74">&#34;http://alm.plos.org/api/v3/articles&#34;</span>
</span></span><span style="display:flex;"><span>[3] <span style="color:#e6db74">&#34;http://alm.plos.org/api/v3/articles&#34;</span>
</span></span><span style="display:flex;"><span>[4] <span style="color:#e6db74">&#34;http://alm.plos.org/api/v3/articles&#34;</span>
</span></span><span style="display:flex;"><span>[5] <span style="color:#e6db74">&#34;http://alm.plos.org/api/v3/articles&#34;</span>
</span></span></code></pre></div><h4 id="delete-the-view">Delete the view</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">sofa_view_del</span>(dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;alm_db&#34;</span>, design_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;myview&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;&#34;</span>
</span></span></code></pre></div><h2 id="what-now">What now?</h2>
<p>Well, if no one uses this, then probably nothing. Though, if people think this could be useful:</p>
<ul>
<li>It would be cool to make easy hooks into any package making web calls to allow users to write data to CouchDB if they choose to, sort of like the example above with rplos.</li>
<li>Perhaps automate some of the setup for CouchDB for users, making system calls so they don&rsquo;t have to.</li>
<li>Performance: As shown above, simultaneously writing data to CouchDB takes longer than not doing so - removing this time difference will make writing to couch more palatable.</li>
</ul>
<h2 id="what-do-you-think">What do you think?</h2>
<p>What is your reaction to this post?  Do you have a need for this sort of tool?  Do you have similar use cases that could be addressed with <code>sofa</code>?</p>
]]></description>
    </item>
  </channel>
</rss>
