<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Geojson on Recology</title>
    <link>http://localhost:1313/tags/geojson/</link>
    <description>Recent content in Geojson on Recology</description>
    <generator>Hugo -- 0.143.1</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 18 May 2015 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/geojson/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>lawn - a new package to do geospatial analysis</title>
      <link>http://localhost:1313/2015/05/mow-the-lawn/</link>
      <pubDate>Mon, 18 May 2015 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2015/05/mow-the-lawn/</guid>
      <description>&lt;p&gt;&lt;code&gt;lawn&lt;/code&gt; is an R wrapper for the Javascript library &lt;a href=&#34;http://turfjs.org/&#34;&gt;turf.js&lt;/a&gt; for advanced geospatial analysis. In addition, we have a few functions to interface with the &lt;a href=&#34;https://github.com/mapbox/geojson-random&#34;&gt;geojson-random&lt;/a&gt; Javascript library.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;lawn&lt;/code&gt; includes traditional spatial operations, helper functions for creating GeoJSON data, and data classification and statistics tools.&lt;/p&gt;
&lt;p&gt;There is an additional helper function (see &lt;code&gt;view()&lt;/code&gt;) in this package to help visualize data with interactive maps via the &lt;code&gt;leaflet&lt;/code&gt; package (&lt;a href=&#34;https://github.com/rstudio/leaflet&#34;&gt;https://github.com/rstudio/leaflet&lt;/a&gt;). Note that &lt;code&gt;leaflet&lt;/code&gt; is not required to install &lt;code&gt;lawn&lt;/code&gt; - it&amp;rsquo;s in Suggests, not Imports or Depends.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p><code>lawn</code> is an R wrapper for the Javascript library <a href="http://turfjs.org/">turf.js</a> for advanced geospatial analysis. In addition, we have a few functions to interface with the <a href="https://github.com/mapbox/geojson-random">geojson-random</a> Javascript library.</p>
<p><code>lawn</code> includes traditional spatial operations, helper functions for creating GeoJSON data, and data classification and statistics tools.</p>
<p>There is an additional helper function (see <code>view()</code>) in this package to help visualize data with interactive maps via the <code>leaflet</code> package (<a href="https://github.com/rstudio/leaflet">https://github.com/rstudio/leaflet</a>). Note that <code>leaflet</code> is not required to install <code>lawn</code> - it&rsquo;s in Suggests, not Imports or Depends.</p>
<p>Use cases for this package include (but not limited to, obs.) the following (all below assumes GeoJSON format):</p>
<ul>
<li>Create random spatial data.</li>
<li>Convert among spatial data types (e.g. <code>Polygon</code> to <code>FeatureCollection</code>)</li>
<li>Transform objects, including merging many, simplifying, calculating hulls, etc.</li>
<li>Measuring objects</li>
<li>Performing interpolation of objects</li>
<li>Aggregating data (aka properties) associated with objects</li>
</ul>
<h2 id="install">Install</h2>
<p>Stable <code>lawn</code> version from CRAN - this should fetch <code>leaflet</code>, which is not on CRAN, but in a <code>drat</code> repo (let me know if it doesn&rsquo;t)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;lawn&#34;</span>)
</span></span></code></pre></div><p>Or, the development version from Github</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>devtools<span style="color:#f92672">::</span><span style="color:#a6e22e">install_github</span>(<span style="color:#e6db74">&#34;ropensci/lawn&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;lawn&#34;</span>)
</span></span></code></pre></div><h2 id="view">view</h2>
<p><code>lawn</code> includes a tiny helper function for visualizing geojson. For examples below, we&rsquo;ll make liberal use of the <code>lawn::view()</code> function to visualize what it is the heck we&rsquo;re doing. mkay, lets roll&hellip;</p>
<p>We&rsquo;ve tried to make <code>view()</code> work with as many inputs as possible, from class <code>character</code> containing
json to the class <code>json</code> from the <code>jsonlite</code> package, to the class <code>list</code> to all of the GeoJSON outputs
from functions in <code>lawn</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">view</span>(lawn_data<span style="color:#f92672">$</span>points_average)
</span></span></code></pre></div><p><img alt="map1" loading="lazy" src="/2015-05-18-mow-the-lawn/map1.png"></p>
<p>Here, we sample at random two points from the same dataset just viewed.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_sample</span>(lawn_data<span style="color:#f92672">$</span>points_average, <span style="color:#ae81ff">2</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">view</span>()
</span></span></code></pre></div><p><img alt="map2" loading="lazy" src="/2015-05-18-mow-the-lawn/map2.png"></p>
<h2 id="make-some-geojson-data">Make some geojson data</h2>
<p>Point</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_point</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-74.5</span>, <span style="color:#ae81ff">40</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Feature&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Point&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry$coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] -74.5  40.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $properties</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; named list()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;point&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_point</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-74.5</span>, <span style="color:#ae81ff">40</span>)) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img alt="point" loading="lazy" src="/2015-05-18-mow-the-lawn/point.png"></p>
<p>Polygon</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>rings <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">list</span>(<span style="color:#a6e22e">list</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-2.275543</span>, <span style="color:#ae81ff">53.464547</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-2.275543</span>, <span style="color:#ae81ff">53.489271</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-2.215118</span>, <span style="color:#ae81ff">53.489271</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-2.215118</span>, <span style="color:#ae81ff">53.464547</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-2.275543</span>, <span style="color:#ae81ff">53.464547</span>)
</span></span><span style="display:flex;"><span>))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">lawn_polygon</span>(rings)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Feature&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Polygon&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry$coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; , , 1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1,] -2.275543 -2.275543 -2.215118 -2.215118 -2.275543</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; , , 2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1,] 53.46455 53.48927 53.48927 53.46455 53.46455</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $properties</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; named list()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;polygon&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_polygon</span>(rings) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img alt="polygon" loading="lazy" src="/2015-05-18-mow-the-lawn/polygon.png"></p>
<p>Random set of points</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_random</span>(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;      type geometry.type  geometry.coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 Feature         Point -137.46327, -63.46154</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 Feature         Point  -110.68426, 83.10533</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;featurecollection&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_random</span>(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img alt="rand1" loading="lazy" src="/2015-05-18-mow-the-lawn/lawn_random.png"></p>
<p>Or, use a different Javascript library (<a href="https://github.com/mapbox/geojson-random">geojson-random</a>) to create random features.</p>
<p>Positions</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gr_position</span>()
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] -179.77996   45.99018</span>
</span></span></code></pre></div><p>Points</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gr_point</span>(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;      type geometry.type geometry.coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 Feature         Point   5.83895, -27.77218</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 Feature         Point   78.50177, 14.95840</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;featurecollection&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gr_point</span>(<span style="color:#ae81ff">2</span>) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img alt="rand2" loading="lazy" src="/2015-05-18-mow-the-lawn/geojsonrandom_points.png"></p>
<p>Polygons</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gr_polygon</span>(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, vertices <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>, max_radial_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;      type geometry.type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 Feature       Polygon</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                                                                                                           geometry.coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 67.58827, 67.68551, 67.00091, 66.70156, 65.72578, 67.58827, -42.11340, -42.69850, -43.54866, -42.42758, -41.76731, -42.11340</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;featurecollection&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gr_polygon</span>(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, vertices <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>, max_radial_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img alt="rand3" loading="lazy" src="/2015-05-18-mow-the-lawn/geojsonrandom_polygons.png"></p>
<h2 id="count">count</h2>
<p>Count number of points within polygons, appends a new field to properties (see the <code>count</code> field)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_count</span>(polygons <span style="color:#f92672">=</span> lawn_data<span style="color:#f92672">$</span>polygons_count, points <span style="color:#f92672">=</span> lawn_data<span style="color:#f92672">$</span>points_count)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;      type pt_count geometry.type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 Feature        2       Polygon</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 Feature        0       Polygon</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                                                                                           geometry.coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 -112.07239, -112.07239, -112.02810, -112.02810, -112.07239, 46.58659, 46.61761, 46.61761, 46.58659, 46.58659</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 -112.02398, -112.02398, -111.96613, -111.96613, -112.02398, 46.57043, 46.61502, 46.61502, 46.57043, 46.57043</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;featurecollection&#34;</span>
</span></span></code></pre></div><h2 id="distance">distance</h2>
<p>Define two points</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>from <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;properties&#34;: {},
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;type&#34;: &#34;Point&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;coordinates&#34;: [-75.343, 39.984]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span>to <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;properties&#34;: {},
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;type&#34;: &#34;Point&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;coordinates&#34;: [-75.534, 39.123]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span></code></pre></div><p>Calculate distance, default units is kilometers (default output: <code>km</code>)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_distance</span>(from, to)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 97.15958</span>
</span></span></code></pre></div><h2 id="sample-from-a-featurecollection">sample from a FeatureCollection</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> lawn_data<span style="color:#f92672">$</span>points_average
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cat</span>(dat)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; {</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;   &#34;type&#34;: &#34;FeatureCollection&#34;,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;   &#34;features&#34;: [</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;     {</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;       &#34;type&#34;: &#34;Feature&#34;,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;       &#34;properties&#34;: {</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;         &#34;population&#34;: 200</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;       },</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;       &#34;geometry&#34;: {</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;         &#34;type&#34;: &#34;Point&#34;,</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">...</span>
</span></span></code></pre></div><p>Sample 2 points at random</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_sample</span>(dat, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;      type population geometry.type geometry.coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 Feature        200         Point   10.80643, 59.90891</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 Feature        600         Point   10.71579, 59.90478</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;featurecollection&#34;</span>
</span></span></code></pre></div><h2 id="extent">extent</h2>
<p>Calculates the extent of all input features in a FeatureCollection, and returns a bounding box.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_extent</span>(lawn_data<span style="color:#f92672">$</span>points_average)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 10.71579 59.90478 10.80643 59.93162</span>
</span></span></code></pre></div><h2 id="buffer">buffer</h2>
<p>Calculates a buffer for input features for a given radius.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;properties&#34;: {},
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     &#34;type&#34;: &#34;Polygon&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     &#34;coordinates&#34;: [[
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       [-112.072391,46.586591],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       [-112.072391,46.61761],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       [-112.028102,46.61761],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       [-112.028102,46.586591],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       [-112.072391,46.586591]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     ]]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">view</span>(dat)
</span></span></code></pre></div><p><img alt="buffer1" loading="lazy" src="/2015-05-18-mow-the-lawn/buffer1.png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_buffer</span>(dat, <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;miles&#34;</span>) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img alt="buffer2" loading="lazy" src="/2015-05-18-mow-the-lawn/buffer2.png"></p>
<h2 id="union-polygons-together">Union polygons together</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>poly1 <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;properties&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;fill&#34;: &#34;#0f0&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;type&#34;: &#34;Polygon&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;coordinates&#34;: [[
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.801742, 45.48565],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.801742, 45.60491],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.584762, 45.60491],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.584762, 45.48565],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.801742, 45.48565]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ]]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>poly2 <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;properties&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;fill&#34;: &#34;#00f&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;type&#34;: &#34;Polygon&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;coordinates&#34;: [[
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.520217, 45.535693],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.64038, 45.553967],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.720031, 45.526554],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.669906, 45.507309],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.723464, 45.446643],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.532577, 45.408574],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.487258, 45.477466],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.520217, 45.535693]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     ]]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">view</span>(poly1)
</span></span></code></pre></div><p><img alt="union1" loading="lazy" src="/2015-05-18-mow-the-lawn/union1.png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">view</span>(poly2)
</span></span></code></pre></div><p><img alt="union2" loading="lazy" src="/2015-05-18-mow-the-lawn/union2.png"></p>
<p>Visualize union-ed polygons</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_union</span>(poly1, poly2) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img alt="union3" loading="lazy" src="/2015-05-18-mow-the-lawn/union3.png"></p>
<p>See also <code>lawn_merge()</code> and <code>lawn_intersect()</code>.</p>
<h2 id="lint-input-geojson">lint input geojson</h2>
<p>For most functions, you can lint your input geojson data to make sure it is proper geojson. We use
the javascript library <a href="https://github.com/mapbox/geojsonhint">geojsonhint</a>. See the <code>lint</code> parameter.</p>
<p>Good GeoJSON</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;type&#34;: &#34;FeatureCollection&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;features&#34;: [
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;properties&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;population&#34;: 200
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;type&#34;: &#34;Point&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;coordinates&#34;: [10.724029, 59.926807]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  ]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">lawn_extent</span>(dat)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 10.72403 59.92681 10.72403 59.92681</span>
</span></span></code></pre></div><p>Bad GeoJSON</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;type&#34;: &#34;FeatureCollection&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;features&#34;: [
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;properties&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;population&#34;: 200
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;type&#34;: &#34;Point&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  ]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">lawn_extent</span>(dat, lint <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Error: Line 1 - &#34;coordinates&#34; property required</span>
</span></span></code></pre></div><h2 id="to-do">To do</h2>
<ul>
<li>As Turf.js changes, we&rsquo;ll update <code>lawn</code></li>
<li>Performance improvements. We realize that this package is slower than the C based <code>rgdal</code>/<code>rgeos</code> - we are looking into ways to increaes performance to get closer to the performance of those packages.</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>geojsonio - a new package to do geojson things</title>
      <link>http://localhost:1313/2015/04/geojson-io/</link>
      <pubDate>Thu, 30 Apr 2015 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2015/04/geojson-io/</guid>
      <description>&lt;p&gt;&lt;code&gt;geojsonio&lt;/code&gt; converts geographic data to GeoJSON and TopoJSON formats - though the focus is mostly on GeoJSON&lt;/p&gt;
&lt;p&gt;For those not familiar GeoJSON it is a format for encoding a variety of geographic data structures. GeoJSON supports the following geometry types: Point, LineString, Polygon, MultiPoint, MultiLineString, MultiPolygon, and GeometryCollection. These geometry types are also found in &lt;a href=&#34;https://en.wikipedia.org/wiki/Well-known_text&#34;&gt;well known text (WKT)&lt;/a&gt;, and have equivalents in R&amp;rsquo;s spatial classes. Read the &lt;a href=&#34;https://geojson.org/geojson-spec.html&#34;&gt;spec&lt;/a&gt; for more detailed information.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p><code>geojsonio</code> converts geographic data to GeoJSON and TopoJSON formats - though the focus is mostly on GeoJSON</p>
<p>For those not familiar GeoJSON it is a format for encoding a variety of geographic data structures. GeoJSON supports the following geometry types: Point, LineString, Polygon, MultiPoint, MultiLineString, MultiPolygon, and GeometryCollection. These geometry types are also found in <a href="https://en.wikipedia.org/wiki/Well-known_text">well known text (WKT)</a>, and have equivalents in R&rsquo;s spatial classes. Read the <a href="https://geojson.org/geojson-spec.html">spec</a> for more detailed information.</p>
<p>Other great geojson resources:</p>
<ul>
<li>GeoJSON lint - lint your geojson - <a href="https://geojsonlint.com/">https://geojsonlint.com/</a></li>
<li>GeoJSON.io - make maps with geojson input or draw maps and get geojson - <a href="https://geojson.io/">https://geojson.io/</a></li>
</ul>
<p>Functions in this package are organized first around what you&rsquo;re working with or want to get, geojson or topojson, then convert to or read from various formats:</p>
<ul>
<li><code>geojson_list()</code> - convert to GeoJSON as R list format</li>
<li><code>geojson_json()</code> - convert to GeoJSON as json</li>
<li><code>geojson_read()</code>/<code>topojson_read()</code> - read a GeoJSON/TopoJSON file from file path or URL</li>
<li><code>geojson_write()</code> - write a GeoJSON file locally (no write TopoJSON yet)</li>
</ul>
<p>Each of the above functions have methods for various objects/classes, including <code>numeric</code>, <code>data.frame</code>, <code>list</code>, <code>SpatialPolygons</code>, <code>SpatialLines</code>, <code>SpatialPoints</code>, etc. (including the classes in <code>rgeos</code>)</p>
<p>Use cases for this package include (but not limited to, obs.) the following:</p>
<ul>
<li>Get data in GeoJSON json format, and you want to get it into a list in R.</li>
<li>Get data into GeoJSON format to use downstream to make a interactive map
<ul>
<li>in R (e.g., with <a href="https://github.com/rstudio/leaflet">leaflet</a>)</li>
<li>or in another context (e.g., using javascript with mapbox/leaflet)</li>
</ul>
</li>
<li>Data is in a data.frame/matrix/list and you want to make GeoJSON format data.</li>
<li>Data is in one of the many spatial classes (e.g., <code>SpatialPoints</code>) and you want GeoJSON</li>
<li>You need to add styling to your data - can do with this package for certain data types.</li>
<li>You want to check that your GeoJSON data is valid - two ways to do it in geojsonio.</li>
<li>Combine objects together (e.g., a point and a line), either from two <code>geo_list</code> objects, or two <code>json</code> objects. See <code>?geojson-add</code></li>
</ul>
<h2 id="install">Install</h2>
<p>See the github repo for notes about dependencies <a href="https://github.com/ropensci/geojsonio#install">https://github.com/ropensci/geojsonio#install</a></p>
<p>CRAN version or the dev version from GitHub</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;geojsonio&#34;</span>)
</span></span><span style="display:flex;"><span>devtools<span style="color:#f92672">::</span><span style="color:#a6e22e">install_github</span>(<span style="color:#e6db74">&#34;sckott/geojsonio&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;geojsonio&#34;</span>)
</span></span></code></pre></div><h2 id="geojson">GeoJSON</h2>
<h3 id="convert-various-formats-to-geojson">Convert various formats to geojson</h3>
<p>From a <code>numeric</code> vector of length 2</p>
<p>as <em>json</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_json</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">32.45</span>, <span style="color:#ae81ff">-99.74</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; {&#34;type&#34;:&#34;FeatureCollection&#34;,&#34;features&#34;:[{&#34;type&#34;:&#34;Feature&#34;,&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[32.45,-99.74]},&#34;properties&#34;:{}}]}</span>
</span></span></code></pre></div><p>as a <strong>list</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_list</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">32.45</span>, <span style="color:#ae81ff">-99.74</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Feature&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$geometry</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$geometry$type</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">...</span>
</span></span></code></pre></div><p>From a <code>data.frame</code></p>
<p>as <strong>json</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_json</span>(us_cities[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>, ], lat <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;lat&#39;</span>, lon <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;long&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; {&#34;type&#34;:&#34;FeatureCollection&#34;,&#34;features&#34;:[{&#34;type&#34;:&#34;Feature&#34;,&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[-99.74,32.45]},&#34;properties&#34;:{&#34;name&#34;:&#34;Abilene TX&#34;,&#34;country.etc&#34;:&#34;TX&#34;,&#34;pop&#34;:&#34;113888&#34;,&#34;capital&#34;:&#34;0&#34;}},{&#34;type&#34;:&#34;Feature&#34;,&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[-81.52,41.08]},&#34;properties&#34;:{&#34;name&#34;:&#34;Akron OH&#34;,&#34;country.etc&#34;:&#34;OH&#34;,&#34;pop&#34;:&#34;206634&#34;,&#34;capital&#34;:&#34;0&#34;}}]}</span>
</span></span></code></pre></div><p>as a <strong>list</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_list</span>(us_cities[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>, ], lat <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;lat&#39;</span>, lon <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;long&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Feature&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$geometry</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$geometry$type</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">...</span>
</span></span></code></pre></div><p>From <code>SpatialPolygons</code> class</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#39;sp&#39;</span>)
</span></span><span style="display:flex;"><span>poly1 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">Polygons</span>(<span style="color:#a6e22e">list</span>(<span style="color:#a6e22e">Polygon</span>(<span style="color:#a6e22e">cbind</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-100</span>, <span style="color:#ae81ff">-90</span>, <span style="color:#ae81ff">-85</span>, <span style="color:#ae81ff">-100</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">40</span>)))), <span style="color:#e6db74">&#34;1&#34;</span>)
</span></span><span style="display:flex;"><span>poly2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">Polygons</span>(<span style="color:#a6e22e">list</span>(<span style="color:#a6e22e">Polygon</span>(<span style="color:#a6e22e">cbind</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-90</span>, <span style="color:#ae81ff">-80</span>, <span style="color:#ae81ff">-75</span>, <span style="color:#ae81ff">-90</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">30</span>)))), <span style="color:#e6db74">&#34;2&#34;</span>)
</span></span><span style="display:flex;"><span>(sp_poly <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">SpatialPolygons</span>(<span style="color:#a6e22e">list</span>(poly1, poly2), <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; An object of class &#34;SpatialPolygons&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Slot &#34;polygons&#34;:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; An object of class &#34;Polygons&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Slot &#34;Polygons&#34;:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; An object of class &#34;Polygon&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Slot &#34;labpt&#34;:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] -91.66667  45.00000</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">...</span>
</span></span></code></pre></div><p>to <strong>json</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_json</span>(sp_poly)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; {&#34;type&#34;:&#34;FeatureCollection&#34;,&#34;features&#34;:[{&#34;type&#34;:&#34;Feature&#34;,&#34;id&#34;:1,&#34;properties&#34;:{&#34;dummy&#34;:0},&#34;geometry&#34;:{&#34;type&#34;:&#34;Polygon&#34;,&#34;coordinates&#34;:[[[-100,40],[-90,50],[-85,45],[-100,40]]]}},{&#34;type&#34;:&#34;Feature&#34;,&#34;id&#34;:2,&#34;properties&#34;:{&#34;dummy&#34;:0},&#34;geometry&#34;:{&#34;type&#34;:&#34;Polygon&#34;,&#34;coordinates&#34;:[[[-90,30],[-80,40],[-75,35],[-90,30]]]}}]}</span>
</span></span></code></pre></div><p>to a <strong>list</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_list</span>(sp_poly)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Feature&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">...</span>
</span></span></code></pre></div><p>From <code>SpatialPoints</code> class</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>x <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>(s <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">SpatialPoints</span>(<span style="color:#a6e22e">cbind</span>(x, y)))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; SpatialPoints:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;      x y</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1,] 1 3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [2,] 2 2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [3,] 3 5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [4,] 4 1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [5,] 5 4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Coordinate Reference System (CRS) arguments: NA</span>
</span></span></code></pre></div><p>to <strong>json</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_json</span>(s)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; {&#34;type&#34;:&#34;FeatureCollection&#34;,&#34;features&#34;:[{&#34;type&#34;:&#34;Feature&#34;,&#34;id&#34;:1,&#34;properties&#34;:{&#34;dat&#34;:1},&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[1,3]}},{&#34;type&#34;:&#34;Feature&#34;,&#34;id&#34;:2,&#34;properties&#34;:{&#34;dat&#34;:2},&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[2,2]}},{&#34;type&#34;:&#34;Feature&#34;,&#34;id&#34;:3,&#34;properties&#34;:{&#34;dat&#34;:3},&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[3,5]}},{&#34;type&#34;:&#34;Feature&#34;,&#34;id&#34;:4,&#34;properties&#34;:{&#34;dat&#34;:4},&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[4,1]}},{&#34;type&#34;:&#34;Feature&#34;,&#34;id&#34;:5,&#34;properties&#34;:{&#34;dat&#34;:5},&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[5,4]}}]}</span>
</span></span></code></pre></div><p>to a <strong>list</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_list</span>(s)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Feature&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$id</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">...</span>
</span></span></code></pre></div><h3 id="combine-objects">Combine objects</h3>
<p><code>geo_list</code> + <code>geo_list</code></p>
<blockquote>
<p>Note: <code>geo_list</code> is the output type from <code>geojson_list()</code>, it&rsquo;s just a list with a class attached so we know it&rsquo;s geojson :)</p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>vec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-99.74</span>, <span style="color:#ae81ff">32.45</span>)
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">geojson_list</span>(vec)
</span></span><span style="display:flex;"><span>vecs <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">list</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">100.0</span>, <span style="color:#ae81ff">0.0</span>), <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">101.0</span>, <span style="color:#ae81ff">0.0</span>), <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">100.0</span>, <span style="color:#ae81ff">0.0</span>))
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">geojson_list</span>(vecs, geometry <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;polygon&#34;</span>)
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">+</span> b
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Feature&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$geometry</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$geometry$type</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">...</span>
</span></span></code></pre></div><p><code>json</code> + <code>json</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>c <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">geojson_json</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-99.74</span>, <span style="color:#ae81ff">32.45</span>))
</span></span><span style="display:flex;"><span>vecs <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">list</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">100.0</span>, <span style="color:#ae81ff">0.0</span>), <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">101.0</span>, <span style="color:#ae81ff">0.0</span>), <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">101.0</span>, <span style="color:#ae81ff">1.0</span>), <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">100.0</span>, <span style="color:#ae81ff">1.0</span>), <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">100.0</span>, <span style="color:#ae81ff">0.0</span>))
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">geojson_json</span>(vecs, geometry <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;polygon&#34;</span>)
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">+</span> d
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; {&#34;type&#34;:&#34;FeatureCollection&#34;,&#34;features&#34;:[{&#34;type&#34;:&#34;Feature&#34;,&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[-99.74,32.45]},&#34;properties&#34;:{}},{&#34;type&#34;:&#34;Feature&#34;,&#34;geometry&#34;:{&#34;type&#34;:&#34;Polygon&#34;,&#34;coordinates&#34;:[[[100,0],[101,0],[101,1],[100,1],[100,0]]]},&#34;properties&#34;:[]}]}</span>
</span></span></code></pre></div><h3 id="write-geojson">Write geojson</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_write</span>(us_cities[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>, ], lat <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;lat&#39;</span>, lon <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;long&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; &lt;geojson&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;   Path:       myfile.geojson</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;   From class: data.frame</span>
</span></span></code></pre></div><h2 id="topojson">Topojson</h2>
<p>In the current version of this package you can read topojson. Writing topojson was in this package, but is gone for now - will come back later as in interface to <a href="https://github.com/mbostock/topojson">topojson</a> via <a href="https://github.com/jeroenooms/V8">V8</a>.</p>
<p>Read from a file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>file <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">system.file</span>(<span style="color:#e6db74">&#34;examples&#34;</span>, <span style="color:#e6db74">&#34;us_states.topojson&#34;</span>, package <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;geojsonio&#34;</span>)
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">topojson_read</span>(file)
</span></span></code></pre></div><p>Read from a URL</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>url <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;https://raw.githubusercontent.com/shawnbot/d3-cartogram/master/data/us-states.topojson&#34;</span>
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">topojson_read</span>(url)
</span></span></code></pre></div><h2 id="lint-geojson">Lint geojson</h2>
<p>There are two ways to do this in this package.</p>
<h3 id="lint-locally">lint, locally</h3>
<p>Uses the javascript library <a href="https://github.com/mapbox/geojsonhint">geojsonhint</a> from Mapbox. We&rsquo;re running this locally via the <a href="https://cran.rstudio.com/web/packages/V8/">V8</a> package.</p>
<p>Good</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lint</span>(<span style="color:#e6db74">&#39;{&#34;type&#34;: &#34;Point&#34;, &#34;coordinates&#34;: [-100, 80]}&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;valid&#34;</span>
</span></span></code></pre></div><p>Bad</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lint</span>(<span style="color:#e6db74">&#39;{&#34;type&#34;: &#34;Rhombus&#34;, &#34;coordinates&#34;: [[1, 2], [3, 4], [5, 6]]}&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $message</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;The type Rhombus is unknown&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $line</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 1</span>
</span></span></code></pre></div><h3 id="validate-with-a-web-service">validate, with a web service</h3>
<p>Uses the web service at <a href="https://geojsonlint.com/">https://geojsonlint.com/</a></p>
<p>Good</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">validate</span>(<span style="color:#e6db74">&#39;{&#34;type&#34;: &#34;Point&#34;, &#34;coordinates&#34;: [-100, 80]}&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $status</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;ok&#34;</span>
</span></span></code></pre></div><p>Bad</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">validate</span>(<span style="color:#e6db74">&#39;{&#34;type&#34;: &#34;Rhombus&#34;, &#34;coordinates&#34;: [[1, 2], [3, 4], [5, 6]]}&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $message</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;\&#34;Rhombus\&#34; is not a valid GeoJSON type.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $status</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;error&#34;</span>
</span></span></code></pre></div><h2 id="to-do">To do</h2>
<ul>
<li>I&rsquo;d like to replace <code>rgdal</code> with javascript libraries to read from various file types (kml, shp, etc.) and convert to geojson. This is <a href="https://github.com/ropensci/geojsonio/tree/js">in development</a>, and will come in the next version of this package most likely. This should make installation a bit easier as we won&rsquo;t have to depend on <code>rgdal</code> and <code>GDAL</code></li>
<li>Performance improvements. Some operations already use the gdal or geos C libraries, so are quite fast, though the round trip to disk and back does take significant time. I&rsquo;d like to speed this up.</li>
<li>More input types. We already have operations (json, list, etc.) for lots of input types (data.frame, list, sp classes), but likely there will be more added.</li>
<li>Most likely add functions <code>topojson_list()</code>, <code>topojson_json()</code></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>R I/O for geojson and topojson</title>
      <link>http://localhost:1313/2015/01/geojson-topojson-io/</link>
      <pubDate>Tue, 06 Jan 2015 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2015/01/geojson-topojson-io/</guid>
      <description>&lt;p&gt;At rOpenSci we&amp;rsquo;ve been working on an R package (&lt;code&gt;geojsonio&lt;/code&gt;) to make converting R data in various formats to &lt;a href=&#34;https://geojson.org/geojson-spec.html&#34;&gt;geoJSON&lt;/a&gt; and &lt;a href=&#34;https://github.com/topojson/topojson-specification/blob/master/README.md&#34;&gt;topoJSON&lt;/a&gt;, and vice versa. We hope to do this one job very well, and handle all reasonable use cases.&lt;/p&gt;
&lt;p&gt;Functions in this package are organized first around what you&amp;rsquo;re working with or want to get, &lt;code&gt;geojson&lt;/code&gt; or &lt;code&gt;topojson&lt;/code&gt;, then convert to or read from various formats:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;geojson_list()&lt;/code&gt;/&lt;code&gt;topojson_list()&lt;/code&gt; - convert to geojson/topojson as R list format&lt;/li&gt;
&lt;li&gt;&lt;code&gt;geojson_json()&lt;/code&gt;/&lt;code&gt;topojson_json()&lt;/code&gt; - convert to geojson/topojson as json&lt;/li&gt;
&lt;li&gt;&lt;code&gt;geojson_read()``topojson_read()&lt;/code&gt; - read a geojson/topojson file from file path or URL&lt;/li&gt;
&lt;li&gt;&lt;code&gt;geojson_write()&lt;/code&gt;/&lt;code&gt;topojson_write()&lt;/code&gt; - write a geojson/topojson file locally&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Each of the above functions have methods for various objects/classes, including &lt;code&gt;numeric&lt;/code&gt;, &lt;code&gt;data.frame&lt;/code&gt;, &lt;code&gt;list&lt;/code&gt;, &lt;code&gt;SpatialPolygons&lt;/code&gt;, &lt;code&gt;SpatialPolygonsDataFrame&lt;/code&gt;, &lt;code&gt;SpatialLines&lt;/code&gt;, &lt;code&gt;SpatialLinesDataFrame&lt;/code&gt;, &lt;code&gt;SpatialPoints&lt;/code&gt;, &lt;code&gt;SpatialPointsDataFrame&lt;/code&gt;.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>At rOpenSci we&rsquo;ve been working on an R package (<code>geojsonio</code>) to make converting R data in various formats to <a href="https://geojson.org/geojson-spec.html">geoJSON</a> and <a href="https://github.com/topojson/topojson-specification/blob/master/README.md">topoJSON</a>, and vice versa. We hope to do this one job very well, and handle all reasonable use cases.</p>
<p>Functions in this package are organized first around what you&rsquo;re working with or want to get, <code>geojson</code> or <code>topojson</code>, then convert to or read from various formats:</p>
<ul>
<li><code>geojson_list()</code>/<code>topojson_list()</code> - convert to geojson/topojson as R list format</li>
<li><code>geojson_json()</code>/<code>topojson_json()</code> - convert to geojson/topojson as json</li>
<li><code>geojson_read()``topojson_read()</code> - read a geojson/topojson file from file path or URL</li>
<li><code>geojson_write()</code>/<code>topojson_write()</code> - write a geojson/topojson file locally</li>
</ul>
<p>Each of the above functions have methods for various objects/classes, including <code>numeric</code>, <code>data.frame</code>, <code>list</code>, <code>SpatialPolygons</code>, <code>SpatialPolygonsDataFrame</code>, <code>SpatialLines</code>, <code>SpatialLinesDataFrame</code>, <code>SpatialPoints</code>, <code>SpatialPointsDataFrame</code>.</p>
<h2 id="install">Install</h2>
<p>Install rgdal - in case you can&rsquo;t get it installed from binary , here&rsquo;s what works on a Mac.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;https://cran.r-project.org/src/contrib/rgdal_0.9-1.tar.gz&#34;</span>, repos <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>, type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;source&#34;</span>, configure.args <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;--with-gdal-config=/Library/Frameworks/GDAL.framework/Versions/1.10/unix/bin/gdal-config --with-proj-include=/Library/Frameworks/PROJ.framework/unix/include --with-proj-lib=/Library/Frameworks/PROJ.framework/unix/lib&#34;</span>)
</span></span></code></pre></div><p>Install <code>geojsonio</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;devtools&#34;</span>)
</span></span><span style="display:flex;"><span>devtools<span style="color:#f92672">::</span><span style="color:#a6e22e">install_github</span>(<span style="color:#e6db74">&#34;ropensci/geojsonio&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;geojsonio&#34;</span>)
</span></span></code></pre></div><h2 id="geojson">GeoJSON</h2>
<h3 id="convert-various-formats-to-geojson">Convert various formats to geojson</h3>
<p>From a <code>numeric</code> vector of length 2, as json or list</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_json</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">32.45</span>,<span style="color:#ae81ff">-99.74</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; {&#34;type&#34;:&#34;Point&#34;,&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[32.45,-99.74]},&#34;properties&#34;:{}}</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">geojson_list</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">32.45</span>,<span style="color:#ae81ff">-99.74</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Point&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Point&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry$coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1]  32.45 -99.74</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $properties</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; NULL</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;geo_list&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;from&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;numeric&#34;</span>
</span></span></code></pre></div><p>From a <code>data.frame</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#39;maps&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">data</span>(us.cities)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">geojson_json</span>(us.cities[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>,], lat<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lat&#39;</span>, lon<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;long&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; {&#34;type&#34;:&#34;FeatureCollection&#34;,&#34;features&#34;:[{&#34;type&#34;:&#34;Feature&#34;,&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[-99.74,32.45]},&#34;properties&#34;:{&#34;name&#34;:&#34;Abilene TX&#34;,&#34;country.etc&#34;:&#34;TX&#34;,&#34;pop&#34;:&#34;113888&#34;,&#34;capital&#34;:&#34;0&#34;}},{&#34;type&#34;:&#34;Feature&#34;,&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[-81.52,41.08]},&#34;properties&#34;:{&#34;name&#34;:&#34;Akron OH&#34;,&#34;country.etc&#34;:&#34;OH&#34;,&#34;pop&#34;:&#34;206634&#34;,&#34;capital&#34;:&#34;0&#34;}}]}</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">geojson_list</span>(us.cities[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>,], lat<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lat&#39;</span>, lon<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;long&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Feature&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$geometry</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$geometry$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Point&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$geometry$coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] -99.74  32.45</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$properties</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$properties$name</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Abilene TX&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$properties$country.etc</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;TX&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$properties$pop</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;113888&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[1]]$properties$capital</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[2]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[2]]$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Feature&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[2]]$geometry</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[2]]$geometry$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Point&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[2]]$geometry$coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] -81.52  41.08</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[2]]$properties</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[2]]$properties$name</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Akron OH&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[2]]$properties$country.etc</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;OH&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[2]]$properties$pop</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;206634&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features[[2]]$properties$capital</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;geo_list&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;from&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;data.frame&#34;</span>
</span></span></code></pre></div><p>From <code>SpatialPolygons</code> class</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#39;sp&#39;</span>)
</span></span><span style="display:flex;"><span>poly1 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">Polygons</span>(<span style="color:#a6e22e">list</span>(<span style="color:#a6e22e">Polygon</span>(<span style="color:#a6e22e">cbind</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-100</span>,<span style="color:#ae81ff">-90</span>,<span style="color:#ae81ff">-85</span>,<span style="color:#ae81ff">-100</span>),
</span></span><span style="display:flex;"><span>                                     <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">40</span>)))), <span style="color:#e6db74">&#34;1&#34;</span>)
</span></span><span style="display:flex;"><span>poly2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">Polygons</span>(<span style="color:#a6e22e">list</span>(<span style="color:#a6e22e">Polygon</span>(<span style="color:#a6e22e">cbind</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-90</span>,<span style="color:#ae81ff">-80</span>,<span style="color:#ae81ff">-75</span>,<span style="color:#ae81ff">-90</span>),
</span></span><span style="display:flex;"><span>                                     <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">35</span>,<span style="color:#ae81ff">30</span>)))), <span style="color:#e6db74">&#34;2&#34;</span>)
</span></span><span style="display:flex;"><span>sp_poly <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">SpatialPolygons</span>(<span style="color:#a6e22e">list</span>(poly1, poly2), <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>)
</span></span></code></pre></div><p>to json</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_json</span>(sp_poly)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; {&#34;type&#34;:&#34;Polygon&#34;,&#34;bbox&#34;:[-100,-75,30,50],&#34;coordinates&#34;:[[[-100,40],[-90,50],[-85,45],[-100,40]],[[-90,30],[-80,40],[-75,35],[-90,30]]],&#34;properties&#34;:{}}</span>
</span></span></code></pre></div><p>to list</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">geojson_list</span>(sp_poly)<span style="color:#f92672">$</span>coordinates[[1]]
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[1]][[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] -100</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[1]][[2]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 40</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[2]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[2]][[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] -90</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[2]][[2]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 50</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[3]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[3]][[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] -85</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[3]][[2]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 45</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[4]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[4]][[1]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] -100</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [[4]][[2]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 40</span>
</span></span></code></pre></div><h3 id="write-geojson">Write geojson</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#39;maps&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">data</span>(us.cities)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">geojson_write</span>(us.cities[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>,], lat<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lat&#39;</span>, lon<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;long&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; &lt;geojson&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;   Path:       myfile.geojson</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;   From class: data.frame</span>
</span></span></code></pre></div><h3 id="read-geojson">Read geojson</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>file <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">system.file</span>(<span style="color:#e6db74">&#34;examples&#34;</span>, <span style="color:#e6db74">&#34;california.geojson&#34;</span>, package <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;geojsonio&#34;</span>)
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">geojson_read</span>(file)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; OGR data source with driver: GeoJSON </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Source: &#34;/Users/sacmac/Library/R/3.1/library/geojsonio/examples/california.geojson&#34;, layer: &#34;OGRGeoJSON&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; with 1 features and 11 fields</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Feature type: wkbMultiPolygon with 2 dimensions</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot</span>(out)
</span></span></code></pre></div><p><img alt="plot of chunk unnamed-chunk-11" loading="lazy" src="/public/img/2015-01-06-geojson-topojson-io/unnamed-chunk-11-1.png"></p>
<h2 id="topojson">TopoJSON</h2>
<h3 id="convert-to-topojson-with-node-topojson-client">Convert to TopoJSON with Node topojson client</h3>
<p>For topojson you will need Mike Bostock&rsquo;s command line client. Install it by doing</p>
<pre tabindex="0"><code>sudo npm install -g topojson
</code></pre><p>Download a zipped shape fileset, <a href="https://esp.cr.usgs.gov/data/little/querwisl.zip">this one</a> for distribution of <em>Quercus wislizeni</em>. Unzip the zip file to a folder. Then do (changing the path to your path)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">topojson_write</span>(shppath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;~/Downloads/querwisl&#39;</span>, path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;~/Downloads&#34;</span>, projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;albers&#39;</span>, projargs<span style="color:#f92672">=</span><span style="color:#a6e22e">list</span>(rotate<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;[60, -35, 0]&#39;</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; OGR data source with driver: ESRI Shapefile </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Source: &#34;/Users/sacmac/Downloads/querwisl&#34;, layer: &#34;querwisl&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; with 35 features and 5 fields</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Feature type: wkbPolygon with 2 dimensions</span>
</span></span></code></pre></div><p>Which prints progress on the conversion of the shape file. And prints the topojson CLI call, including the location of the output file, here <code>/Users/sacmac/querwisl.json</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>OGR data source with driver<span style="color:#f92672">:</span> ESRI Shapefile
</span></span><span style="display:flex;"><span>Source<span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;/Users/sacmac/Downloads/querwisl&#34;</span>, layer<span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;querwisl&#34;</span>
</span></span><span style="display:flex;"><span>with <span style="color:#ae81ff">35</span> features and <span style="color:#ae81ff">5</span> fields
</span></span><span style="display:flex;"><span>Feature type<span style="color:#f92672">:</span> wkbPolygon with <span style="color:#ae81ff">2</span> dimensions
</span></span><span style="display:flex;"><span>topojson <span style="color:#f92672">-</span>o <span style="color:#f92672">/</span>Users<span style="color:#f92672">/</span>sacmac<span style="color:#f92672">/</span>querwisl.json <span style="color:#f92672">-</span>q <span style="color:#ae81ff">1e4</span> <span style="color:#f92672">-</span>s <span style="color:#ae81ff">0</span> <span style="color:#f92672">--</span>shapefile<span style="color:#f92672">-</span>encoding utf8 <span style="color:#f92672">--</span>projection <span style="color:#e6db74">&#39;d3.geo.albers().rotate([60, -35, 0])&#39;</span> <span style="color:#f92672">--</span> <span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>folders<span style="color:#f92672">/</span>gs<span style="color:#f92672">/</span><span style="color:#ae81ff">4</span>khph0xs0436gmd2gdnwsg080000gn<span style="color:#f92672">/</span>T<span style="color:#f92672">//</span>Rtmp49APW7<span style="color:#f92672">/</span>querwisl.shp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bounds<span style="color:#f92672">:</span> <span style="color:#ae81ff">-403.2554825867553</span> <span style="color:#ae81ff">401.27189387582916</span> <span style="color:#ae81ff">-295.798050380061</span> <span style="color:#ae81ff">585.4214768677039</span> (cartesian)
</span></span><span style="display:flex;"><span>pre<span style="color:#f92672">-</span>quantization<span style="color:#f92672">:</span> <span style="color:#ae81ff">0.010746817902459677</span> <span style="color:#ae81ff">0.018416799979185387</span>
</span></span><span style="display:flex;"><span>topology<span style="color:#f92672">:</span> <span style="color:#ae81ff">35</span> arcs, <span style="color:#ae81ff">2492</span> points
</span></span><span style="display:flex;"><span>prune<span style="color:#f92672">:</span> retained <span style="color:#ae81ff">35</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">35</span> <span style="color:#a6e22e">arcs </span>(<span style="color:#ae81ff">100</span>%)
</span></span></code></pre></div><p>You can then use this topojson file wherever. We&rsquo;ll add a function soon to automagically throw this file up as a Github gist to get an interactive map.</p>
<h3 id="read-topojson">Read topojson</h3>
<p>TopoJSON</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>url <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;https://raw.githubusercontent.com/shawnbot/d3-cartogram/master/data/us-states.topojson&#34;</span>
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">topojson_read</span>(url)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; OGR data source with driver: GeoJSON </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Source: &#34;https://raw.githubusercontent.com/shawnbot/d3-cartogram/master/data/us-states.topojson&#34;, layer: &#34;states&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; with 51 features and 2 fields</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Feature type: wkbPolygon with 2 dimensions</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot</span>(out)
</span></span></code></pre></div><p><img alt="plot of chunk unnamed-chunk-14" loading="lazy" src="/public/img/2015-01-06-geojson-topojson-io/unnamed-chunk-14-1.png"></p>
<h2 id="use-case-play-with-us-states">Use case: Play with US states</h2>
<p>Using data from <a href="https://github.com/glynnbird/usstatesgeojson">https://github.com/glynnbird/usstatesgeojson</a></p>
<p>Get some geojson</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#39;httr&#39;</span>)
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#39;https://api.github.com/repos/glynnbird/usstatesgeojson/contents&#39;</span>)
</span></span><span style="display:flex;"><span>st_names <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">Filter</span>(<span style="color:#66d9ef">function</span>(x) <span style="color:#a6e22e">grepl</span>(<span style="color:#e6db74">&#34;\\.geojson&#34;</span>, x), <span style="color:#a6e22e">sapply</span>(<span style="color:#a6e22e">content</span>(res), <span style="color:#e6db74">&#34;[[&#34;</span>, <span style="color:#e6db74">&#34;name&#34;</span>))
</span></span><span style="display:flex;"><span>base <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;https://raw.githubusercontent.com/glynnbird/usstatesgeojson/master/&#39;</span>
</span></span><span style="display:flex;"><span>st_files <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">paste0</span>(base, st_names)
</span></span></code></pre></div><p>Make a faceted plot</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#39;ggplot2&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#39;plyr&#39;</span>)
</span></span><span style="display:flex;"><span>st_use <span style="color:#f92672">&lt;-</span> st_files[7<span style="color:#f92672">:</span><span style="color:#ae81ff">13</span>]
</span></span><span style="display:flex;"><span>geo <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lapply</span>(st_use, geojson_read, verbose <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ldply</span>(<span style="color:#a6e22e">setNames</span>(<span style="color:#a6e22e">lapply</span>(geo, fortify), <span style="color:#a6e22e">gsub</span>(<span style="color:#e6db74">&#34;\\.geojson&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, st_names[7<span style="color:#f92672">:</span><span style="color:#ae81ff">13</span>])))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(df, <span style="color:#a6e22e">aes</span>(long, lat, group <span style="color:#f92672">=</span> group)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_polygon</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span> .id, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>)
</span></span></code></pre></div><p><img alt="plot of chunk unnamed-chunk-16" loading="lazy" src="/public/img/2015-01-06-geojson-topojson-io/unnamed-chunk-16-1.png"></p>
<h2 id="maps">Maps</h2>
<p>We&rsquo;re also working on <code>map_gist()</code> - to push up a geojson or topojson file as a GitHub gist (renders as an interactive map). It still needs some work&hellip;</p>
<h2 id="validate-geojson">Validate geojson</h2>
<p><a href="https://geojsonlint.com/">geojsonlint.com</a> has a nice web interface you can use to make sure you&rsquo;re geoJSON is in the right format. In addition, it provides a RESTful endpoint at <code>geojsonlint.com/validate</code> to validate geoJSON.
This was just added today in this package, and can be used from many data types.</p>
<p>Good geoJSON</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">validate</span>(<span style="color:#e6db74">&#39;{&#34;type&#34;: &#34;Point&#34;, &#34;coordinates&#34;: [-100, 80]}&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $status</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;ok&#34;</span>
</span></span></code></pre></div><p>Bad geoJSON</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">validate</span>(<span style="color:#e6db74">&#39;{&#34;type&#34;: &#34;Rhombus&#34;, &#34;coordinates&#34;: [[1, 2], [3, 4], [5, 6]]}&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $message</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;\&#34;Rhombus\&#34; is not a valid GeoJSON type.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $status</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;error&#34;</span>
</span></span></code></pre></div><p>A file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>file <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">system.file</span>(<span style="color:#e6db74">&#34;examples&#34;</span>, <span style="color:#e6db74">&#34;zillow_or.geojson&#34;</span>, package <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;togeojson&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">validate</span>(x <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.location</span>(file))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $status</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;ok&#34;</span>
</span></span></code></pre></div><p>A URL</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>url <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;https://raw.githubusercontent.com/glynnbird/usstatesgeojson/master/california.geojson&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">validate</span>(<span style="color:#a6e22e">as.location</span>(url))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $status</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;ok&#34;</span>
</span></span></code></pre></div><p>From the output of <code>geojson_list()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;maps&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">data</span>(us.cities)
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">geojson_list</span>(us.cities[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>,], lat<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lat&#39;</span>, lon<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;long&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">validate</span>(x)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $status</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;ok&#34;</span>
</span></span></code></pre></div><p>From SpatialPoints class</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;sp&#34;</span>)
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">SpatialPoints</span>(<span style="color:#a6e22e">cbind</span>(a,b))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">validate</span>(x)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $status</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;ok&#34;</span>
</span></span></code></pre></div>]]></content:encoded>
    </item>
    <item>
      <title>R to GeoJSON</title>
      <link>http://localhost:1313/2013/06/geojson/</link>
      <pubDate>Sun, 30 Jun 2013 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/2013/06/geojson/</guid>
      <description>&lt;p&gt;&lt;strong&gt;UPDATE&lt;/strong&gt; As you can see in Patrick&amp;rsquo;s comment below you can convert to GeoJSON format files with rgdal as an alternative to calling the Ogre web API described below. See &lt;a href=&#34;https://github.com/patperu/write2geojson/blob/master/write-geojson.R&#34;&gt;here&lt;/a&gt; for example code for converting to GeoJSON with rgdal.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;GitHub recently introduced the ability to render &lt;a href=&#34;http://en.wikipedia.org/wiki/GeoJSON&#34;&gt;GeoJSON&lt;/a&gt; files on their site as maps &lt;a href=&#34;https://github.com/blog/1528-there-s-a-map-for-that&#34;&gt;here&lt;/a&gt;, and recently introduced &lt;a href=&#34;https://github.com/blog/1541-geojson-rendering-improvements&#34;&gt;here&lt;/a&gt; support for &lt;a href=&#34;https://github.com/mbostock/topojson&#34;&gt;TopoJSON&lt;/a&gt;, an extension of GeoJSON can be up to 80% smaller than GeoJSON, support for other file extensions (&lt;code&gt;.topojson&lt;/code&gt; and &lt;code&gt;.json&lt;/code&gt;), and you can embed the maps on other sites (so awesome). The underlying maps used on GitHub are &lt;a href=&#34;http://www.openstreetmap.org/&#34;&gt;Openstreet Maps&lt;/a&gt;.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p><strong>UPDATE</strong> As you can see in Patrick&rsquo;s comment below you can convert to GeoJSON format files with rgdal as an alternative to calling the Ogre web API described below. See <a href="https://github.com/patperu/write2geojson/blob/master/write-geojson.R">here</a> for example code for converting to GeoJSON with rgdal.</p>
<hr>
<p>GitHub recently introduced the ability to render <a href="http://en.wikipedia.org/wiki/GeoJSON">GeoJSON</a> files on their site as maps <a href="https://github.com/blog/1528-there-s-a-map-for-that">here</a>, and recently introduced <a href="https://github.com/blog/1541-geojson-rendering-improvements">here</a> support for <a href="https://github.com/mbostock/topojson">TopoJSON</a>, an extension of GeoJSON can be up to 80% smaller than GeoJSON, support for other file extensions (<code>.topojson</code> and <code>.json</code>), and you can embed the maps on other sites (so awesome). The underlying maps used on GitHub are <a href="http://www.openstreetmap.org/">Openstreet Maps</a>.</p>
<p>A recent blog post showed how to convert .shp or .kml files to GeoJSON to then upload to GitHub <a href="http://ben.balter.com/2013/06/26/how-to-convert-shapefiles-to-geojson-for-use-on-github/">here</a>. The approach used Ruby on the command line locally to convert the geospatial files to GeoJSON.</p>
<p>Can we do this in R? Perhaps others have already done this, but there&rsquo;s more than one way to do anything, no?</p>
<p>I&rsquo;m not aware of a converter to GeoJSON within R, but there is a web service that can do this, called <a href="http://ogre.adc4gis.com/">Ogre</a>. The service lets you <code>POST</code> a file, which then converts to GeoJSON and gives it back to you. Ogre accepts many different file formats: BNA, CSV, DGN, DXF, zipped shapefiles, GeoConcept, GeoJSON, GeoRSS, GML, GMT, KML, MapInfo, and VRT.</p>
<p>We can use the Ogre API to upload a local geospatial file of various formats and get the GeoJSON back, then put it up on GitHub, and they render the map for you. Sweetness.</p>
<p>So here&rsquo;s the protocol.</p>
<h3 id="1-load-httr-what-is-httr-for-those-not-in-the-know-it-is-a-simpler-wrapper-around-rcurl-a-curl-interface-for-r">1. Load httr. What is httr? For those not in the know it is a simpler wrapper around RCurl, a curl interface for R.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install.packages(&#39;httr&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(httr)
</span></span></code></pre></div><h3 id="2-here-is-a-function-to-convert-your-geospatial-files-to-geojson-with-roxygen-docs">2. Here is a function to convert your geospatial files to GeoJSON (with roxygen docs).</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>togeojson <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(file, writepath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;~&#34;</span>) {
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;http://ogre.adc4gis.com/convert&#34;</span>
</span></span><span style="display:flex;"><span>    tt <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">POST</span>(url, body <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(upload <span style="color:#f92672">=</span> <span style="color:#a6e22e">upload_file</span>(file)))
</span></span><span style="display:flex;"><span>    out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">content</span>(tt, as <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;text&#34;</span>)
</span></span><span style="display:flex;"><span>    fileConn <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">file</span>(writepath)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">writeLines</span>(out, fileConn)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">close</span>(fileConn)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="3-convert-a-file-to-geojson">3. Convert a file to GeoJSON</h3>
<p><strong>KML</strong></p>
<p>In the first line I specify the location of the file on my machine. In the second line the function <code>togeojson</code> reads in the file, sends the file to the API endpoint <em><a href="http://ogre.adc4gis.com/convert">http://ogre.adc4gis.com/convert</a></em>, collects the returned GeoJSON object, and saves the GeoJSON to a file that you specify. Here we are converting a KML file with point occurrences (data collected from <a href="http://bison.usgs.ornl.gov/">USGS&rsquo;s BISON service</a>).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>file <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;~/github/sac/rgeojson/acer_spicatum.kml&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">togeojson</span>(file, <span style="color:#e6db74">&#34;~/github/sac/rgeojson/acer_spicatum.geojson&#34;</span>)
</span></span></code></pre></div><p><strong>Shapefiles</strong></p>
<p>Here, we are converting a zip file containing shape files for <em>Pinus contorta</em> (data collected from the USGS <a href="http://esp.cr.usgs.gov/data/little/">here</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>file <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;~/github/sac/rgeojson/pinucont.zip&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">togeojson</span>(file, <span style="color:#e6db74">&#34;~/github/sac/rgeojson/pinus.geojson&#34;</span>)
</span></span></code></pre></div><h3 id="4-then-commit-and-push-to-github-and-this-is-what-they-look-like-on-github">4. Then commit and push to GitHub. And this is what they look like on GitHub</h3>
<p><em>Acer spicatum</em> distribution (points)</p>

<script src="https://embed.github.com/view/geojson/sckott/rgeojson/output/acer_spicatum.geojson"></script>

<p><em>Pinus contorta</em> distribution (polygons)</p>

<script src="https://embed.github.com/view/geojson/sckott/rgeojson/output/pinus.geojson"></script>

<p>If you want, you can clone a repo from my account. Then do the below. (of course, you must have git installed, and have a GitHub account&hellip;)</p>
<p>First, fork my <code>rgeojson</code> repo <a href="https://github.com/sckott/rgeojson">here</a> to your GitHub account.</p>
<p>Second, in your terminal/command line&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/&lt;yourgithubusername&gt;/rgeojson.git
</span></span><span style="display:flex;"><span>cd rgeojson
</span></span></code></pre></div><p>Third, in R specify the location of either the KML file or the zipped shape files, then call <code>togeojson</code> function to convert the KML file to a GeoJSON file (which should output a file <em>acer_spicatum.geojson</em>)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>file <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;/path/to/acer_spicatum.kml&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">togeojson</span>(file, <span style="color:#e6db74">&#34;~/path/to/write/to/acer_spicatum.geojson&#34;</span>)
</span></span></code></pre></div><p>Fourth, back in the terminal&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git add acer_spicatum.geojson
</span></span><span style="display:flex;"><span>git commit -a -m <span style="color:#e6db74">&#39;some cool commit message&#39;</span>
</span></span><span style="display:flex;"><span>git push
</span></span></code></pre></div><p>Fifth, go to your <em>rgeojson</em> repo on GitHub and click on the <em>acer_spicatum.geojson</em> file, and the map should render.</p>
<p>Look for this functionality to come to the <a href="https://github.com/ropensci/rbison">rbison</a> and <a href="https://github.com/ropensci/rgbif">rgbif</a> R packages soon. Why is that cool?  Think of the workflow: Query for species occurrence data in the BISON or GBIF databases, convert the results to a GeoJSON file, push to GitHub, and you have an awesome interactive map on the web. Not too bad eh.</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
