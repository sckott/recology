<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Resolving species names when you have a lot of them | Recology</title>
<meta name="keywords" content="R, ropensci, taxize, taxonomic">
<meta name="description" content="taxize use case: Resolving species names when you have a lot of them
Species names can be a pain in the ass, especially if you are an ecologist. We ecologists aren&rsquo;t trained in taxonomy, yet we often end up with huge species lists.  Of course we want to correct any spelling errors in the names, and get the newest names for our species, resolve any synonyms, etc.
We are building tools into our R package taxize, that will let you check your species names to make sure they are correct.">
<meta name="author" content="Scott Chamberlain">
<link rel="canonical" href="http://localhost:1313/2013/01/tnrs-use-case/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a4ec0cdfac731fabf363c0b5d5ab206254bbf9b6aaf985d695c6bb534196df16.css" integrity="sha256-pOwM36xzH6vzY8C11asgYlS7&#43;baq&#43;YXWlca7U0GW3xY=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="alternate" hreflang="en" href="http://localhost:1313/2013/01/tnrs-use-case/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Recology (Alt + H)">Recology</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/links" title="Links">
                    <span>Links</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts/index.xml" title="RSS">
                    <span>RSS</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Resolving species names when you have a lot of them
    </h1>
    <div class="post-meta"><span title='2013-01-25 00:00:00 +0000 UTC'>January 25, 2013</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Scott Chamberlain

</div>
  </header> 
  <div class="post-content"><h3 id="taxize-use-case-resolving-species-names-when-you-have-a-lot-of-them"><strong>taxize use case: Resolving species names when you have a lot of them</strong><a hidden class="anchor" aria-hidden="true" href="#taxize-use-case-resolving-species-names-when-you-have-a-lot-of-them">#</a></h3>
<p>Species names can be a pain in the ass, especially if you are an ecologist. We ecologists aren&rsquo;t trained in taxonomy, yet we often end up with huge species lists.  Of course we want to correct any spelling errors in the names, and get the newest names for our species, resolve any synonyms, etc.</p>
<p>We are building tools into our R package <a href="http://ropensci.github.com/taxize_/"><code>taxize</code></a>, that will let you check your species names to make sure they are correct.</p>
<p>An important use case is when you have a lot of species. Someone wrote to us recently, saying that they had thousands of species, and they wanted to know how to check their species names efficiently in R.</p>
<p>Below is an example of how to do this.</p>
<h4 id="install-taxize">Install taxize<a hidden class="anchor" aria-hidden="true" href="#install-taxize">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;taxize_&#39;, &#39;ropensci&#39;) # install the GitHub version, not</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># the CRAN version, uncomment if you don&#39;t have it installed</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(taxize)
</span></span></code></pre></div><h4 id="get-some-species-in-this-case-all-species-in-the-scrophulariaceae-family-from-theplantlistorg">Get some species, in this case all species in the Scrophulariaceae family from theplantlist.org<a hidden class="anchor" aria-hidden="true" href="#get-some-species-in-this-case-all-species-in-the-scrophulariaceae-family-from-theplantlistorg">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">tpl_get</span>(dir_ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;~/foo2&#34;</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Scrophulariaceae&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">## Reading and writing csv files to ~/foo2...</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>(<span style="color:#e6db74">&#34;~/foo2/Scrophulariaceae.csv&#34;</span>)
</span></span></code></pre></div><h4 id="lets-grab-the-species-and-concatenate-to-genus_species">Lets grab the species and concatenate to genus_species<a hidden class="anchor" aria-hidden="true" href="#lets-grab-the-species-and-concatenate-to-genus_species">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>species <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.character</span>(<span style="color:#a6e22e">ddply</span>(dat[, <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Genus&#34;</span>, <span style="color:#e6db74">&#34;Species&#34;</span>)], .(), transform, 
</span></span><span style="display:flex;"><span>    gen_sp <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.factor</span>(<span style="color:#a6e22e">paste</span>(Genus, Species, sep <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; &#34;</span>)))[, <span style="color:#ae81ff">4</span>])
</span></span></code></pre></div><h4 id="its-better-to-do-many-smaller-calls-to-a-web-api-instead-of-few-big-ones-to-be-nice-to-the-database-maintainers">It&rsquo;s better to do many smaller calls to a web API instead of few big ones to be nice to the database maintainers.<a hidden class="anchor" aria-hidden="true" href="#its-better-to-do-many-smaller-calls-to-a-web-api-instead-of-few-big-ones-to-be-nice-to-the-database-maintainers">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">## Define function to split up your species list into useable chuncks</span>
</span></span><span style="display:flex;"><span>slice <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(input, by <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>) {
</span></span><span style="display:flex;"><span>    starts <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">length</span>(input), by)
</span></span><span style="display:flex;"><span>    tt <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lapply</span>(starts, <span style="color:#66d9ef">function</span>(y) input[y<span style="color:#f92672">:</span>(y <span style="color:#f92672">+</span> (by <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>))])
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">llply</span>(tt, <span style="color:#66d9ef">function</span>(x) x[<span style="color:#f92672">!</span><span style="color:#a6e22e">is.na</span>(x)])
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>species_split <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">slice</span>(species, by <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>)
</span></span></code></pre></div><h4 id="query-for-your-large-species-list-with-pauses-between-calls-with-3-seconds-in-between-calls-to-not-hit-the-web-service-too-hard-using-post-method-here-instead-of-get---required-when-you-have-a-lot-of-species">Query for your large species list with pauses between calls, with 3 seconds in between calls to not hit the web service too hard. Using POST method here instead of GET - required when you have a lot of species.<a hidden class="anchor" aria-hidden="true" href="#query-for-your-large-species-list-with-pauses-between-calls-with-3-seconds-in-between-calls-to-not-hit-the-web-service-too-hard-using-post-method-here-instead-of-get---required-when-you-have-a-lot-of-species">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>tnrs_safe <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">failwith</span>(<span style="color:#66d9ef">NULL</span>, tnrs)  <span style="color:#75715e"># in case some calls fail, will continue</span>
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">llply</span>(species_split, <span style="color:#66d9ef">function</span>(x) <span style="color:#a6e22e">tnrs_safe</span>(x, getpost <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;POST&#34;</span>, sleep <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">90</span>fcd9ae425ad7c6103b06dd9fd78ae2
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">223</span>f73b83fcddcb8b6187966963660a8
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">72</span>bacdbb8938316e321d4c709c8cdd09
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">979</span>ce9cc4dec376710f61de162e1294e
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">03</span>a39a124561fec2fdfc0f483d9fb607
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span>d4bf4e5a1403f45a1be1ca3dd87785d7
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span>a9a9bdde6fda7e325d80120e27ccb480
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">215</span>ccdcf2b00362278bf19d1942e1395
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">9</span>d43c0b99b4dfb5ea1b435adab17b980
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">42e166</span>f8e43f1fb349e36459cd5938b3
</span></span><span style="display:flex;"><span>Calling http<span style="color:#f92672">://</span>taxosaurus.org<span style="color:#f92672">/</span>retrieve<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>c42e4b5227c5464f9bfeeafcdf0651d
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Looks like we got some data back for each element of our species list</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">lapply</span>(out, head)[1<span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>]  <span style="color:#75715e"># just look at the first two</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[[1]]
</span></span><span style="display:flex;"><span>                 submittedName                 acceptedName    sourceId
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>        Aptosimum welwitschii                              iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>        Anticharis ebracteata        Anticharis ebracteata iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>            Aptosimum lineare            Aptosimum lineare iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     Antherothamnus pearsonii     Antherothamnus pearsonii iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> Barthlottia madagascariensis Barthlottia madagascariensis iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>         Agathelpis mucronata                              iPlant_TNRS
</span></span><span style="display:flex;"><span>  score                  matchedName     annotations
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>     <span style="color:#ae81ff">1</span>        Aptosimum welwitschii                
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">1</span>        Anticharis ebracteata          Schinz
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>     <span style="color:#ae81ff">1</span>            Aptosimum lineare Marloth <span style="color:#f92672">&amp;</span> Engl.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">1</span>     Antherothamnus pearsonii        N.E. Br.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>     <span style="color:#ae81ff">1</span> Barthlottia madagascariensis      Eb. Fisch.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>     <span style="color:#ae81ff">1</span>         Agathelpis mucronata                
</span></span><span style="display:flex;"><span>                                    uri
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                                      
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202501</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202525</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202728</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">50089700</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>                                      
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[2]]
</span></span><span style="display:flex;"><span>                     submittedName           acceptedName    sourceId
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> Buddleja pichinchensis x bullata Buddleja pichinchensis iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>                 Buddleja soratae       Buddleja soratae iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>              Buddleja euryphylla    Buddleja euryphylla iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>                  Buddleja incana        Buddleja incana iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>                  Buddleja incana                 Incana        NCBI
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>                    Buddleja nana Buddleja brachystachya iPlant_TNRS
</span></span><span style="display:flex;"><span>  score            matchedName        annotations
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   <span style="color:#ae81ff">0.9</span> Buddleja pichinchensis              Kunth
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   <span style="color:#ae81ff">1.0</span>       Buddleja soratae           Kraenzl.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>   <span style="color:#ae81ff">1.0</span>    Buddleja euryphylla Standl. <span style="color:#f92672">&amp;</span> Steyerm.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>   <span style="color:#ae81ff">1.0</span>        Buddleja incana        Ruiz <span style="color:#f92672">&amp;</span> Pav.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>   <span style="color:#ae81ff">1.0</span>        Buddleja incana               none
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>   <span style="color:#ae81ff">1.0</span>          Buddleja nana              Diels
</span></span><span style="display:flex;"><span>                                          uri
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19000333</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19001018</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19000790</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19000596</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> http<span style="color:#f92672">://</span>www.ncbi.nlm.nih.gov<span style="color:#f92672">/</span>taxonomy<span style="color:#f92672">/</span><span style="color:#ae81ff">405077</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19001133</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Now we can put them back together as so into one data.frame if you like</span>
</span></span><span style="display:flex;"><span>outdf <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ldply</span>(out)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(outdf)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>                 submittedName                 acceptedName    sourceId
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>        Aptosimum welwitschii                              iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>        Anticharis ebracteata        Anticharis ebracteata iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>            Aptosimum lineare            Aptosimum lineare iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     Antherothamnus pearsonii     Antherothamnus pearsonii iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> Barthlottia madagascariensis Barthlottia madagascariensis iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>         Agathelpis mucronata                              iPlant_TNRS
</span></span><span style="display:flex;"><span>  score                  matchedName     annotations
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>     <span style="color:#ae81ff">1</span>        Aptosimum welwitschii                
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">1</span>        Anticharis ebracteata          Schinz
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>     <span style="color:#ae81ff">1</span>            Aptosimum lineare Marloth <span style="color:#f92672">&amp;</span> Engl.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">1</span>     Antherothamnus pearsonii        N.E. Br.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>     <span style="color:#ae81ff">1</span> Barthlottia madagascariensis      Eb. Fisch.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>     <span style="color:#ae81ff">1</span>         Agathelpis mucronata                
</span></span><span style="display:flex;"><span>                                    uri
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                                      
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202501</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202525</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">29202728</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">50089700</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>
</span></span></code></pre></div><p>Note that there are multiple names for some species because data sources have different names for the same species (resulting in more than one row in the data.frame &lsquo;outdf&rsquo; for a species). We are leaving this up to the user to decide which to use. For example, for the species <em>Buddleja montana</em> there are two names for in the output</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ddply</span>(outdf, .(submittedName), summarize, <span style="color:#a6e22e">length</span>(submittedName))
</span></span><span style="display:flex;"><span>outdf[outdf<span style="color:#f92672">$</span>submittedName <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">as.character</span>(data[data<span style="color:#f92672">$</span><span style="color:#66d9ef">..1</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>, ][6, <span style="color:#e6db74">&#34;submittedName&#34;</span>]), 
</span></span><span style="display:flex;"><span>    ]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>       submittedName     acceptedName    sourceId score      matchedName
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">123</span> Buddleja montana Buddleja montana iPlant_TNRS     <span style="color:#ae81ff">1</span> Buddleja montana
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">124</span> Buddleja montana          Montana        NCBI     <span style="color:#ae81ff">1</span> Buddleja montana
</span></span><span style="display:flex;"><span>         annotations                                         uri
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">123</span> Britton ex Rusby       http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19000601</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">124</span>             none http<span style="color:#f92672">://</span>www.ncbi.nlm.nih.gov<span style="color:#f92672">/</span>taxonomy<span style="color:#f92672">/</span><span style="color:#ae81ff">441235</span>
</span></span></code></pre></div><p>The source iPlant matched the name, but NCBI actually gave back a genus of cricket (follow the link under the column uri for <em>Montana</em>). If you look at the page for <em>Buddleja</em> on NCBI <a href="http://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?id=26473">here</a> there is no <em>Buddleja montana</em> at all.</p>
<p>Another thing we could do is look at the score that is returned. Let&rsquo;s look at those that are less than 1 (i.e., )</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>outdf[outdf<span style="color:#f92672">$</span>score <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>, ]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>                        submittedName           acceptedName    sourceId
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">94</span>   Buddleja pichinchensis x bullata Buddleja pichinchensis iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">340</span>                Diascia ellaphieae                        iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">495</span>              Eremophila decipiens                        iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">500</span>            Eremophila grandiflora             Eremophila iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">808</span>           Jamesbrittneia hilliard                        iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1051</span>                 Verbascum patris              Verbascum iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1081</span>             Verbascum barnadesii              Verbascum iPlant_TNRS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1097</span>              Verbascum calycosum              Verbascum iPlant_TNRS
</span></span><span style="display:flex;"><span>     score            matchedName annotations
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">94</span>    <span style="color:#ae81ff">0.90</span> Buddleja pichinchensis       Kunth
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">340</span>   <span style="color:#ae81ff">0.98</span>      Diascia ellaphiae            
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">495</span>   <span style="color:#ae81ff">0.98</span>  Eremophila decipiense            
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">500</span>   <span style="color:#ae81ff">0.50</span>             Eremophila      R. Br.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">808</span>   <span style="color:#ae81ff">0.50</span>         Jamesbrittenia            
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1051</span>  <span style="color:#ae81ff">0.50</span>              Verbascum          L.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1081</span>  <span style="color:#ae81ff">0.50</span>              Verbascum          L.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1097</span>  <span style="color:#ae81ff">0.50</span>              Verbascum          L.
</span></span><span style="display:flex;"><span>                                       uri
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">94</span>   http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">19000333</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">340</span>                                       
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">495</span>                                       
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">500</span>  http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">40004761</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">808</span>                                       
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1051</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">40023766</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1081</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">40023766</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1097</span> http<span style="color:#f92672">://</span>www.tropicos.org<span style="color:#f92672">/</span>Name<span style="color:#f92672">/</span><span style="color:#ae81ff">40023766</span>
</span></span></code></pre></div><p>As we got this speies list from <a href="http://www.theplantlist.org/">theplantlist.org</a>, there aren&rsquo;t that many mistakes, but if it was my species list you know there would be many :)</p>
<p>That&rsquo;s it.  Try it out and let us know if you have any questions at <a href="mailto:info@ropensci.org">info@ropensci.org</a>, or <a href="https://github.com/ropensci/taxize_/issues">ask questions/report problems at GitHub</a>.</p>
<hr>
<p>Get the .Rmd file used to create this post <a href="https://github.com/sckott/sckott.github.com/tree/master/2013-01-25-tnrs-use-case.Rmd">at my github account</a> - or <a href="https://github.com/sckott/sckott.github.com/tree/master/_posts/2013-01-25-tnrs-use-case.md">.md file</a>.</p>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/r/">R</a></li>
      <li><a href="http://localhost:1313/tags/ropensci/">Ropensci</a></li>
      <li><a href="http://localhost:1313/tags/taxize/">Taxize</a></li>
      <li><a href="http://localhost:1313/tags/taxonomic/">Taxonomic</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Recology</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
