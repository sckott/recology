<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>lawn - a new package to do geospatial analysis | Recology</title>
<meta name="keywords" content="R, geojson, javascript, geospatial">
<meta name="description" content="lawn is an R wrapper for the Javascript library turf.js for advanced geospatial analysis. In addition, we have a few functions to interface with the geojson-random Javascript library.
lawn includes traditional spatial operations, helper functions for creating GeoJSON data, and data classification and statistics tools.
There is an additional helper function (see view()) in this package to help visualize data with interactive maps via the leaflet package (https://github.com/rstudio/leaflet). Note that leaflet is not required to install lawn - it&rsquo;s in Suggests, not Imports or Depends.">
<meta name="author" content="Scott Chamberlain">
<link rel="canonical" href="http://localhost:1313/2015/05/mow-the-lawn/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f4cda22486791d430ef692108ba33a982c3c552eca57e99456bb55aa4bd22568.css" integrity="sha256-9M2iJIZ5HUMO9pIQi6M6mCw8VS7KV&#43;mUVrtVqkvSJWg=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/2015/05/mow-the-lawn/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Recology (Alt + H)">Recology</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/index.xml" title="RSS">
                    <span>RSS</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      lawn - a new package to do geospatial analysis
    </h1>
    <div class="post-meta"><span title='2015-05-18 00:00:00 +0000 UTC'>May 18, 2015</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Scott Chamberlain

</div>
  </header> 
  <div class="post-content"><p><code>lawn</code> is an R wrapper for the Javascript library <a href="http://turfjs.org/">turf.js</a> for advanced geospatial analysis. In addition, we have a few functions to interface with the <a href="https://github.com/mapbox/geojson-random">geojson-random</a> Javascript library.</p>
<p><code>lawn</code> includes traditional spatial operations, helper functions for creating GeoJSON data, and data classification and statistics tools.</p>
<p>There is an additional helper function (see <code>view()</code>) in this package to help visualize data with interactive maps via the <code>leaflet</code> package (<a href="https://github.com/rstudio/leaflet">https://github.com/rstudio/leaflet</a>). Note that <code>leaflet</code> is not required to install <code>lawn</code> - it&rsquo;s in Suggests, not Imports or Depends.</p>
<p>Use cases for this package include (but not limited to, obs.) the following (all below assumes GeoJSON format):</p>
<ul>
<li>Create random spatial data.</li>
<li>Convert among spatial data types (e.g. <code>Polygon</code> to <code>FeatureCollection</code>)</li>
<li>Transform objects, including merging many, simplifying, calculating hulls, etc.</li>
<li>Measuring objects</li>
<li>Performing interpolation of objects</li>
<li>Aggregating data (aka properties) associated with objects</li>
</ul>
<h2 id="install">Install<a hidden class="anchor" aria-hidden="true" href="#install">#</a></h2>
<p>Stable <code>lawn</code> version from CRAN - this should fetch <code>leaflet</code>, which is not on CRAN, but in a <code>drat</code> repo (let me know if it doesn&rsquo;t)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;lawn&#34;</span>)
</span></span></code></pre></div><p>Or, the development version from Github</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>devtools<span style="color:#f92672">::</span><span style="color:#a6e22e">install_github</span>(<span style="color:#e6db74">&#34;ropensci/lawn&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(<span style="color:#e6db74">&#34;lawn&#34;</span>)
</span></span></code></pre></div><h2 id="view">view<a hidden class="anchor" aria-hidden="true" href="#view">#</a></h2>
<p><code>lawn</code> includes a tiny helper function for visualizing geojson. For examples below, we&rsquo;ll make liberal use of the <code>lawn::view()</code> function to visualize what it is the heck we&rsquo;re doing. mkay, lets roll&hellip;</p>
<p>We&rsquo;ve tried to make <code>view()</code> work with as many inputs as possible, from class <code>character</code> containing
json to the class <code>json</code> from the <code>jsonlite</code> package, to the class <code>list</code> to all of the GeoJSON outputs
from functions in <code>lawn</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">view</span>(lawn_data<span style="color:#f92672">$</span>points_average)
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/map1.png" alt="map1"  />
</p>
<p>Here, we sample at random two points from the same dataset just viewed.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_sample</span>(lawn_data<span style="color:#f92672">$</span>points_average, <span style="color:#ae81ff">2</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">view</span>()
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/map2.png" alt="map2"  />
</p>
<h2 id="make-some-geojson-data">Make some geojson data<a hidden class="anchor" aria-hidden="true" href="#make-some-geojson-data">#</a></h2>
<p>Point</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_point</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-74.5</span>, <span style="color:#ae81ff">40</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Feature&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Point&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry$coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] -74.5  40.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $properties</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; named list()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;point&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_point</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-74.5</span>, <span style="color:#ae81ff">40</span>)) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/point.png" alt="point"  />
</p>
<p>Polygon</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>rings <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">list</span>(<span style="color:#a6e22e">list</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-2.275543</span>, <span style="color:#ae81ff">53.464547</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-2.275543</span>, <span style="color:#ae81ff">53.489271</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-2.215118</span>, <span style="color:#ae81ff">53.489271</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-2.215118</span>, <span style="color:#ae81ff">53.464547</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-2.275543</span>, <span style="color:#ae81ff">53.464547</span>)
</span></span><span style="display:flex;"><span>))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">lawn_polygon</span>(rings)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Feature&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry$type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;Polygon&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $geometry$coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; , , 1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1,] -2.275543 -2.275543 -2.215118 -2.215118 -2.275543</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; , , 2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1,] 53.46455 53.48927 53.48927 53.46455 53.46455</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $properties</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; named list()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;polygon&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_polygon</span>(rings) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/polygon.png" alt="polygon"  />
</p>
<p>Random set of points</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_random</span>(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;      type geometry.type  geometry.coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 Feature         Point -137.46327, -63.46154</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 Feature         Point  -110.68426, 83.10533</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;featurecollection&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_random</span>(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/lawn_random.png" alt="rand1"  />
</p>
<p>Or, use a different Javascript library (<a href="https://github.com/mapbox/geojson-random">geojson-random</a>) to create random features.</p>
<p>Positions</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gr_position</span>()
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] -179.77996   45.99018</span>
</span></span></code></pre></div><p>Points</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gr_point</span>(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;      type geometry.type geometry.coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 Feature         Point   5.83895, -27.77218</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 Feature         Point   78.50177, 14.95840</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;featurecollection&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gr_point</span>(<span style="color:#ae81ff">2</span>) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/geojsonrandom_points.png" alt="rand2"  />
</p>
<p>Polygons</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gr_polygon</span>(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, vertices <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>, max_radial_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;      type geometry.type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 Feature       Polygon</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                                                                                                           geometry.coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 67.58827, 67.68551, 67.00091, 66.70156, 65.72578, 67.58827, -42.11340, -42.69850, -43.54866, -42.42758, -41.76731, -42.11340</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;featurecollection&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gr_polygon</span>(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, vertices <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>, max_radial_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/geojsonrandom_polygons.png" alt="rand3"  />
</p>
<h2 id="count">count<a hidden class="anchor" aria-hidden="true" href="#count">#</a></h2>
<p>Count number of points within polygons, appends a new field to properties (see the <code>count</code> field)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_count</span>(polygons <span style="color:#f92672">=</span> lawn_data<span style="color:#f92672">$</span>polygons_count, points <span style="color:#f92672">=</span> lawn_data<span style="color:#f92672">$</span>points_count)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;      type pt_count geometry.type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 Feature        2       Polygon</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 Feature        0       Polygon</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;                                                                                           geometry.coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 -112.07239, -112.07239, -112.02810, -112.02810, -112.07239, 46.58659, 46.61761, 46.61761, 46.58659, 46.58659</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 -112.02398, -112.02398, -111.96613, -111.96613, -112.02398, 46.57043, 46.61502, 46.61502, 46.57043, 46.57043</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;featurecollection&#34;</span>
</span></span></code></pre></div><h2 id="distance">distance<a hidden class="anchor" aria-hidden="true" href="#distance">#</a></h2>
<p>Define two points</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>from <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;properties&#34;: {},
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;type&#34;: &#34;Point&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;coordinates&#34;: [-75.343, 39.984]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span>to <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;properties&#34;: {},
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;type&#34;: &#34;Point&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;coordinates&#34;: [-75.534, 39.123]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span></code></pre></div><p>Calculate distance, default units is kilometers (default output: <code>km</code>)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_distance</span>(from, to)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 97.15958</span>
</span></span></code></pre></div><h2 id="sample-from-a-featurecollection">sample from a FeatureCollection<a hidden class="anchor" aria-hidden="true" href="#sample-from-a-featurecollection">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> lawn_data<span style="color:#f92672">$</span>points_average
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cat</span>(dat)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; {</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;   &#34;type&#34;: &#34;FeatureCollection&#34;,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;   &#34;features&#34;: [</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;     {</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;       &#34;type&#34;: &#34;Feature&#34;,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;       &#34;properties&#34;: {</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;         &#34;population&#34;: 200</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;       },</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;       &#34;geometry&#34;: {</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;         &#34;type&#34;: &#34;Point&#34;,</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">...</span>
</span></span></code></pre></div><p>Sample 2 points at random</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_sample</span>(dat, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $type</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;FeatureCollection&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; $features</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt;      type population geometry.type geometry.coordinates</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 1 Feature        200         Point   10.80643, 59.90891</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; 2 Feature        600         Point   10.71579, 59.90478</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; attr(,&#34;class&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] &#34;featurecollection&#34;</span>
</span></span></code></pre></div><h2 id="extent">extent<a hidden class="anchor" aria-hidden="true" href="#extent">#</a></h2>
<p>Calculates the extent of all input features in a FeatureCollection, and returns a bounding box.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_extent</span>(lawn_data<span style="color:#f92672">$</span>points_average)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 10.71579 59.90478 10.80643 59.93162</span>
</span></span></code></pre></div><h2 id="buffer">buffer<a hidden class="anchor" aria-hidden="true" href="#buffer">#</a></h2>
<p>Calculates a buffer for input features for a given radius.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;properties&#34;: {},
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     &#34;type&#34;: &#34;Polygon&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     &#34;coordinates&#34;: [[
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       [-112.072391,46.586591],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       [-112.072391,46.61761],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       [-112.028102,46.61761],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       [-112.028102,46.586591],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       [-112.072391,46.586591]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     ]]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">view</span>(dat)
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/buffer1.png" alt="buffer1"  />
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_buffer</span>(dat, <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;miles&#34;</span>) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/buffer2.png" alt="buffer2"  />
</p>
<h2 id="union-polygons-together">Union polygons together<a hidden class="anchor" aria-hidden="true" href="#union-polygons-together">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>poly1 <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;properties&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;fill&#34;: &#34;#0f0&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;type&#34;: &#34;Polygon&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;coordinates&#34;: [[
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.801742, 45.48565],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.801742, 45.60491],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.584762, 45.60491],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.584762, 45.48565],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.801742, 45.48565]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ]]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>poly2 <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;properties&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;fill&#34;: &#34;#00f&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;type&#34;: &#34;Polygon&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   &#34;coordinates&#34;: [[
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.520217, 45.535693],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.64038, 45.553967],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.720031, 45.526554],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.669906, 45.507309],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.723464, 45.446643],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.532577, 45.408574],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.487258, 45.477466],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     [-122.520217, 45.535693]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     ]]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">view</span>(poly1)
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/union1.png" alt="union1"  />
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">view</span>(poly2)
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/union2.png" alt="union2"  />
</p>
<p>Visualize union-ed polygons</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">lawn_union</span>(poly1, poly2) <span style="color:#f92672">%&gt;%</span> view
</span></span></code></pre></div><p><img loading="lazy" src="/2015-05-18-mow-the-lawn/union3.png" alt="union3"  />
</p>
<p>See also <code>lawn_merge()</code> and <code>lawn_intersect()</code>.</p>
<h2 id="lint-input-geojson">lint input geojson<a hidden class="anchor" aria-hidden="true" href="#lint-input-geojson">#</a></h2>
<p>For most functions, you can lint your input geojson data to make sure it is proper geojson. We use
the javascript library <a href="https://github.com/mapbox/geojsonhint">geojsonhint</a>. See the <code>lint</code> parameter.</p>
<p>Good GeoJSON</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;type&#34;: &#34;FeatureCollection&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;features&#34;: [
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;properties&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;population&#34;: 200
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;type&#34;: &#34;Point&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;coordinates&#34;: [10.724029, 59.926807]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  ]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">lawn_extent</span>(dat)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; [1] 10.72403 59.92681 10.72403 59.92681</span>
</span></span></code></pre></div><p>Bad GeoJSON</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>dat <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;type&#34;: &#34;FeatureCollection&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;features&#34;: [
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;type&#34;: &#34;Feature&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;properties&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;population&#34;: 200
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &#34;geometry&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;type&#34;: &#34;Point&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  ]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">lawn_extent</span>(dat, lint <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#&gt; Error: Line 1 - &#34;coordinates&#34; property required</span>
</span></span></code></pre></div><h2 id="to-do">To do<a hidden class="anchor" aria-hidden="true" href="#to-do">#</a></h2>
<ul>
<li>As Turf.js changes, we&rsquo;ll update <code>lawn</code></li>
<li>Performance improvements. We realize that this package is slower than the C based <code>rgdal</code>/<code>rgeos</code> - we are looking into ways to increaes performance to get closer to the performance of those packages.</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/r/">R</a></li>
      <li><a href="http://localhost:1313/tags/geojson/">Geojson</a></li>
      <li><a href="http://localhost:1313/tags/javascript/">Javascript</a></li>
      <li><a href="http://localhost:1313/tags/geospatial/">Geospatial</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="http://localhost:1313/">Recology</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
