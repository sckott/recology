<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>One R package for all your taxonomic needs | Recology</title>
<meta name="keywords" content="R, open source, data, taxonomy, ropensci, ritis, taxize">
<meta name="description" content="
UPDATE: there were some errors in the tests for taxize, so the binaries aren&rsquo;t avaiable yet. You can install from source though, see below.

Getting taxonomic information for the set of species you are studying can be a pain in the ass. You have to manually type, or paste in, your species one-by-one. Or, if you are lucky, there is a web service in which you can upload a list of species. Encyclopedia of Life (EOL) has a service where you can do this here. But is this reproducible? No.">
<meta name="author" content="Scott Chamberlain">
<link rel="canonical" href="http://localhost:1313/2012/12/taxize/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a4ec0cdfac731fabf363c0b5d5ab206254bbf9b6aaf985d695c6bb534196df16.css" integrity="sha256-pOwM36xzH6vzY8C11asgYlS7&#43;baq&#43;YXWlca7U0GW3xY=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/2012/12/taxize/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Recology (Alt + H)">Recology</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/index.xml" title="RSS">
                    <span>RSS</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      One R package for all your taxonomic needs
    </h1>
    <div class="post-meta"><span title='2012-12-06 00:00:00 +0000 UTC'>December 6, 2012</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;Scott Chamberlain

</div>
  </header> 
  <div class="post-content"><blockquote>
<p>UPDATE: there were some errors in the tests for <code>taxize</code>, so the binaries aren&rsquo;t avaiable yet. You can install from source though, see below.</p>
</blockquote>
<p>Getting taxonomic information for the set of species you are studying can be a pain in the ass. You have to manually type, or paste in, your species one-by-one. Or, if you are lucky, there is a web service in which you can upload a list of species. Encyclopedia of Life (EOL) has a service where you can do this <a href="http://gni.globalnames.org/parsers/new">here</a>. But is this reproducible? No.</p>
<p>Getting your taxonomic information for your species can now be done programatically in R. Do you want to get taxonomic information from ITIS. We got that. Tropicos? We got that too. uBio? No worries, we got that. What about theplantlist.org? Yep, got that. Encyclopedia of Life? Indeed. What about getting sequence data for a taxon? Oh hell yeah, you can get sequences available for a taxon across all genes, or get all records for a taxon for a specific gene.</p>
<p>Of course this is all possible because these data providers have open APIs so that we can facilitate your computer talking to their database. Fun!</p>
<p>Why get your taxonomic data programatically? Because it&rsquo;s 1) faster than by hand in web sites/looking up in books, 2) reproducible, especially if you share your code (damnit!), and 3) you can easily mash up your new taxonomic data to get sequences to build a phylogeny, etc.</p>
<p>I&rsquo;ll give a few examples of using <code>taxize</code> based around use cases, that is, stuff someone might actually do instead of what particular functions do.</p>
<hr>
<h3 id="install-packages--you-can-get-from-cran-or-github">Install packages.  You can get from CRAN or GitHub.<a hidden class="anchor" aria-hidden="true" href="#install-packages--you-can-get-from-cran-or-github">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install.packages(&#34;ritis&#34;) # uncomment if not already installed</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;taxize_&#39;, &#39;ropensci&#39;) # uncomment if not already installed</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install.packages(&#34;taxize&#34;, type=&#34;source&#34;) # uncomment if not already installed</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ritis)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(taxize)
</span></span></code></pre></div><hr>
<h3 id="attach-family-names-to-a-list-of-species">Attach family names to a list of species.<a hidden class="anchor" aria-hidden="true" href="#attach-family-names-to-a-list-of-species">#</a></h3>
<h4 id="i-often-have-a-list-of-species-that-i-studied-and-simply-want-to-get-their-family-names-to-for-example-make-a-table-for-the-paper-im-writing">I often have a list of species that I studied and simply want to get their family names to, for example, make a table for the paper I&rsquo;m writing.<a hidden class="anchor" aria-hidden="true" href="#i-often-have-a-list-of-species-that-i-studied-and-simply-want-to-get-their-family-names-to-for-example-make-a-table-for-the-paper-im-writing">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># For one species</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">itis_name</span>(query <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Poa annua&#34;</span>, get <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;family&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Poa annua &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[1] <span style="color:#e6db74">&#34;Poaceae&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For many species</span>
</span></span><span style="display:flex;"><span>species <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Poa annua&#34;</span>, <span style="color:#e6db74">&#34;Abies procera&#34;</span>, <span style="color:#e6db74">&#34;Helianthus annuus&#34;</span>, <span style="color:#e6db74">&#34;Coffea arabica&#34;</span>)
</span></span><span style="display:flex;"><span>famnames <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sapply</span>(species, itis_name, get <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;family&#34;</span>, USE.NAMES <span style="color:#f92672">=</span> F)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Poa annua &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Abies procera &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Helianthus annuus &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Coffea arabica &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">data.frame</span>(species <span style="color:#f92672">=</span> species, family <span style="color:#f92672">=</span> famnames)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>            species     family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>         Poa annua    Poaceae
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>     Abies procera   Pinaceae
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> Helianthus annuus Asteraceae
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>    Coffea arabica  Rubiaceae
</span></span></code></pre></div><hr>
<h3 id="resolve-taxonomic-names">Resolve taxonomic names.<a hidden class="anchor" aria-hidden="true" href="#resolve-taxonomic-names">#</a></h3>
<h4 id="this-is-a-common-use-case-for-ecologistsevolutionary-biologists-or-at-least-should-be-that-is-species-names-you-have-for-your-own-data-or-when-using-others-data-could-be-old-names---and-if-you-need-the-newest-names-for-your-species-list-how-can-you-make-this-as-painless-as-possible-you-can-query-taxonomic-data-from-many-different-sources-with-taxize">This is a common use case for ecologists/evolutionary biologists, or at least should be. That is, species names you have for your own data, or when using other&rsquo;s data, could be old names - and if you need the newest names for your species list, how can you make this as painless as possible? You can query taxonomic data from many different sources with <code>taxize</code>.<a hidden class="anchor" aria-hidden="true" href="#this-is-a-common-use-case-for-ecologistsevolutionary-biologists-or-at-least-should-be-that-is-species-names-you-have-for-your-own-data-or-when-using-others-data-could-be-old-names---and-if-you-need-the-newest-names-for-your-species-list-how-can-you-make-this-as-painless-as-possible-you-can-query-taxonomic-data-from-many-different-sources-with-taxize">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># The iPlantCollaborative provides access via API to their taxonomic name</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># resolution service (TNRS)</span>
</span></span><span style="display:flex;"><span>mynames <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;shorea robusta&#34;</span>, <span style="color:#e6db74">&#34;pandanus patina&#34;</span>, <span style="color:#e6db74">&#34;oryza sativa&#34;</span>, <span style="color:#e6db74">&#34;durio zibethinus&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;rubus ulmifolius&#34;</span>, <span style="color:#e6db74">&#34;asclepias curassavica&#34;</span>, <span style="color:#e6db74">&#34;pistacia lentiscus&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">iplant_tnrsmatch</span>(retrieve <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;all&#34;</span>, taxnames <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;helianthus annuus&#34;</span>, <span style="color:#e6db74">&#34;acacia&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;gossypium&#34;</span>), output <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;names&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>       AcceptedName   MatchFam MatchGenus MatchScore    Accept<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> Helianthus annuus Asteraceae Helianthus          <span style="color:#ae81ff">1</span> No opinion
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>            Acacia   Fabaceae     Acacia          <span style="color:#ae81ff">1</span> No opinion
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>                                  Acacia          <span style="color:#ae81ff">1</span> No opinion
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>         Gossypium  Malvaceae  Gossypium          <span style="color:#ae81ff">1</span> No opinion
</span></span><span style="display:flex;"><span>     SubmittedNames
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> helianthus annuus
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>            acacia
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>            acacia
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>         gossypium
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The global names resolver is another attempt at this, hitting many</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># different data sources</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">gnr_resolve</span>(names <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Helianthus annuus&#34;</span>, <span style="color:#e6db74">&#34;Homo sapiens&#34;</span>), returndf <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>   data_source_id    submitted_name       name_string score
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>               <span style="color:#ae81ff">4</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>              <span style="color:#ae81ff">10</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>              <span style="color:#ae81ff">12</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>             <span style="color:#ae81ff">110</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>            <span style="color:#ae81ff">159</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">13</span>            <span style="color:#ae81ff">166</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">15</span>            <span style="color:#ae81ff">169</span> Helianthus annuus Helianthus annuus <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>               <span style="color:#ae81ff">4</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>              <span style="color:#ae81ff">10</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>              <span style="color:#ae81ff">12</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>             <span style="color:#ae81ff">107</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>             <span style="color:#ae81ff">122</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>            <span style="color:#ae81ff">123</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>            <span style="color:#ae81ff">159</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">14</span>            <span style="color:#ae81ff">168</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">16</span>            <span style="color:#ae81ff">169</span>      Homo sapiens      Homo sapiens <span style="color:#ae81ff">0.988</span>
</span></span><span style="display:flex;"><span>                     title
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                     NCBI
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>                 Freebase
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>                      EOL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>     Illinois Wildflowers
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>                 CU<span style="color:#f92672">*</span>STAR
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">13</span>                   nlbif
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">15</span>           uBio NameBank
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>                     NCBI
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>                 Freebase
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>                      EOL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>                AskNature
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>                 BioPedia
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>                   AnAge
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>                 CU<span style="color:#f92672">*</span>STAR
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">14</span> Index to Organism Names
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">16</span>           uBio NameBank
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># We can hit the Plantminer API too</span>
</span></span><span style="display:flex;"><span>plants <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Myrcia lingua&#34;</span>, <span style="color:#e6db74">&#34;Myrcia bella&#34;</span>, <span style="color:#e6db74">&#34;Ocotea pulchella&#34;</span>, <span style="color:#e6db74">&#34;Miconia&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Coffea arabica var. amarella&#34;</span>, <span style="color:#e6db74">&#34;Bleh&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plantminer</span>(plants)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>Myrcia lingua 
</span></span><span style="display:flex;"><span>Myrcia bella 
</span></span><span style="display:flex;"><span>Ocotea pulchella 
</span></span><span style="display:flex;"><span>Miconia 
</span></span><span style="display:flex;"><span>Coffea arabica var. amarella 
</span></span><span style="display:flex;"><span>Bleh 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>              fam   genus                    sp             author
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       Myrtaceae  Myrcia                <span style="color:#a6e22e">lingua   </span>(O. Berg) Mattos
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       Myrtaceae  Myrcia                 bella           Cambess.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>       Lauraceae  Ocotea             <span style="color:#a6e22e">pulchella </span>(Nees <span style="color:#f92672">&amp;</span> Mart.) Mez
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span> Melastomataceae Miconia                    <span style="color:#66d9ef">NA</span>        Ruiz <span style="color:#f92672">&amp;</span> Pav.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       Rubiaceae  Coffea arabica var. amarella        A. Froehner
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>              <span style="color:#66d9ef">NA</span>    Bleh                    <span style="color:#66d9ef">NA</span>                 <span style="color:#66d9ef">NA</span>
</span></span><span style="display:flex;"><span>            source source.id   status confidence suggestion       database
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>              TRO <span style="color:#ae81ff">100227036</span>       <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>       Tropicos
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>             WCSP    <span style="color:#ae81ff">131057</span> Accepted          H         <span style="color:#66d9ef">NA</span> The Plant List
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> <span style="color:#a6e22e">WCSP </span>(<span style="color:#66d9ef">in</span> review)    <span style="color:#ae81ff">989758</span> Accepted          M         <span style="color:#66d9ef">NA</span> The Plant List
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>              TRO  <span style="color:#ae81ff">40018467</span>       <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>       Tropicos
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>              TRO <span style="color:#ae81ff">100170231</span>       <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>       Tropicos
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>               <span style="color:#66d9ef">NA</span>        <span style="color:#66d9ef">NA</span>       <span style="color:#66d9ef">NA</span>         <span style="color:#66d9ef">NA</span>       Baea             <span style="color:#66d9ef">NA</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># We made a light wrapper around the Taxonstand package to search</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Theplantlist.org too</span>
</span></span><span style="display:flex;"><span>splist <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Heliathus annuus&#34;</span>, <span style="color:#e6db74">&#34;Abies procera&#34;</span>, <span style="color:#e6db74">&#34;Poa annua&#34;</span>, <span style="color:#e6db74">&#34;Platanus occidentalis&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Carex abrupta&#34;</span>, <span style="color:#e6db74">&#34;Arctostaphylos canescens&#34;</span>, <span style="color:#e6db74">&#34;Ocimum basilicum&#34;</span>, <span style="color:#e6db74">&#34;Vicia faba&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Quercus kelloggii&#34;</span>, <span style="color:#e6db74">&#34;Lactuca serriola&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tpl_search</span>(taxon <span style="color:#f92672">=</span> splist)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>            Genus      Species Infraspecific Plant.Name.Index
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       Heliathus       annuus                          <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>           Abies      procera                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>             Poa        annua                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>        Platanus occidentalis                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>           Carex      abrupta                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>  Arctostaphylos    canescens                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>          Ocimum    basilicum                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>           Vicia         faba                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>         Quercus    kelloggii                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>        Lactuca     serriola                           <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span>   Taxonomic.status      Family      New.Genus  New.Species
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                                    Heliathus       annuus
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>          Accepted    Pinaceae          Abies      procera
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>          Accepted     Poaceae            Poa        annua
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>          Accepted Platanaceae       Platanus occidentalis
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>          Accepted  Cyperaceae          Carex      abrupta
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>          Accepted   Ericaceae Arctostaphylos    canescens
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>          Accepted   Lamiaceae         Ocimum    basilicum
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>          Accepted Leguminosae          Vicia         faba
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>          Accepted    Fagaceae        Quercus    kelloggii
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>         Accepted  Compositae        Lactuca     serriola
</span></span><span style="display:flex;"><span>   New.Infraspecific Authority  Typo WFormat
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                              <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>                       Rehder <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>                           L. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>                           L. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>               <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">NA</span><span style="color:#f92672">&gt;</span>     Mack. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>                       Eastw. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>                           L. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>                           L. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>               <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">NA</span><span style="color:#f92672">&gt;</span>     Newb. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>                          L. <span style="color:#66d9ef">FALSE</span>   <span style="color:#66d9ef">FALSE</span>
</span></span></code></pre></div><hr>
<h3 id="taxonomic-hierarchies">Taxonomic hierarchies<a hidden class="anchor" aria-hidden="true" href="#taxonomic-hierarchies">#</a></h3>
<h4 id="i-often-want-the-full-taxonomic-hierarchy-for-a-set-of-species-that-is-give-me-the-family-order-class-etc-for-my-list-of-species-there-are-two-different-easy-ways-to-do-this-with-taxize-the-first-example-uses-eol">I often want the full taxonomic hierarchy for a set of species. That is, give me the family, order, class, etc. for my list of species. There are two different easy ways to do this with <code>taxize</code>. The first example uses EOL.<a hidden class="anchor" aria-hidden="true" href="#i-often-want-the-full-taxonomic-hierarchy-for-a-set-of-species-that-is-give-me-the-family-order-class-etc-for-my-list-of-species-there-are-two-different-easy-ways-to-do-this-with-taxize-the-first-example-uses-eol">#</a></h4>
<hr>
<h4 id="using-eol">Using EOL.<a hidden class="anchor" aria-hidden="true" href="#using-eol">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>pageid <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">eol_search</span>(<span style="color:#e6db74">&#34;Quercus douglasii&#34;</span>)<span style="color:#f92672">$</span>id[1]  <span style="color:#75715e"># first need to search for the taxon&#39;s page on EOL</span>
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">eol_pages</span>(taxonconceptID <span style="color:#f92672">=</span> pageid)  <span style="color:#75715e"># then we nee to get the taxon ID used by EOL</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Notice that there are multiple different sources you can pull the</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># hierarchy from. Note even that you can get the hierarchy from the ITIS</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># service via this EOL API.</span>
</span></span><span style="display:flex;"><span>out
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  identifier                 scientificName
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   <span style="color:#ae81ff">46203061</span> Quercus douglasii Hook. <span style="color:#f92672">&amp;</span> Arn.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   <span style="color:#ae81ff">48373995</span> Quercus douglasii Hook. <span style="color:#f92672">&amp;</span> Arn.
</span></span><span style="display:flex;"><span>                                  nameAccordingTo sourceIdentfier
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>  Integrated Taxonomic Information <span style="color:#a6e22e">System </span>(ITIS)           <span style="color:#ae81ff">19322</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> Species <span style="color:#ae81ff">2000</span> <span style="color:#f92672">&amp;</span> ITIS Catalogue of Life<span style="color:#f92672">:</span> May <span style="color:#ae81ff">2012</span>         <span style="color:#ae81ff">9723391</span>
</span></span><span style="display:flex;"><span>  taxonRank
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   Species
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   Species
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Then the hierarchy!</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">eol_hierarchy</span>(out[out<span style="color:#f92672">$</span>nameAccordingTo <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Species 2000 &amp; ITIS Catalogue of Life: May 2012&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;identifier&#34;</span>])
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  sourceIdentifier  taxonID parentNameUsageID taxonConceptID
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">11017504</span> <span style="color:#ae81ff">48276627</span>                 <span style="color:#ae81ff">0</span>            <span style="color:#ae81ff">281</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>         <span style="color:#ae81ff">11017505</span> <span style="color:#ae81ff">48276628</span>          <span style="color:#ae81ff">48276627</span>            <span style="color:#ae81ff">282</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>         <span style="color:#ae81ff">11017506</span> <span style="color:#ae81ff">48276629</span>          <span style="color:#ae81ff">48276628</span>            <span style="color:#ae81ff">283</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>         <span style="color:#ae81ff">11022500</span> <span style="color:#ae81ff">48373354</span>          <span style="color:#ae81ff">48276629</span>           <span style="color:#ae81ff">4184</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>         <span style="color:#ae81ff">11025284</span> <span style="color:#ae81ff">48373677</span>          <span style="color:#ae81ff">48373354</span>           <span style="color:#ae81ff">4197</span>
</span></span><span style="display:flex;"><span>  scientificName taxonRank
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>        Plantae   kingdom
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>  Magnoliophyta    phylum
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>  Magnoliopsida     class
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>        Fagales     order
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       Fagaceae    family
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">eol_hierarchy</span>(out[out<span style="color:#f92672">$</span>nameAccordingTo <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Integrated Taxonomic Information System (ITIS)&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;identifier&#34;</span>])  <span style="color:#75715e"># and from ITIS, slightly different than ITIS output below, which includes taxa all the way down.</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>   sourceIdentifier  taxonID parentNameUsageID taxonConceptID
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>            <span style="color:#ae81ff">202422</span> <span style="color:#ae81ff">46150613</span>                 <span style="color:#ae81ff">0</span>            <span style="color:#ae81ff">281</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>            <span style="color:#ae81ff">846492</span> <span style="color:#ae81ff">46159776</span>          <span style="color:#ae81ff">46150613</span>        <span style="color:#ae81ff">8654492</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>            <span style="color:#ae81ff">846494</span> <span style="color:#ae81ff">46161961</span>          <span style="color:#ae81ff">46159776</span>       <span style="color:#ae81ff">28818077</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>            <span style="color:#ae81ff">846496</span> <span style="color:#ae81ff">46167532</span>          <span style="color:#ae81ff">46161961</span>           <span style="color:#ae81ff">4494</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>            <span style="color:#ae81ff">846504</span> <span style="color:#ae81ff">46169010</span>          <span style="color:#ae81ff">46167532</span>       <span style="color:#ae81ff">28825126</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>            <span style="color:#ae81ff">846505</span> <span style="color:#ae81ff">46169011</span>          <span style="color:#ae81ff">46169010</span>            <span style="color:#ae81ff">282</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>             <span style="color:#ae81ff">18063</span> <span style="color:#ae81ff">46169012</span>          <span style="color:#ae81ff">46169011</span>            <span style="color:#ae81ff">283</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>            <span style="color:#ae81ff">846548</span> <span style="color:#ae81ff">46202954</span>          <span style="color:#ae81ff">46169012</span>       <span style="color:#ae81ff">28859070</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>             <span style="color:#ae81ff">19273</span> <span style="color:#ae81ff">46202955</span>          <span style="color:#ae81ff">46202954</span>           <span style="color:#ae81ff">4184</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>            <span style="color:#ae81ff">19275</span> <span style="color:#ae81ff">46203022</span>          <span style="color:#ae81ff">46202955</span>           <span style="color:#ae81ff">4197</span>
</span></span><span style="display:flex;"><span>    scientificName     taxonRank
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>          Plantae       kingdom
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   Viridaeplantae    subkingdom
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>     Streptophyta  infrakingdom
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     Tracheophyta      division
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>  Spermatophytina   subdivision
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>     Angiospermae infradivision
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>    Magnoliopsida         class
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>          Rosanae    superorder
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>          Fagales         order
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>        Fagaceae        family
</span></span></code></pre></div><hr>
<h4 id="and-getting-a-taxonomic-hierarchy-using-itis">And getting a taxonomic hierarchy using ITIS.<a hidden class="anchor" aria-hidden="true" href="#and-getting-a-taxonomic-hierarchy-using-itis">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># First, get the taxonomic serial number (TSN) that ITIS uses</span>
</span></span><span style="display:flex;"><span>mytsn <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_tsn</span>(<span style="color:#e6db74">&#34;Quercus douglasii&#34;</span>, <span style="color:#e6db74">&#34;sciname&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Quercus douglasii &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the full taxonomic hierarchy for a taxon from the TSN</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">itis</span>(mytsn, <span style="color:#e6db74">&#34;getfullhierarchyfromtsn&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>`1`
</span></span><span style="display:flex;"><span>        parentName parentTsn      rankName         taxonName    tsn
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                                  Kingdom           Plantae <span style="color:#ae81ff">202422</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>          Plantae    <span style="color:#ae81ff">202422</span>    Subkingdom    Viridaeplantae <span style="color:#ae81ff">846492</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>   Viridaeplantae    <span style="color:#ae81ff">846492</span>  Infrakingdom      Streptophyta <span style="color:#ae81ff">846494</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     Streptophyta    <span style="color:#ae81ff">846494</span>      Division      Tracheophyta <span style="color:#ae81ff">846496</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>     Tracheophyta    <span style="color:#ae81ff">846496</span>   Subdivision   Spermatophytina <span style="color:#ae81ff">846504</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>  Spermatophytina    <span style="color:#ae81ff">846504</span> Infradivision      Angiospermae <span style="color:#ae81ff">846505</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>     Angiospermae    <span style="color:#ae81ff">846505</span>         Class     Magnoliopsida  <span style="color:#ae81ff">18063</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>    Magnoliopsida     <span style="color:#ae81ff">18063</span>    Superorder           Rosanae <span style="color:#ae81ff">846548</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>          Rosanae    <span style="color:#ae81ff">846548</span>         Order           Fagales  <span style="color:#ae81ff">19273</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>         Fagales     <span style="color:#ae81ff">19273</span>        Family          Fagaceae  <span style="color:#ae81ff">19275</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>        Fagaceae     <span style="color:#ae81ff">19275</span>         Genus           Quercus  <span style="color:#ae81ff">19276</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>         Quercus     <span style="color:#ae81ff">19276</span>       Species Quercus douglasii  <span style="color:#ae81ff">19322</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># But this can be even easier!</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">classification</span>(<span style="color:#a6e22e">get_tsn</span>(<span style="color:#e6db74">&#34;Quercus douglasii&#34;</span>))  <span style="color:#75715e"># Boom!</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Retrieving data <span style="color:#66d9ef">for</span> species <span style="color:#e6db74">&#39; Quercus douglasii &#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>`1`
</span></span><span style="display:flex;"><span>        parentName parentTsn      rankName         taxonName    tsn
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                                  Kingdom           Plantae <span style="color:#ae81ff">202422</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>          Plantae    <span style="color:#ae81ff">202422</span>    Subkingdom    Viridaeplantae <span style="color:#ae81ff">846492</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>   Viridaeplantae    <span style="color:#ae81ff">846492</span>  Infrakingdom      Streptophyta <span style="color:#ae81ff">846494</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>     Streptophyta    <span style="color:#ae81ff">846494</span>      Division      Tracheophyta <span style="color:#ae81ff">846496</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>     Tracheophyta    <span style="color:#ae81ff">846496</span>   Subdivision   Spermatophytina <span style="color:#ae81ff">846504</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>  Spermatophytina    <span style="color:#ae81ff">846504</span> Infradivision      Angiospermae <span style="color:#ae81ff">846505</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>     Angiospermae    <span style="color:#ae81ff">846505</span>         Class     Magnoliopsida  <span style="color:#ae81ff">18063</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>    Magnoliopsida     <span style="color:#ae81ff">18063</span>    Superorder           Rosanae <span style="color:#ae81ff">846548</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>          Rosanae    <span style="color:#ae81ff">846548</span>         Order           Fagales  <span style="color:#ae81ff">19273</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>         Fagales     <span style="color:#ae81ff">19273</span>        Family          Fagaceae  <span style="color:#ae81ff">19275</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>        Fagaceae     <span style="color:#ae81ff">19275</span>         Genus           Quercus  <span style="color:#ae81ff">19276</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>         Quercus     <span style="color:#ae81ff">19276</span>       Species Quercus douglasii  <span style="color:#ae81ff">19322</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># You can also do this easy-peasy route to a taxonomic hierarchy using</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># uBio</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">classification</span>(<span style="color:#a6e22e">get_uid</span>(<span style="color:#e6db74">&#34;Ornithorhynchus anatinus&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#f92672">$</span>`1`
</span></span><span style="display:flex;"><span>       ScientificName         Rank    UID
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>  cellular organisms      no rank <span style="color:#ae81ff">131567</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>           Eukaryota superkingdom   <span style="color:#ae81ff">2759</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>        Opisthokonta      no rank  <span style="color:#ae81ff">33154</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>             Metazoa      kingdom  <span style="color:#ae81ff">33208</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>           Eumetazoa      no rank   <span style="color:#ae81ff">6072</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>           Bilateria      no rank  <span style="color:#ae81ff">33213</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>           Coelomata      no rank  <span style="color:#ae81ff">33316</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>       Deuterostomia      no rank  <span style="color:#ae81ff">33511</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>            Chordata       phylum   <span style="color:#ae81ff">7711</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>           Craniata    subphylum  <span style="color:#ae81ff">89593</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11</span>         Vertebrata      no rank   <span style="color:#ae81ff">7742</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">12</span>      Gnathostomata   superclass   <span style="color:#ae81ff">7776</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">13</span>         Teleostomi      no rank <span style="color:#ae81ff">117570</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">14</span>       Euteleostomi      no rank <span style="color:#ae81ff">117571</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">15</span>      Sarcopterygii      no rank   <span style="color:#ae81ff">8287</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">16</span>          Tetrapoda      no rank  <span style="color:#ae81ff">32523</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">17</span>            Amniota      no rank  <span style="color:#ae81ff">32524</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">18</span>           Mammalia        class  <span style="color:#ae81ff">40674</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">19</span>        Prototheria      no rank   <span style="color:#ae81ff">9254</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">20</span>        Monotremata        order   <span style="color:#ae81ff">9255</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">21</span>  Ornithorhynchidae       family   <span style="color:#ae81ff">9256</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">22</span>    Ornithorhynchus        genus   <span style="color:#ae81ff">9257</span>
</span></span></code></pre></div><hr>
<h3 id="sequences">Sequences?<a hidden class="anchor" aria-hidden="true" href="#sequences">#</a></h3>
<h4 id="while-you-are-at-doing-taxonomic-stuff-you-often-wonder-hmmm-i-wonder-if-there-are-any-sequence-data-available-for-my-species-so-you-can-use-get_seqs-to-search-for-specific-genes-for-a-species-and-get_genes_avail-to-find-out-what-genes-are-available-for-a-certain-species-these-functions-search-for-data-on-ncbihttpwwwncbinlmnihgov">While you are at doing taxonomic stuff, you often wonder &ldquo;hmmm, I wonder if there are any sequence data available for my species?&rdquo; So, you can use <code>get_seqs</code> to search for specific genes for a species, and <code>get_genes_avail</code> to find out what genes are available for a certain species. These functions search for data on <a href="http://www.ncbi.nlm.nih.gov/">NCBI</a>.<a hidden class="anchor" aria-hidden="true" href="#while-you-are-at-doing-taxonomic-stuff-you-often-wonder-hmmm-i-wonder-if-there-are-any-sequence-data-available-for-my-species-so-you-can-use-get_seqs-to-search-for-specific-genes-for-a-species-and-get_genes_avail-to-find-out-what-genes-are-available-for-a-certain-species-these-functions-search-for-data-on-ncbihttpwwwncbinlmnihgov">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Get sequences (sequence is provied in output, but hiding here for</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># brevity). What&#39;s nice about this is that it gets the longest sequence</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># avaialable for the gene you searched for, and if there isn&#39;t anything</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># available, it lets you get a sequence from a congener if you set</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># getrelated=TRUE. The last column in the output data.frame also tells you</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># what species the sequence is from.</span>
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_seqs</span>(taxon_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Acipenser brevirostrum&#34;</span>, gene <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;5S rRNA&#34;</span>), 
</span></span><span style="display:flex;"><span>    seqrange <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1:3000&#34;</span>, getrelated <span style="color:#f92672">=</span> T, writetodf <span style="color:#f92672">=</span> F)
</span></span><span style="display:flex;"><span>out[, <span style="color:#f92672">!</span><span style="color:#a6e22e">names</span>(out) <span style="color:#f92672">%in%</span> <span style="color:#e6db74">&#34;sequence&#34;</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>                   taxon                                         gene_desc
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> Acipenser brevirostrum Acipenser brevirostrum <span style="color:#ae81ff">5</span>S rRNA gene, clone BRE92A
</span></span><span style="display:flex;"><span>     gi_no     acc_no length                 spused
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">60417159</span> AJ745069.1    <span style="color:#ae81ff">121</span> Acipenser brevirostrum
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Search for available sequences</span>
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_genes_avail</span>(taxon_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Umbra limi&#34;</span>, seqrange <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1:2000&#34;</span>, getrelated <span style="color:#f92672">=</span> F)
</span></span><span style="display:flex;"><span>out<span style="color:#a6e22e">[grep</span>(<span style="color:#e6db74">&#34;RAG1&#34;</span>, out<span style="color:#f92672">$</span>genesavail, ignore.case <span style="color:#f92672">=</span> T), ]  <span style="color:#75715e"># does the string &#39;RAG1&#39; exist in any of the gene names</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>        spused length
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">414</span> Umbra limi    <span style="color:#ae81ff">732</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">427</span> Umbra limi    <span style="color:#ae81ff">959</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">434</span> Umbra limi   <span style="color:#ae81ff">1631</span>
</span></span><span style="display:flex;"><span>                                                                            genesavail
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">414</span> isolate UlimA recombinase activating protein <span style="color:#ae81ff">1</span> (rag1) gene, exon <span style="color:#ae81ff">3</span> and partial cds
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">427</span>           recombination<span style="color:#f92672">-</span>activating protein <span style="color:#ae81ff">1</span> (RAG1) gene, intron <span style="color:#ae81ff">2</span> and partial cds
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">434</span>                        recombination<span style="color:#f92672">-</span>activating protein <span style="color:#ae81ff">1</span> (RAG1) gene, partial cds
</span></span><span style="display:flex;"><span>    predicted
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">414</span>  JX190826
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">427</span>  AY459526
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">434</span>  AY380548
</span></span></code></pre></div><hr>
<p>Get the .Rmd file used to create this post <a href="https://github.com/sckott/sckott.github.com/tree/master/_drafts/2012-12-06-taxize.Rmd">at my github account</a> - or <a href="https://github.com/sckott/sckott.github.com/tree/master/_posts/2012-12-06-taxize.md">.md file</a>.</p>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/r/">R</a></li>
      <li><a href="http://localhost:1313/tags/open-source/">Open Source</a></li>
      <li><a href="http://localhost:1313/tags/data/">Data</a></li>
      <li><a href="http://localhost:1313/tags/taxonomy/">Taxonomy</a></li>
      <li><a href="http://localhost:1313/tags/ropensci/">Ropensci</a></li>
      <li><a href="http://localhost:1313/tags/ritis/">Ritis</a></li>
      <li><a href="http://localhost:1313/tags/taxize/">Taxize</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:1313/">Recology</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
