<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>GBIF biodiversity data from R - more functions | Recology</title>
<meta name="keywords" content="R, open access, data, GBIF, biodiversity, macroecology, ropensci">
<meta name="description" content="UPDATE: In response to Jarrett&rsquo;s query I laid out a separate use case in which you may want to query by higher taxonomic rankings than species. See below. In addition, added examples of querying by location in reply to comments by seminym.
We have been working on an R package to get GBIF data from R, with the stable version available through CRAN, and the development version available on GitHub at https://github.">
<meta name="author" content="Scott Chamberlain">
<link rel="canonical" href="http://localhost:1313/2012/10/rgbif-newfxns/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f4cda22486791d430ef692108ba33a982c3c552eca57e99456bb55aa4bd22568.css" integrity="sha256-9M2iJIZ5HUMO9pIQi6M6mCw8VS7KV&#43;mUVrtVqkvSJWg=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/2012/10/rgbif-newfxns/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Recology (Alt + H)">Recology</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/index.xml" title="RSS">
                    <span>RSS</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      GBIF biodiversity data from R - more functions
    </h1>
    <div class="post-meta"><span title='2012-10-08 00:00:00 +0000 UTC'>October 8, 2012</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Scott Chamberlain

</div>
  </header> 
  <div class="post-content"><blockquote>
<p>UPDATE: In response to Jarrett&rsquo;s query I laid out a separate use case in which you may want to query by higher taxonomic rankings than species. See below.  In addition, added examples of querying by location in reply to comments by seminym.</p>
</blockquote>
<p>We have been working on an R package to get GBIF data from R, with the stable version available through CRAN, and the development version available on GitHub at <a href="https://github.com/rgbif">https://github.com/rgbif</a></p>
<p>We had a Google Summer of code stuent work on the package this summer - you can see his work on the package over at his GitHub page <a href="">here</a>.  We have added some new functionality since his work, and would like to show it off.</p>
<h3 id="install">Install<a hidden class="anchor" aria-hidden="true" href="#install">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># install_github(&#39;rgbif&#39;, &#39;ropensci&#39;) # uncomment if not already installed</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(rgbif)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(plyr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(XML)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(httr)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(maps)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggplot2)
</span></span></code></pre></div><h3 id="get-taxonomic-information-on-a-specific-taxon-or-taxa-in-gbif-by-their-taxon-concept-keys">Get taxonomic information on a specific taxon or taxa in GBIF by their taxon concept keys.<a hidden class="anchor" aria-hidden="true" href="#get-taxonomic-information-on-a-specific-taxon-or-taxa-in-gbif-by-their-taxon-concept-keys">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>(keys <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">taxonsearch</span>(scientificname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Puma concolor&#34;</span>))  <span style="color:#75715e"># many matches to this search</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span> [1] <span style="color:#e6db74">&#34;51780668&#34;</span> <span style="color:#e6db74">&#34;51758018&#34;</span> <span style="color:#e6db74">&#34;50010499&#34;</span> <span style="color:#e6db74">&#34;51773067&#34;</span> <span style="color:#e6db74">&#34;51078815&#34;</span> <span style="color:#e6db74">&#34;51798065&#34;</span>
</span></span><span style="display:flex;"><span> [7] <span style="color:#e6db74">&#34;51088007&#34;</span> <span style="color:#e6db74">&#34;50410780&#34;</span> <span style="color:#e6db74">&#34;50305290&#34;</span> <span style="color:#e6db74">&#34;51791438&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">taxonget</span>(keys[[1]])  <span style="color:#75715e"># let&#39;s get the first one - the first row in the data.frame is the one we searched for (51780668)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>[[1]]
</span></span><span style="display:flex;"><span>                    sciname taxonconceptkeys       rank
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>             Puma concolor         <span style="color:#ae81ff">51780668</span>    species
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>                      Puma         <span style="color:#ae81ff">51780667</span>      genus
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>                   Felidae         <span style="color:#ae81ff">51780651</span>     family
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>                 Carnivora         <span style="color:#ae81ff">51780613</span>      order
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>                  Mammalia         <span style="color:#ae81ff">51780547</span>      class
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>                  Chordata         <span style="color:#ae81ff">51775774</span>     phylum
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>                  Animalia         <span style="color:#ae81ff">51775773</span>    kingdom
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span> Puma concolor californica         <span style="color:#ae81ff">51780669</span> subspecies
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>   Puma concolor improcera         <span style="color:#ae81ff">51780670</span> subspecies
</span></span></code></pre></div><h3 id="the-occurrencedensity-function-was-renamed-to-densitylist-because-it-is-in-the-density-api-service-not-the-occurrence-api-service--you-can-use-densitylist-to-get-a-dataframe-of-total-occurrence-counts-by-one-degree-cell-for-a-single-taxon-country-dataset-data-publisher-or-data-network--just-a-quick-reminder-of-what-the-function-can-do">The <code>occurrencedensity</code> function was renamed to <code>densitylist</code> because it is in the <code>density</code> API service, not the <code>occurrence</code> API service.  You can use <code>densitylist</code> to get a data.frame of total occurrence counts by one-degree cell for a single taxon, country, dataset, data publisher or data network.  Just a quick reminder of what the function can do:<a hidden class="anchor" aria-hidden="true" href="#the-occurrencedensity-function-was-renamed-to-densitylist-because-it-is-in-the-density-api-service-not-the-occurrence-api-service--you-can-use-densitylist-to-get-a-dataframe-of-total-occurrence-counts-by-one-degree-cell-for-a-single-taxon-country-dataset-data-publisher-or-data-network--just-a-quick-reminder-of-what-the-function-can-do">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(<span style="color:#a6e22e">densitylist</span>(originisocountrycode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CA&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  cellid minLatitude maxLatitude minLongitude maxLongitude count
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">46913</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-67</span>          <span style="color:#ae81ff">-66</span>    <span style="color:#ae81ff">44</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">46914</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-66</span>          <span style="color:#ae81ff">-65</span>   <span style="color:#ae81ff">907</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">46915</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-65</span>          <span style="color:#ae81ff">-64</span>   <span style="color:#ae81ff">510</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">46916</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-64</span>          <span style="color:#ae81ff">-63</span>   <span style="color:#ae81ff">645</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">46917</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-63</span>          <span style="color:#ae81ff">-62</span>    <span style="color:#ae81ff">56</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">46918</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-62</span>          <span style="color:#ae81ff">-61</span>   <span style="color:#ae81ff">143</span>
</span></span></code></pre></div><h3 id="using-a-related-function-density_spplist-you-can-get-a-species-list-by-one-degree-cell-as-well">Using a related function, <code>density_spplist</code>, you can get a species list by one-degree cell as well.<a hidden class="anchor" aria-hidden="true" href="#using-a-related-function-density_spplist-you-can-get-a-species-list-by-one-degree-cell-as-well">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Get a species list by cell, choosing one at random</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">density_spplist</span>(originisocountrycode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CO&#34;</span>, spplist <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;random&#34;</span>)[1<span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span> [1] <span style="color:#e6db74">&#34;Abarema laeta (Benth.) Barneby &amp; J.W.Grimes&#34;</span>
</span></span><span style="display:flex;"><span> [2] <span style="color:#e6db74">&#34;Abuta grandifolia (Mart.) Sandwith&#34;</span>         
</span></span><span style="display:flex;"><span> [3] <span style="color:#e6db74">&#34;Acalypha cuneata Poepp.&#34;</span>                    
</span></span><span style="display:flex;"><span> [4] <span style="color:#e6db74">&#34;Acalypha diversifolia Jacq.&#34;</span>                
</span></span><span style="display:flex;"><span> [5] <span style="color:#e6db74">&#34;Acalypha macrostachya Jacq.&#34;</span>                
</span></span><span style="display:flex;"><span> [6] <span style="color:#e6db74">&#34;Acalypha stachyura Pax&#34;</span>                     
</span></span><span style="display:flex;"><span> [7] <span style="color:#e6db74">&#34;Acanthoscelio acutus&#34;</span>                       
</span></span><span style="display:flex;"><span> [8] <span style="color:#e6db74">&#34;Accipiter collaris&#34;</span>                         
</span></span><span style="display:flex;"><span> [9] <span style="color:#e6db74">&#34;Actitis macularia&#34;</span>                          
</span></span><span style="display:flex;"><span>[10] <span style="color:#e6db74">&#34;Adelobotrys klugii Wurdack&#34;</span>                 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># density_spplist(originisocountrycode = &#39;CO&#39;, spplist = &#39;r&#39;) # can</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># abbreviate the `spplist` argument</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get a species list by cell, choosing the one with the greatest no. of</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># records</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">density_spplist</span>(originisocountrycode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CO&#34;</span>, spplist <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;great&#34;</span>)[1<span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>]  <span style="color:#75715e"># great is abbreviated from `greatest`</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span> [1] <span style="color:#e6db74">&#34;Acanthaceae Juss.&#34;</span>                
</span></span><span style="display:flex;"><span> [2] <span style="color:#e6db74">&#34;Accipitridae sp.&#34;</span>                 
</span></span><span style="display:flex;"><span> [3] <span style="color:#e6db74">&#34;Accipitriformes/Falconiformes sp.&#34;</span>
</span></span><span style="display:flex;"><span> [4] <span style="color:#e6db74">&#34;Apodidae sp.&#34;</span>                     
</span></span><span style="display:flex;"><span> [5] <span style="color:#e6db74">&#34;Apodidae sp. (large swift sp.)&#34;</span>   
</span></span><span style="display:flex;"><span> [6] <span style="color:#e6db74">&#34;Apodidae sp. (small swift sp.)&#34;</span>   
</span></span><span style="display:flex;"><span> [7] <span style="color:#e6db74">&#34;Arctiinae&#34;</span>                        
</span></span><span style="display:flex;"><span> [8] <span style="color:#e6db74">&#34;Asteraceae Bercht. &amp; J. Presl&#34;</span>    
</span></span><span style="display:flex;"><span> [9] <span style="color:#e6db74">&#34;Asteraceae sp. 1&#34;</span>                 
</span></span><span style="display:flex;"><span>[10] <span style="color:#e6db74">&#34;Asteraceae sp. 6&#34;</span>                 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Can also get a data.frame with counts instead of the species list</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">density_spplist</span>(originisocountrycode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CO&#34;</span>, spplist <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;great&#34;</span>, listcount <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;counts&#34;</span>)[1<span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>, 
</span></span><span style="display:flex;"><span>    ]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>                              names_ count
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>                  Acanthaceae Juss.     <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>                   Accipitridae sp.     <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>  Accipitriformes<span style="color:#f92672">/</span>Falconiformes sp.     <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>                       Apodidae sp.     <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>     Apodidae <span style="color:#a6e22e">sp. </span>(large swift sp.)     <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>     Apodidae <span style="color:#a6e22e">sp. </span>(small swift sp.)     <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>                          Arctiinae     <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>      Asteraceae Bercht. <span style="color:#f92672">&amp;</span> J. Presl     <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9</span>                   Asteraceae sp. <span style="color:#ae81ff">1</span>     <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">10</span>                  Asteraceae sp. <span style="color:#ae81ff">6</span>    <span style="color:#ae81ff">10</span>
</span></span></code></pre></div><h3 id="you-can-now-map-point-results-from-fxns-occurrencelist-and-those-from-densitylist-which-plots-them-as-points-or-as-tiles-respectively--point-map-using-output-from-occurrencelist">You can now map point results, from fxns <code>occurrencelist</code> and those from <code>densitylist</code>, which plots them as points or as tiles, respectively.  Point map, using output from occurrencelist.<a hidden class="anchor" aria-hidden="true" href="#you-can-now-map-point-results-from-fxns-occurrencelist-and-those-from-densitylist-which-plots-them-as-points-or-as-tiles-respectively--point-map-using-output-from-occurrencelist">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">occurrencelist</span>(scientificname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Puma concolor&#34;</span>, coordinatestatus <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>, 
</span></span><span style="display:flex;"><span>    maxresults <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>, latlongdf <span style="color:#f92672">=</span> T)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">gbifmap</span>(input <span style="color:#f92672">=</span> out)  <span style="color:#75715e"># make a map, plotting on world map</span>
</span></span></code></pre></div><p><img loading="lazy" src="/gbifmap1.png" alt="center"  />
</p>
<h3 id="point-map-using-output-from-occurrencelist-with-many-species-plotted-as-different-colors">Point map, using output from occurrencelist, with many species plotted as different colors<a hidden class="anchor" aria-hidden="true" href="#point-map-using-output-from-occurrencelist-with-many-species-plotted-as-different-colors">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>splist <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Accipiter erythronemius&#34;</span>, <span style="color:#e6db74">&#34;Junco hyemalis&#34;</span>, <span style="color:#e6db74">&#34;Aix sponsa&#34;</span>, <span style="color:#e6db74">&#34;Buteo regalis&#34;</span>)
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lapply</span>(splist, <span style="color:#66d9ef">function</span>(x) <span style="color:#a6e22e">occurrencelist</span>(x, coordinatestatus <span style="color:#f92672">=</span> T, maxresults <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>, 
</span></span><span style="display:flex;"><span>    latlongdf <span style="color:#f92672">=</span> T))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">gbifmap</span>(out)
</span></span></code></pre></div><p><img loading="lazy" src="/gbifmap2.png" alt="center"  />
</p>
<h3 id="tile-map-using-output-from-densitylist-using-results-in-canada-only">Tile map, using output from densitylist, using results in Canada only.<a hidden class="anchor" aria-hidden="true" href="#tile-map-using-output-from-densitylist-using-results-in-canada-only">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">densitylist</span>(originisocountrycode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CA&#34;</span>)  <span style="color:#75715e"># data for Canada</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">gbifmap</span>(out2)  <span style="color:#75715e"># on world map</span>
</span></span></code></pre></div><p><img loading="lazy" src="/gbifmap31.png" alt="center"  />
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">gbifmap</span>(out2, region <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Canada&#34;</span>)  <span style="color:#75715e"># on Canada map</span>
</span></span></code></pre></div><p><img loading="lazy" src="/gbifmap32.png" alt="NA"  />
</p>
<hr>
<h3 id="we-can-also-query-by-higher-taxonomic-rankings-and-map-all-lower-species-within-that-ranking-above-we-queried-by-scientificname-but-we-can-also-query-by-higher-taxonomy-7071443-is-the-taxonconceptkey-for-bacillariophyceae-a-class-which-includes-many-lower-species">We can also query by higher taxonomic rankings, and map all lower species within that ranking. Above we queried by scientificname, but we can also query by higher taxonomy. 7071443 is the taxonconceptkey for &lsquo;Bacillariophyceae&rsquo;, a Class which includes many lower species.<a hidden class="anchor" aria-hidden="true" href="#we-can-also-query-by-higher-taxonomic-rankings-and-map-all-lower-species-within-that-ranking-above-we-queried-by-scientificname-but-we-can-also-query-by-higher-taxonomy-7071443-is-the-taxonconceptkey-for-bacillariophyceae-a-class-which-includes-many-lower-species">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">densitylist</span>(taxonconceptKey <span style="color:#f92672">=</span> <span style="color:#ae81ff">7071443</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">gbifmap</span>(out)
</span></span></code></pre></div><p><img loading="lazy" src="/algae.png" alt="center"  />
</p>
<h3 id="seminym-asked-about-querying-by-area-you-can-query-by-area-though-slightly-differently-for-occurrencelist-and-densitylist-functions-for-occurrencelist-you-can-search-using-min-and-max-lat-and-long-values-and-min-an-max-altitude-pretty-cool-eh">seminym asked about querying by area. You can query by area, though slightly differently for occurrencelist and densitylist functions. For occurrencelist you can search using min and max lat and long values (and min an max altitude, pretty cool, eh).<a hidden class="anchor" aria-hidden="true" href="#seminym-asked-about-querying-by-area-you-can-query-by-area-though-slightly-differently-for-occurrencelist-and-densitylist-functions-for-occurrencelist-you-can-search-using-min-and-max-lat-and-long-values-and-min-an-max-altitude-pretty-cool-eh">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Get occurrences or density by area, using min/max lat/long coordinates</span>
</span></span><span style="display:flex;"><span>out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">occurrencelist</span>(minlatitude <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>, maxlatitude <span style="color:#f92672">=</span> <span style="color:#ae81ff">35</span>, minlongitude <span style="color:#f92672">=</span> <span style="color:#ae81ff">-100</span>, 
</span></span><span style="display:flex;"><span>    maxlongitude <span style="color:#f92672">=</span> <span style="color:#ae81ff">-95</span>, coordinatestatus <span style="color:#f92672">=</span> T, maxresults <span style="color:#f92672">=</span> <span style="color:#ae81ff">5000</span>, latlongdf <span style="color:#f92672">=</span> T)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Using `geom_point`</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">gbifmap</span>(out, <span style="color:#e6db74">&#34;state&#34;</span>, <span style="color:#e6db74">&#34;texas&#34;</span>, geom_point)
</span></span></code></pre></div><p><img loading="lazy" src="/byarea_occurr1.png" alt="center"  />
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Using geom_jitter to move the points apart from one another</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">gbifmap</span>(out, <span style="color:#e6db74">&#34;state&#34;</span>, <span style="color:#e6db74">&#34;texas&#34;</span>, geom_jitter, <span style="color:#a6e22e">position_jitter</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>))
</span></span></code></pre></div><p><img loading="lazy" src="/byarea_occurr2.png" alt="NA"  />
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># And move points a lot</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">gbifmap</span>(out, <span style="color:#e6db74">&#34;state&#34;</span>, <span style="color:#e6db74">&#34;texas&#34;</span>, geom_jitter, <span style="color:#a6e22e">position_jitter</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>))
</span></span></code></pre></div><p><img loading="lazy" src="/byarea_occurr3.png" alt="NA"  />
</p>
<h3 id="and-you-can-query-by-area-in-densitylist-by-specifying-a-place-using-the-originisocountrycode-argument-as-done-in-an-above-example--just-showing-the-head-of-the-dataframe-here">And you can query by area in <code>densitylist</code> by specifying a place using the <code>originisocountrycode</code> argument (as done in an above example).  Just showing the head of the data.frame here.<a hidden class="anchor" aria-hidden="true" href="#and-you-can-query-by-area-in-densitylist-by-specifying-a-place-using-the-originisocountrycode-argument-as-done-in-an-above-example--just-showing-the-head-of-the-dataframe-here">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Get density by place, note that you can&#39;t use the lat and long arguments</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># in densitylist</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(<span style="color:#a6e22e">densitylist</span>(originisocountrycode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CA&#34;</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  cellid minLatitude maxLatitude minLongitude maxLongitude count
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">46913</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-67</span>          <span style="color:#ae81ff">-66</span>    <span style="color:#ae81ff">44</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">46914</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-66</span>          <span style="color:#ae81ff">-65</span>   <span style="color:#ae81ff">907</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">46915</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-65</span>          <span style="color:#ae81ff">-64</span>   <span style="color:#ae81ff">510</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">46916</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-64</span>          <span style="color:#ae81ff">-63</span>   <span style="color:#ae81ff">645</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">46917</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-63</span>          <span style="color:#ae81ff">-62</span>    <span style="color:#ae81ff">56</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">46918</span>          <span style="color:#ae81ff">40</span>          <span style="color:#ae81ff">41</span>          <span style="color:#ae81ff">-62</span>          <span style="color:#ae81ff">-61</span>   <span style="color:#ae81ff">143</span>
</span></span></code></pre></div><hr>
<p>Get the .Rmd file used to create this post <a href="https://github.com/sckott/sckott.github.com/tree/master/_drafts/2012-10-08-rgbif-newfxns.Rmd">at my github account</a> - or <a href="https://github.com/sckott/sckott.github.com/tree/master/_posts/2012-10-08-rgbif-newfxns.md">.md file</a>.</p>
<p>Written in <a href="http://daringfireball.net/projects/markdown/">Markdown</a>, with help from <a href="http://yihui.name/knitr/">knitr</a>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/r/">R</a></li>
      <li><a href="http://localhost:1313/tags/open-access/">Open Access</a></li>
      <li><a href="http://localhost:1313/tags/data/">Data</a></li>
      <li><a href="http://localhost:1313/tags/gbif/">GBIF</a></li>
      <li><a href="http://localhost:1313/tags/biodiversity/">Biodiversity</a></li>
      <li><a href="http://localhost:1313/tags/macroecology/">Macroecology</a></li>
      <li><a href="http://localhost:1313/tags/ropensci/">Ropensci</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="http://localhost:1313/">Recology</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
