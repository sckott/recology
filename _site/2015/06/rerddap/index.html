<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>rerddap - General purpose R client for ERDDAP servers</title>
  <meta name="description" content="ERDDAP is a data server that gives you a simple, consistent way to download subsets of gridded and tabular scientific datasets in common file formats and mak...">
  <link href='https://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic,700italic|Source+Sans+Pro:400,700,200,300|Josefin+Sans:400,600,700,300' rel='stylesheet' type='text/css'>
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet"> -->
  <link href="assets/fontawesome-5.15.4/css/all.min.css" rel="stylesheet">

  <script async defer data-domain="recology.info" src="https://plausible.io/js/plausible.js"></script>

  <link rel="stylesheet" href="/css/style.css">
  <link rel="canonical" href="http://localhost:4000/2015/06/rerddap/">
  <link rel="alternate" type="application/rss+xml" title="recology" href="http://localhost:4000/feed.xml">

  <!-- mastodon verification -->
  <a rel="me" href="https://fosstodon.org/@sckottie">&nbsp;</a>
</head>


  <body>

    
<div class="wrapper">
  <center> <a href="/index.html"><div class="site-title">   recology </div></a></center>
</div>
<div class="wrapper site-description">
<center>code and such</center>
<!-- <br> -->
<!-- <center><a href="#mc-embedded-subscribe" style="font-size:18px">Subscribe</a></center> -->
</div>
<div class="wrapper">
  <div class="trigger site-navigation">
    <a class="page-link" href="/">HOME</a>

    
    
    
    
    
    

    <span class="exclamationMark">/</span><a class="page-link" href="/archives/">Archives</a>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
  </div>
</div>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline"><a class="post-title-link"  href="/2015/06/rerddap/">rerddap - General purpose R client for ERDDAP servers</a></h1>
  <center>  <p class="post-meta"><time datetime="2015-06-24T00:00:00-07:00" itemprop="datePublished">Jun 24, 2015</time></p>
   </center>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p><a href="http://upwell.pfeg.noaa.gov/erddap/information.html">ERDDAP</a> is a data server that gives you a simple, consistent way to download subsets of gridded and tabular scientific datasets in common file formats and make graphs and maps.  Besides it’s own <a href="http://upwell.pfeg.noaa.gov/erddap/rest.html">RESTful interface</a>, much of which is designed based on <a href="https://en.wikipedia.org/wiki/OPeNDAP">OPeNDAP</a>, ERDDAP can act as an OPeNDAP server and as a <a href="https://en.wikipedia.org/wiki/Web_Map_Service">WMS</a> server for gridded data.</p>

<p>ERDDAP is a powerful tool - in a world of heterogeneous data, it’s often hard to combine data and serve it through the same interface, with tools for querying/filtering/subsetting the data. That is exactly what ERDDAP does. Heterogeneous data sets often have some similarities, such as latitude/longitude data and usually a time component, but other variables vary widely.</p>

<h2 id="netcdf">NetCDF</h2>

<p><code class="language-plaintext highlighter-rouge">rerddap</code> supports <a href="https://en.wikipedia.org/wiki/NetCDF">NetCDF format</a>, and is the default when using the <code class="language-plaintext highlighter-rouge">griddap()</code> function. We use <code class="language-plaintext highlighter-rouge">ncdf</code> by default, but you can choose to use <code class="language-plaintext highlighter-rouge">ncdf4</code> instead.</p>

<h2 id="caching">Caching</h2>

<p>Data files downloaded are cached in a single hidden directory <code class="language-plaintext highlighter-rouge">~/.rerddap</code> on your machine. It’s hidden so that you don’t accidentally delete the data, but you can still easily delete the data if you like, open files, move them around, etc.</p>

<p>When you use <code class="language-plaintext highlighter-rouge">griddap()</code> or <code class="language-plaintext highlighter-rouge">tabledap()</code> functions, we construct a <a href="https://en.wikipedia.org/wiki/MD5#MD5_hashes">MD5 hash</a> from the base URL, and any query parameters - this way each query is separately cached. Once we have the hash, we look in <code class="language-plaintext highlighter-rouge">~/.rerddap</code> for a matching hash. If there’s a match we use that file on disk - if no match, we make a http request for the data to the ERDDAP server you specify.</p>

<h2 id="erddap-servers">ERDDAP servers</h2>

<p>You can get a data.frame of ERDDAP servers using the function <code class="language-plaintext highlighter-rouge">servers()</code>. Most I think serve some kind of NOAA data, but there are a few that aren’t NOAA data. Here are a few:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">servers</span><span class="p">())</span><span class="w">
</span><span class="c1">#&gt;                                                                                            name</span><span class="w">
</span><span class="c1">#&gt; 1                                                         Marine Domain Awareness (MDA) - Italy</span><span class="w">
</span><span class="c1">#&gt; 2                                                                    Marine Institute - Ireland</span><span class="w">
</span><span class="c1">#&gt; 3                                                      CoastWatch Caribbean/Gulf of Mexico Node</span><span class="w">
</span><span class="c1">#&gt; 4                                                                    CoastWatch West Coast Node</span><span class="w">
</span><span class="c1">#&gt; 5                    NOAA IOOS CeNCOOS (Central and Northern California Ocean Observing System)</span><span class="w">
</span><span class="c1">#&gt; 6 NOAA IOOS NERACOOS (Northeastern Regional Association of Coastal and Ocean Observing Systems)</span><span class="w">
</span><span class="c1">#&gt;                                        url</span><span class="w">
</span><span class="c1">#&gt; 1 https://bluehub.jrc.ec.europa.eu/erddap/</span><span class="w">
</span><span class="c1">#&gt; 2          http://erddap.marine.ie/erddap/</span><span class="w">
</span><span class="c1">#&gt; 3      http://cwcgom.aoml.noaa.gov/erddap/</span><span class="w">
</span><span class="c1">#&gt; 4  http://coastwatch.pfeg.noaa.gov/erddap/</span><span class="w">
</span><span class="c1">#&gt; 5    http://erddap.axiomalaska.com/erddap/</span><span class="w">
</span><span class="c1">#&gt; 6          http://www.neracoos.org/erddap/</span><span class="w">
</span></code></pre></div></div>

<h2 id="install">Install</h2>

<p>From CRAN</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="s2">"rerddap"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Or development version from GitHub</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">devtools</span><span class="o">::</span><span class="n">install_github</span><span class="p">(</span><span class="s2">"ropensci/rerddap"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s1">'rerddap'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h2 id="search">Search</h2>

<p>First, you likely want to search for data, specifying whether to search for either <code class="language-plaintext highlighter-rouge">griddadp</code> or <code class="language-plaintext highlighter-rouge">tabledap</code> datasets. The default is <code class="language-plaintext highlighter-rouge">griddap</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ed_search</span><span class="p">(</span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'size'</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"table"</span><span class="p">)</span><span class="w">
</span><span class="c1">#&gt; 11 results, showing first 20 </span><span class="w">
</span><span class="c1">#&gt;                                                                                         title</span><span class="w">
</span><span class="c1">#&gt; 1                                                                          CalCOFI Fish Sizes</span><span class="w">
</span><span class="c1">#&gt; 2                                                                        CalCOFI Larvae Sizes</span><span class="w">
</span><span class="c1">#&gt; 3                Channel Islands, Kelp Forest Monitoring, Size and Frequency, Natural Habitat</span><span class="w">
</span><span class="c1">#&gt; 4                                                         CalCOFI Larvae Counts Positive Tows</span><span class="w">
</span><span class="c1">#&gt; 5                                                                                CalCOFI Tows</span><span class="w">
</span><span class="c1">#&gt; 7                                                  OBIS - ARGOS Satellite Tracking of Animals</span><span class="w">
</span><span class="c1">#&gt; 8                                                     GLOBEC NEP MOCNESS Plankton (MOC1) Data</span><span class="w">
</span><span class="c1">#&gt; 9                                                 GLOBEC NEP Vertical Plankton Tow (VPT) Data</span><span class="w">
</span><span class="c1">#&gt; 10                            NWFSC Observer Fixed Gear Data, off West Coast of US, 2002-2006</span><span class="w">
</span><span class="c1">#&gt; 11                                 NWFSC Observer Trawl Data, off West Coast of US, 2002-2006</span><span class="w">
</span><span class="c1">#&gt; 12 AN EXPERIMENTAL DATASET: Underway Sea Surface Temperature and Salinity Aboard the Oleander</span><span class="w">
</span><span class="c1">#&gt;             dataset_id</span><span class="w">
</span><span class="c1">#&gt; 1     erdCalCOFIfshsiz</span><span class="w">
</span><span class="c1">#&gt; 2     erdCalCOFIlrvsiz</span><span class="w">
</span><span class="c1">#&gt; 3       erdCinpKfmSFNH</span><span class="w">
</span><span class="c1">#&gt; 4  erdCalCOFIlrvcntpos</span><span class="w">
</span><span class="c1">#&gt; 5       erdCalCOFItows</span><span class="w">
</span><span class="c1">#&gt; 7            aadcArgos</span><span class="w">
</span><span class="c1">#&gt; 8        erdGlobecMoc1</span><span class="w">
</span><span class="c1">#&gt; 9         erdGlobecVpt</span><span class="w">
</span><span class="c1">#&gt; 10  nwioosObsFixed2002</span><span class="w">
</span><span class="c1">#&gt; 11  nwioosObsTrawl2002</span><span class="w">
</span><span class="c1">#&gt; 12            nodcPJJU</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ed_search</span><span class="p">(</span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'size'</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grid"</span><span class="p">)</span><span class="w">
</span><span class="c1">#&gt; 6 results, showing first 20 </span><span class="w">
</span><span class="c1">#&gt;                                                                                                   title</span><span class="w">
</span><span class="c1">#&gt; 6                                                       NOAA Global Coral Bleaching Monitoring Products</span><span class="w">
</span><span class="c1">#&gt; 13        USGS COAWST Forecast, US East Coast and Gulf of Mexico (Experimental) [time][eta_rho][xi_rho]</span><span class="w">
</span><span class="c1">#&gt; 14            USGS COAWST Forecast, US East Coast and Gulf of Mexico (Experimental) [time][eta_u][xi_u]</span><span class="w">
</span><span class="c1">#&gt; 15            USGS COAWST Forecast, US East Coast and Gulf of Mexico (Experimental) [time][eta_v][xi_v]</span><span class="w">
</span><span class="c1">#&gt; 16 USGS COAWST Forecast, US East Coast and Gulf of Mexico (Experimental) [time][s_rho][eta_rho][xi_rho]</span><span class="w">
</span><span class="c1">#&gt; 17  USGS COAWST Forecast, US East Coast and Gulf of Mexico (Experimental) [time][Nbed][eta_rho][xi_rho]</span><span class="w">
</span><span class="c1">#&gt;             dataset_id</span><span class="w">
</span><span class="c1">#&gt; 6             NOAA_DHW</span><span class="w">
</span><span class="c1">#&gt; 13 whoi_ed12_89ce_9592</span><span class="w">
</span><span class="c1">#&gt; 14 whoi_61c3_0b5d_cd61</span><span class="w">
</span><span class="c1">#&gt; 15 whoi_62d0_9d64_c8ff</span><span class="w">
</span><span class="c1">#&gt; 16 whoi_7dd7_db97_4bbe</span><span class="w">
</span><span class="c1">#&gt; 17 whoi_a4fb_2c9c_16a7</span><span class="w">
</span></code></pre></div></div>

<p>This gives back dataset titles and identifiers - with which you should be able to get a sense for which dataset you may want to fetch.</p>

<h2 id="information">Information</h2>

<p>After searching you can get more information on a single dataset</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">info</span><span class="p">(</span><span class="s1">'whoi_62d0_9d64_c8ff'</span><span class="p">)</span><span class="w">
</span><span class="c1">#&gt; &lt;ERDDAP info&gt; whoi_62d0_9d64_c8ff </span><span class="w">
</span><span class="c1">#&gt;  Dimensions (range):  </span><span class="w">
</span><span class="c1">#&gt;      time: (2012-06-25T01:00:00Z, 2015-06-24T00:00:00Z) </span><span class="w">
</span><span class="c1">#&gt;      eta_v: (0, 334) </span><span class="w">
</span><span class="c1">#&gt;      xi_v: (0, 895) </span><span class="w">
</span><span class="c1">#&gt;  Variables:  </span><span class="w">
</span><span class="c1">#&gt;      bedload_Vsand_01: </span><span class="w">
</span><span class="c1">#&gt;          Units: kilogram meter-1 s-1 </span><span class="w">
</span><span class="c1">#&gt;      bedload_Vsand_02: </span><span class="w">
</span><span class="c1">#&gt;          Units: kilogram meter-1 s-1 </span><span class="w">
</span><span class="n">...</span><span class="w">
</span></code></pre></div></div>

<p>Which is a simple S3 list but prints out pretty, so it’s easy to quickly scan the printed output and see what you need to see to proceed. That is, in the next step you want to get the dataset, and you’ll want to specify your search using some combination of values for latitude, longitude, and time.</p>

<h2 id="griddap-gridded-data">griddap (gridded) data</h2>

<p>First, get information on a dataset to see time range, lat/long range, and variables.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">out</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">info</span><span class="p">(</span><span class="s1">'noaa_esrl_027d_0fb5_5d38'</span><span class="p">))</span><span class="w">
</span><span class="c1">#&gt; &lt;ERDDAP info&gt; noaa_esrl_027d_0fb5_5d38 </span><span class="w">
</span><span class="c1">#&gt;  Dimensions (range):  </span><span class="w">
</span><span class="c1">#&gt;      time: (1850-01-01T00:00:00Z, 2014-05-01T00:00:00Z) </span><span class="w">
</span><span class="c1">#&gt;      latitude: (87.5, -87.5) </span><span class="w">
</span><span class="c1">#&gt;      longitude: (-177.5, 177.5) </span><span class="w">
</span><span class="c1">#&gt;  Variables:  </span><span class="w">
</span><span class="c1">#&gt;      air: </span><span class="w">
</span><span class="c1">#&gt;          Range: -20.9, 19.5 </span><span class="w">
</span><span class="c1">#&gt;          Units: degC</span><span class="w">
</span></code></pre></div></div>

<p>Then query for gridded data using the <code class="language-plaintext highlighter-rouge">griddap()</code> function</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">griddap</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="w">
  </span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'2012-01-01'</span><span class="p">,</span><span class="w"> </span><span class="s1">'2012-01-30'</span><span class="p">),</span><span class="w">
  </span><span class="n">latitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">21</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w">
  </span><span class="n">longitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-80</span><span class="p">,</span><span class="w"> </span><span class="m">-70</span><span class="p">)</span><span class="w">
</span><span class="p">))</span><span class="w">
</span><span class="c1">#&gt; &lt;ERDDAP griddap&gt; noaa_esrl_027d_0fb5_5d38</span><span class="w">
</span><span class="c1">#&gt;    Path: [~/.rerddap/648ed11e8b911b65e39eb63c8df339df.nc]</span><span class="w">
</span><span class="c1">#&gt;    Last updated: [2015-05-09 08:31:10]</span><span class="w">
</span><span class="c1">#&gt;    File size:    [0 mb]</span><span class="w">
</span><span class="c1">#&gt;    Dimensions (dims/vars):   [3 X 1]</span><span class="w">
</span><span class="c1">#&gt;    Dim names: time, latitude, longitude</span><span class="w">
</span><span class="c1">#&gt;    Variable names: CRUTEM3: Surface Air Temperature Monthly Anomaly</span><span class="w">
</span><span class="c1">#&gt;    data.frame (rows/columns):   [18 X 4]</span><span class="w">
</span><span class="c1">#&gt;                    time latitude longitude  air</span><span class="w">
</span><span class="c1">#&gt; 1  2012-01-01T00:00:00Z     22.5     -77.5   NA</span><span class="w">
</span><span class="c1">#&gt; 2  2012-01-01T00:00:00Z     22.5     -77.5   NA</span><span class="w">
</span><span class="c1">#&gt; 3  2012-01-01T00:00:00Z     22.5     -77.5   NA</span><span class="w">
</span><span class="c1">#&gt; 4  2012-01-01T00:00:00Z     22.5     -77.5 -0.1</span><span class="w">
</span><span class="c1">#&gt; 5  2012-01-01T00:00:00Z     22.5     -77.5   NA</span><span class="w">
</span><span class="c1">#&gt; 6  2012-01-01T00:00:00Z     22.5     -77.5 -0.2</span><span class="w">
</span><span class="c1">#&gt; 7  2012-01-01T00:00:00Z     17.5     -72.5  0.2</span><span class="w">
</span><span class="c1">#&gt; 8  2012-01-01T00:00:00Z     17.5     -72.5   NA</span><span class="w">
</span><span class="c1">#&gt; 9  2012-01-01T00:00:00Z     17.5     -72.5  0.3</span><span class="w">
</span><span class="c1">#&gt; 10 2012-02-01T00:00:00Z     17.5     -72.5   NA</span><span class="w">
</span><span class="c1">#&gt; ..                  ...      ...       ...  ...</span><span class="w">
</span></code></pre></div></div>

<p>The output of <code class="language-plaintext highlighter-rouge">griddap()</code> is a list that you can explore further. Get the summary</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">res</span><span class="o">$</span><span class="n">summary</span><span class="w">
</span><span class="c1">#&gt; [1] "file ~/.rerddap/648ed11e8b911b65e39eb63c8df339df.nc has 3 dimensions:"</span><span class="w">
</span><span class="c1">#&gt; [1] "time   Size: 2"</span><span class="w">
</span><span class="c1">#&gt; [1] "latitude   Size: 3"</span><span class="w">
</span><span class="c1">#&gt; [1] "longitude   Size: 3"</span><span class="w">
</span><span class="c1">#&gt; [1] "------------------------"</span><span class="w">
</span><span class="c1">#&gt; [1] "file ~/.rerddap/648ed11e8b911b65e39eb63c8df339df.nc has 1 variables:"</span><span class="w">
</span><span class="c1">#&gt; [1] "float air[longitude,latitude,time]  Longname:CRUTEM3: Surface Air Temperature Monthly Anomaly Missval:-9.96920996838687e+36"</span><span class="w">
</span></code></pre></div></div>

<p>Or get the dimension variables (just the names of the variables for brevity here)</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">names</span><span class="p">(</span><span class="n">res</span><span class="o">$</span><span class="n">summary</span><span class="o">$</span><span class="n">dim</span><span class="p">)</span><span class="w">
</span><span class="c1">#&gt; [1] "time"      "latitude"  "longitude"</span><span class="w">
</span></code></pre></div></div>

<p>Get the data.frame (beware: you may want to just look at the <code class="language-plaintext highlighter-rouge">head</code> of the data.frame if large)</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">res</span><span class="o">$</span><span class="n">data</span><span class="w">
</span><span class="c1">#&gt;                    time latitude longitude   air</span><span class="w">
</span><span class="c1">#&gt; 1  2012-01-01T00:00:00Z     22.5     -77.5    NA</span><span class="w">
</span><span class="c1">#&gt; 2  2012-01-01T00:00:00Z     22.5     -77.5    NA</span><span class="w">
</span><span class="c1">#&gt; 3  2012-01-01T00:00:00Z     22.5     -77.5    NA</span><span class="w">
</span><span class="c1">#&gt; 4  2012-01-01T00:00:00Z     22.5     -77.5 -0.10</span><span class="w">
</span><span class="c1">#&gt; 5  2012-01-01T00:00:00Z     22.5     -77.5    NA</span><span class="w">
</span><span class="c1">#&gt; 6  2012-01-01T00:00:00Z     22.5     -77.5 -0.20</span><span class="w">
</span><span class="c1">#&gt; 7  2012-01-01T00:00:00Z     17.5     -72.5  0.20</span><span class="w">
</span><span class="c1">#&gt; 8  2012-01-01T00:00:00Z     17.5     -72.5    NA</span><span class="w">
</span><span class="c1">#&gt; 9  2012-01-01T00:00:00Z     17.5     -72.5  0.30</span><span class="w">
</span><span class="c1">#&gt; 10 2012-02-01T00:00:00Z     17.5     -72.5    NA</span><span class="w">
</span><span class="c1">#&gt; 11 2012-02-01T00:00:00Z     17.5     -72.5    NA</span><span class="w">
</span><span class="c1">#&gt; 12 2012-02-01T00:00:00Z     17.5     -72.5    NA</span><span class="w">
</span><span class="c1">#&gt; 13 2012-02-01T00:00:00Z     12.5     -67.5  0.40</span><span class="w">
</span><span class="c1">#&gt; 14 2012-02-01T00:00:00Z     12.5     -67.5    NA</span><span class="w">
</span><span class="c1">#&gt; 15 2012-02-01T00:00:00Z     12.5     -67.5  0.20</span><span class="w">
</span><span class="c1">#&gt; 16 2012-02-01T00:00:00Z     12.5     -67.5  0.00</span><span class="w">
</span><span class="c1">#&gt; 17 2012-02-01T00:00:00Z     12.5     -67.5    NA</span><span class="w">
</span><span class="c1">#&gt; 18 2012-02-01T00:00:00Z     12.5     -67.5  0.32</span><span class="w">
</span></code></pre></div></div>

<p>You can actually still explore the original netcdf summary object, e.g.,</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">res</span><span class="o">$</span><span class="n">summary</span><span class="o">$</span><span class="n">dim</span><span class="o">$</span><span class="n">time</span><span class="w">
</span><span class="c1">#&gt; $name</span><span class="w">
</span><span class="c1">#&gt; [1] "time"</span><span class="w">
</span><span class="c1">#&gt; </span><span class="w">
</span><span class="c1">#&gt; $len</span><span class="w">
</span><span class="c1">#&gt; [1] 2</span><span class="w">
</span><span class="c1">#&gt; </span><span class="w">
</span><span class="c1">#&gt; $unlim</span><span class="w">
</span><span class="c1">#&gt; [1] FALSE</span><span class="w">
</span><span class="c1">#&gt; </span><span class="w">
</span><span class="c1">#&gt; $id</span><span class="w">
</span><span class="c1">#&gt; [1] 1</span><span class="w">
</span><span class="c1">#&gt; </span><span class="w">
</span><span class="c1">#&gt; $dimvarid</span><span class="w">
</span><span class="c1">#&gt; [1] 1</span><span class="w">
</span><span class="c1">#&gt; </span><span class="w">
</span><span class="c1">#&gt; $units</span><span class="w">
</span><span class="c1">#&gt; [1] "seconds since 1970-01-01T00:00:00Z"</span><span class="w">
</span><span class="c1">#&gt; </span><span class="w">
</span><span class="c1">#&gt; $vals</span><span class="w">
</span><span class="c1">#&gt; [1] 1325376000 1328054400</span><span class="w">
</span><span class="c1">#&gt; </span><span class="w">
</span><span class="c1">#&gt; $create_dimvar</span><span class="w">
</span><span class="c1">#&gt; [1] TRUE</span><span class="w">
</span><span class="c1">#&gt; </span><span class="w">
</span><span class="c1">#&gt; attr(,"class")</span><span class="w">
</span><span class="c1">#&gt; [1] "dim.ncdf"</span><span class="w">
</span></code></pre></div></div>

<h2 id="tabledap-tabular-data">tabledap (tabular) data</h2>

<p><code class="language-plaintext highlighter-rouge">tabledap</code> is data that is not gridded by lat/lon/time. In addition, the query interface is a bit different. Notice that you can do less than, more than, equal to type queries, but they are specified as character strings.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">out</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">info</span><span class="p">(</span><span class="s1">'erdCalCOFIfshsiz'</span><span class="p">))</span><span class="w">
</span><span class="c1">#&gt; &lt;ERDDAP info&gt; erdCalCOFIfshsiz </span><span class="w">
</span><span class="c1">#&gt;  Variables:  </span><span class="w">
</span><span class="c1">#&gt;      calcofi_species_code: </span><span class="w">
</span><span class="c1">#&gt;          Range: 19, 1550 </span><span class="w">
</span><span class="c1">#&gt;      common_name: </span><span class="w">
</span><span class="c1">#&gt;      cruise: </span><span class="w">
</span><span class="c1">#&gt;      fish_1000m3: </span><span class="w">
</span><span class="c1">#&gt;          Units: Fish per 1,000 cubic meters of water sampled </span><span class="w">
</span><span class="c1">#&gt;      fish_count: </span><span class="w">
</span><span class="c1">#&gt;      fish_size: </span><span class="w">
</span><span class="n">...</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tabledap</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="s1">'time&gt;=2001-07-07'</span><span class="p">,</span><span class="w"> </span><span class="s1">'time&lt;=2001-07-10'</span><span class="p">,</span><span class="w"> 
                 </span><span class="n">fields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'longitude'</span><span class="p">,</span><span class="w"> </span><span class="s1">'latitude'</span><span class="p">,</span><span class="w"> </span><span class="s1">'fish_size'</span><span class="p">,</span><span class="w"> </span><span class="s1">'itis_tsn'</span><span class="p">,</span><span class="w"> </span><span class="s1">'scientific_name'</span><span class="p">)))</span><span class="w">
</span><span class="c1">#&gt; &lt;ERDDAP tabledap&gt; erdCalCOFIfshsiz</span><span class="w">
</span><span class="c1">#&gt;    Path: [~/.rerddap/f013f9ee09bdb4184928d533e575e948.csv]</span><span class="w">
</span><span class="c1">#&gt;    Last updated: [2015-05-09 08:31:21]</span><span class="w">
</span><span class="c1">#&gt;    File size:    [0.03 mb]</span><span class="w">
</span><span class="c1">#&gt;    Dimensions:   [558 X 5]</span><span class="w">
</span><span class="c1">#&gt; </span><span class="w">
</span><span class="c1">#&gt;     longitude  latitude fish_size itis_tsn       scientific_name</span><span class="w">
</span><span class="c1">#&gt; 2     -118.26    33.255      22.9   623745 Nannobrachium ritteri</span><span class="w">
</span><span class="c1">#&gt; 3     -118.26    33.255      22.9   623745 Nannobrachium ritteri</span><span class="w">
</span><span class="c1">#&gt; 4  -118.10667 32.738335      31.5   623625  Lipolagus ochotensis</span><span class="w">
</span><span class="c1">#&gt; 5  -118.10667 32.738335      48.3   623625  Lipolagus ochotensis</span><span class="w">
</span><span class="c1">#&gt; 6  -118.10667 32.738335      15.5   162221 Argyropelecus sladeni</span><span class="w">
</span><span class="c1">#&gt; 7  -118.10667 32.738335      16.3   162221 Argyropelecus sladeni</span><span class="w">
</span><span class="c1">#&gt; 8  -118.10667 32.738335      17.8   162221 Argyropelecus sladeni</span><span class="w">
</span><span class="c1">#&gt; 9  -118.10667 32.738335      18.2   162221 Argyropelecus sladeni</span><span class="w">
</span><span class="c1">#&gt; 10 -118.10667 32.738335      19.2   162221 Argyropelecus sladeni</span><span class="w">
</span><span class="c1">#&gt; 11 -118.10667 32.738335      20.0   162221 Argyropelecus sladeni</span><span class="w">
</span><span class="c1">#&gt; ..        ...       ...       ...      ...                   ...</span><span class="w">
</span></code></pre></div></div>

<p>Since both <code class="language-plaintext highlighter-rouge">griddap()</code> and <code class="language-plaintext highlighter-rouge">tabledap()</code> give back data.frame’s, it’s easy to do downstream manipulation. For example, we can use <code class="language-plaintext highlighter-rouge">dplyr</code> to filter, summarize, group, and sort:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"dplyr"</span><span class="p">)</span><span class="w">
</span><span class="n">dat</span><span class="o">$</span><span class="n">fish_size</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">fish_size</span><span class="p">)</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tbl_df</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">fish_size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">30</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">scientific_name</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">mean_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">fish_size</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">mean_size</span><span class="p">))</span><span class="w">
</span><span class="n">df</span><span class="w">
</span><span class="c1">#&gt; Source: local data frame [20 x 2]</span><span class="w">
</span><span class="c1">#&gt; </span><span class="w">
</span><span class="c1">#&gt;                 scientific_name mean_size</span><span class="w">
</span><span class="c1">#&gt; 1       Idiacanthus antrostomus 253.00000</span><span class="w">
</span><span class="c1">#&gt; 2            Stomias atriventer 189.25000</span><span class="w">
</span><span class="c1">#&gt; 3            Lestidiops ringens  98.70000</span><span class="w">
</span><span class="c1">#&gt; 4     Tarletonbeania crenularis  56.50000</span><span class="w">
</span><span class="c1">#&gt; 5      Ceratoscopelus townsendi  53.70000</span><span class="w">
</span><span class="c1">#&gt; 6     Stenobrachius leucopsarus  47.74538</span><span class="w">
</span><span class="c1">#&gt; 7               Sardinops sagax  47.00000</span><span class="w">
</span><span class="c1">#&gt; 8         Nannobrachium ritteri  43.30250</span><span class="w">
</span><span class="c1">#&gt; 9         Bathylagoides wesethi  43.09167</span><span class="w">
</span><span class="c1">#&gt; 10         Vinciguerria lucetia  42.00000</span><span class="w">
</span><span class="c1">#&gt; 11       Cyclothone acclinidens  40.80000</span><span class="w">
</span><span class="c1">#&gt; 12         Lipolagus ochotensis  39.72500</span><span class="w">
</span><span class="c1">#&gt; 13        Leuroglossus stilbius  38.35385</span><span class="w">
</span><span class="c1">#&gt; 14        Triphoturus mexicanus  38.21342</span><span class="w">
</span><span class="c1">#&gt; 15                Diaphus theta  37.88571</span><span class="w">
</span><span class="c1">#&gt; 16       Trachipterus altivelis  37.70000</span><span class="w">
</span><span class="c1">#&gt; 17 Symbolophorus californiensis  37.66000</span><span class="w">
</span><span class="c1">#&gt; 18         Nannobrachium regale  37.50000</span><span class="w">
</span><span class="c1">#&gt; 19         Merluccius productus  36.61333</span><span class="w">
</span><span class="c1">#&gt; 20        Argyropelecus sladeni  32.43333</span><span class="w">
</span></code></pre></div></div>

<p>Then make a cute little plot</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"ggplot2"</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">scientific_name</span><span class="p">,</span><span class="w"> </span><span class="n">mean_size</span><span class="p">),</span><span class="w"> </span><span class="n">mean_size</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Mean Size"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Species"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/public/img/2015-06-24-rerddap/unnamed-chunk-19-1.png" alt="plot of chunk unnamed-chunk-19" /></p>

  </div>

  <footer class="postNavigation">
  
    <a class="postPrev" href="/2015/06/idigbio-in-spocc/">
        &laquo; iDigBio - a new data source in spocc
    </a>
  
  
    <a class="postNext" href="/2015/07/weather-data-with-rnoaa/">
        rnoaa - Weather data in R &raquo;
    </a>
  
  </footer>


</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading small-site-title">Scott Chamberlain</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list footer-content">
          <li>Theme: <a href="http://github.com/hemangsk/Gravity">Gravity</a></li>
          <li>Made with <i class="fa fa-heart"></i> on <a href="https://jekyllrb.com"><span style="color:black">{ { Jekyll } }</a></span></li>


        </ul>
      </div>

      <div class="footer-col footer-col-3 footer-content">
        <ul class="social-media-list">
          <li>
            <a href="https://fosstodon.org/@sckottie" target="_blank"><i class="fab fa-mastodon"></i> @sckottie@fosstodon.org</a>
          </li>
          <li>
            <a href="https://github.com/sckott" target="_blank"><i class="fab fa-github"></i> sckott</a>
          </li>
          <!-- 
          <li>
            <a href="https://github.com/sckott"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">sckott</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username"></span></a>

          </li>
           -->
        </ul>
      </div>

      <div class="footer-col footer-col-2 site-description">
        <p style="display:inline">RSS</p>
        <a href="/feed.xml"><i class="fa fa-rss fa-lg"></i></a>&nbsp;
      </div>

      <!-- Begin Mailchimp Signup Form -->
      <!-- <link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
      <style type="text/css">
        #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
      </style>
      <div id="mc_embed_signup">
      <form action="https://recology.us7.list-manage.com/subscribe/post?u=8c97c072b016bf98033ec69cd&amp;id=3bc4378262" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
          <div id="mc_embed_signup_scroll">
        
        <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
          <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_8c97c072b016bf98033ec69cd_3bc4378262" tabindex="-1" value=""></div>
          <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
          </div>
      </form>
      </div> -->

      <!--End mc_embed_signup-->
    </div>

  </div>

</footer>


    <!--[if !(lt IE 8)]><!-->
    <script type="text/javascript">
      (function(){
        var e = document.createElement('script'); e.type='text/javascript'; e.async = true;
        e.src = 'https://www.eff.org/doa/widget.min.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(e, s);
      })();
    </script>
    <!--<![endif]-->

  </body>

</html>
