<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Conditionality meta-analysis data</title>
  <meta name="description" content="The paper">
  <link href='https://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic,700italic|Source+Sans+Pro:400,700,200,300|Josefin+Sans:400,600,700,300' rel='stylesheet' type='text/css'>
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet"> -->
  <link href="assets/fontawesome-5.15.4/css/all.min.css" rel="stylesheet">

  <script async defer data-domain="recology.info" src="https://plausible.io/js/plausible.js"></script>

  <link rel="stylesheet" href="/css/style.css">
  <link rel="canonical" href="http://localhost:4000/2014/10/conditionality-meta-analysis/">
  <link rel="alternate" type="application/rss+xml" title="recology" href="http://localhost:4000/feed.xml">

  <!-- mastodon verification -->
  <a rel="me" href="https://fosstodon.org/@sckottie">&nbsp;</a>
</head>


  <body>

    
<div class="wrapper">
  <center> <a href="/index.html"><div class="site-title">   recology </div></a></center>
</div>
<div class="wrapper site-description">
<center>code and such</center>
<!-- <br> -->
<!-- <center><a href="#mc-embedded-subscribe" style="font-size:18px">Subscribe</a></center> -->
</div>
<div class="wrapper">
  <div class="trigger site-navigation">
    <a class="page-link" href="/">HOME</a>

    
    
    
    
    
    

    <span class="exclamationMark">/</span><a class="page-link" href="/archives/">Archives</a>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
  </div>
</div>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline"><a class="post-title-link"  href="/2014/10/conditionality-meta-analysis/">Conditionality meta-analysis data</a></h1>
  <center>  <p class="post-meta"><time datetime="2014-10-06T00:00:00-07:00" itemprop="datePublished">Oct 6, 2014</time></p>
   </center>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h2 id="the-paper">The paper</h2>

<p>One paper from my graduate work asked most generally ~ “How much does the variation in magnitudes and signs of species interaction outcomes vary?”. More specifically, we wanted to know if variation differed among species interaction classes (mutualism, competition, predation), and among various “gradients” (space, time, etc.). To answer this question, we used a meta-analysis approach (rather than e.g., a field experiment). We <a href="http://scottchamberlain.info/publications/">published the paper</a> recently.</p>

<blockquote>
  <p>p.s. I really really wish we would have put it in an open access journal…</p>
</blockquote>

<h2 id="the-data">The data</h2>

<p>Anyway, I’m here to talk about the <strong>data</strong>. We didn’t get the data up with the paper, but it is <a href="http://figshare.com/articles/Conditionality_data/1097657">up on Figshare</a> now. The files there are the following:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">coniditionality.R</code> - script used to process the data from <code class="language-plaintext highlighter-rouge">variables_prelim.csv</code></li>
  <li><code class="language-plaintext highlighter-rouge">variables_prelim.csv</code> - description of variables in the preliminary data set, matches <code class="language-plaintext highlighter-rouge">conditionality_data_prelim.csv</code></li>
  <li><code class="language-plaintext highlighter-rouge">variables_used.csv</code> - description of variables in the used data set, matches <code class="language-plaintext highlighter-rouge">conditionality_data_used.csv</code></li>
  <li><code class="language-plaintext highlighter-rouge">conditionality_data_prelim.csv</code> - preliminary data, the raw data</li>
  <li><code class="language-plaintext highlighter-rouge">conditionality_data_used.csv</code> - the data used for our paper</li>
  <li><code class="language-plaintext highlighter-rouge">README.md</code> - the readme</li>
  <li><code class="language-plaintext highlighter-rouge">paper_selection.csv</code> - the list of papers we went through, with remarks about paper selection</li>
</ul>

<p>Please do play with the data, publish some papers, etc, etc. It took 6 of us about 4 years to collect this data; we skimmed through ~11,000 papers on the first pass (aka. skimming through abstracts in Google Scholar and Web of Science), then decided on nearly 500 papers to get data from, and narrowed down to 247 papers for the publication mentioned above. Now, there was no funding for this, so it was sort of done in between other projects, but still, it was simply <strong>A LOT</strong> of tables to digitize, and graphs to extract data points from. <strong>Anyway</strong>, hopefully you will find this data useful :p</p>

<h2 id="eml">EML</h2>

<p>I think this dataset would be a great introduction to the potential power of EML (<a href="https://knb.ecoinformatics.org/#external//emlparser/docs/index.html">Ecological Metadata Langauge</a>). At <a href="http://ropensci.org/">rOpenSci</a>, one of our team <a href="http://www.carlboettiger.info/">Carl Boettiger</a>, along with Claas-Thido Pfaff, Duncan Temple Lang, Karthik Ram, and Matt Jones, have created an R client for EML, to parse EML files and to create and publish them.</p>

<h2 id="what-is-emlwhy-eml">What is EML?/Why EML?</h2>

<p>A demonstration is in order…</p>

<h2 id="example-using-eml-with-this-dataset">Example using EML with this dataset</h2>

<h3 id="install-eml">Install EML</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"devtools"</span><span class="p">)</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"RHTMLForms"</span><span class="p">,</span><span class="w"> </span><span class="n">repos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://www.omegahat.org/R/"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"source"</span><span class="p">)</span><span class="w">
</span><span class="n">install_github</span><span class="p">(</span><span class="s2">"ropensci/EML"</span><span class="p">,</span><span class="w"> </span><span class="n">build</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">dependencies</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"DEPENDS"</span><span class="p">,</span><span class="w"> </span><span class="s2">"IMPORTS"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>Load <code class="language-plaintext highlighter-rouge">EML</code></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s1">'EML'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="prepare-metadata">Prepare metadata</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># dataset</span><span class="w">
</span><span class="n">prelim_dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"conditionality_data_prelim.csv"</span><span class="p">)</span><span class="w">
</span><span class="c1"># variable descriptions for each column</span><span class="w">
</span><span class="n">prelim_vars</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"variables_prelim.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">stringsAsFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Get column definitions in a vector</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">col_defs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prelim_vars</span><span class="o">$</span><span class="n">description</span><span class="w">
</span></code></pre></div></div>

<p>Create unit definitions for each column</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">unit_defs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w">
  </span><span class="nf">c</span><span class="p">(</span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"number"</span><span class="p">,</span><span class="w">
    </span><span class="n">bounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="kc">Inf</span><span class="p">)),</span><span class="w">
  </span><span class="nf">c</span><span class="p">(</span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"number"</span><span class="p">,</span><span class="w">
    </span><span class="n">bounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="kc">Inf</span><span class="p">)),</span><span class="w">
  </span><span class="s2">"independent replicates"</span><span class="p">,</span><span class="w">
  </span><span class="nf">c</span><span class="p">(</span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"number"</span><span class="p">,</span><span class="w">
    </span><span class="n">bounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="kc">Inf</span><span class="p">)),</span><span class="w">

  </span><span class="n">...</span><span class="w"> </span><span class="o">&lt;</span><span class="n">CUTOFF</span><span class="o">&gt;</span><span class="w">
</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="write-an-eml-file">Write an EML file</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eml_write</span><span class="p">(</span><span class="n">prelim_dat</span><span class="p">,</span><span class="w">
          </span><span class="n">unit.defs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unit_defs</span><span class="p">,</span><span class="w">
          </span><span class="n">col.defs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col_defs</span><span class="p">,</span><span class="w">
          </span><span class="n">creator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Scott Chamberlain"</span><span class="p">,</span><span class="w">
          </span><span class="n">contact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"myrmecocystus@gmail.com"</span><span class="p">,</span><span class="w">
          </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"conditionality_data_prelim_eml.xml"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "conditionality_data_prelim_eml.xml"
</code></pre></div></div>

<h3 id="validate-the-eml-file">Validate the EML file</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eml_validate</span><span class="p">(</span><span class="s2">"conditionality_data_prelim_eml.xml"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## EML specific tests XML specific tests 
##               TRUE               TRUE
</code></pre></div></div>

<h3 id="read-data-and-metadata">Read data and metadata</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eml_read</span><span class="p">(</span><span class="s2">"conditionality_data_prelim_eml.xml"</span><span class="p">)</span><span class="w">
</span><span class="n">eml_get</span><span class="p">(</span><span class="n">gg</span><span class="p">,</span><span class="w"> </span><span class="s2">"contact"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "myrmecocystus@gmail.com"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eml_get</span><span class="p">(</span><span class="n">gg</span><span class="p">,</span><span class="w"> </span><span class="s2">"citation_info"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Chamberlain S (2014-10-06). _metadata_.
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eml_get</span><span class="p">(</span><span class="n">gg</span><span class="p">,</span><span class="w"> </span><span class="s2">"data.frame"</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">dat</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)])</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##   order i indrep avg author_last  finit_1 finit_2 finit_abv co_author
## 1     1 1      a   1      Devall margaret       s        ms     Thein
## 2     2 1      a   2      Devall margaret       s        ms     Thein
## 3     3 1      a   3      Devall margaret       s        ms     Thein
## 4     4 1      a   4      Devall margaret       s        ms     Thein
## 5     5 1      a   5      Devall margaret       s        ms     Thein
## 6     6 1      a   6      Devall margaret       s        ms     Thein
##   sinit_1
## 1 leonard
## 2 leonard
## 3 leonard
## 4 leonard
## 5 leonard
## 6 leonard
</code></pre></div></div>

<h3 id="publish">Publish</h3>

<p>We can also use the <code class="language-plaintext highlighter-rouge">EML</code> package to publish the data, here to <a href="http://figshare.com">Figshare</a>.</p>

<p>First, install <code class="language-plaintext highlighter-rouge">rfigshare</code></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="s2">"rfigshare"</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="s1">'rfigshare'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Then publish using <code class="language-plaintext highlighter-rouge">eml_publish()</code></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">figid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eml_publish</span><span class="p">(</span><span class="w">
            </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"conditionality_data_prelim_eml.xml"</span><span class="p">,</span><span class="w">
            </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"EML file for Chamberlain, S.A., J.A. Rudgers, and J.L. Bronstein. 2014. How context-dependent are species interactions. Ecology Letters"</span><span class="p">,</span><span class="w">
            </span><span class="n">categories</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ecology"</span><span class="p">,</span><span class="w">
            </span><span class="n">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"EML"</span><span class="p">,</span><span class="w">
            </span><span class="n">destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"figshare"</span><span class="p">,</span><span class="w">
            </span><span class="n">visibility</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"public"</span><span class="p">,</span><span class="w">
            </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"condionality data, EML"</span><span class="p">)</span><span class="w">
</span><span class="n">fs_make_public</span><span class="p">(</span><span class="n">figid</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/public/img/2014-10-06-conditionality-meta-analysis/figshare_conditional.png" alt="" /></p>


  </div>

  <footer class="postNavigation">
  
    <a class="postPrev" href="/2014/08/rsunlight/">
        &laquo; rsunlight - R client for Sunlight Labs APIs
    </a>
  
  
    <a class="postNext" href="/2014/11/sofa/">
        sofa - reboot &raquo;
    </a>
  
  </footer>


</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading small-site-title">Scott Chamberlain</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list footer-content">
          <li>Theme: <a href="http://github.com/hemangsk/Gravity">Gravity</a></li>
          <li>Made with <i class="fa fa-heart"></i> on <a href="https://jekyllrb.com"><span style="color:black">{ { Jekyll } }</a></span></li>


        </ul>
      </div>

      <div class="footer-col footer-col-3 footer-content">
        <ul class="social-media-list">
          <li>
            <i class="fab fa-mastodon"></i> @sckottie@fosstodon.org
          </li>
          <li>
            <i class="fab fa-github"></i> sckott
          </li>
          <!-- 
          <li>
            <a href="https://github.com/sckott"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">sckott</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username"></span></a>

          </li>
           -->
        </ul>
      </div>

      <div class="footer-col footer-col-2 site-description">
        <p style="display:inline">RSS</p>
        <a href="/feed.xml"><i class="fa fa-rss fa-lg"></i></a>&nbsp;
      </div>

      <!-- Begin Mailchimp Signup Form -->
      <!-- <link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
      <style type="text/css">
        #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
      </style>
      <div id="mc_embed_signup">
      <form action="https://recology.us7.list-manage.com/subscribe/post?u=8c97c072b016bf98033ec69cd&amp;id=3bc4378262" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
          <div id="mc_embed_signup_scroll">
        
        <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
          <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_8c97c072b016bf98033ec69cd_3bc4378262" tabindex="-1" value=""></div>
          <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
          </div>
      </form>
      </div> -->

      <!--End mc_embed_signup-->
    </div>

  </div>

</footer>


    <!--[if !(lt IE 8)]><!-->
    <script type="text/javascript">
      (function(){
        var e = document.createElement('script'); e.type='text/javascript'; e.async = true;
        e.src = 'https://www.eff.org/doa/widget.min.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(e, s);
      })();
    </script>
    <!--<![endif]-->

  </body>

</html>
